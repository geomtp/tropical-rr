\documentclass[a4paper,dvipdfmx,reqno,12pt]{amsart}
\synctex=1
%
%%%% packages
\usepackage[utf8]{inputenc}
\usepackage[dvipdfmx]{graphicx,color}%for images
\usepackage{bm}%fonts
\usepackage{tikz-cd}%
\usetikzlibrary{cd}
\usetikzlibrary{calc}
\usepackage{amsmath,amsthm,amstext,amsfonts,amsbsy}% ほぼ必須
\usepackage{amssymb}
\usepackage{latexsym}% ほぼ必須
\usepackage{makecell}%表のセル内で改行するためのパッケージ
\usepackage{algpseudocode,algorithm}%疑似コード用
\usepackage{todonotes}%comments
\usepackage[margin=0.8in]{geometry}
\usepackage{layout}
\usepackage[T1]{fontenc}%font encoding
\usepackage{physics}
\usepackage{braket}%after physics
\usepackage{mathtools,thmtools}
\usepackage{imakeidx}%before hyperref for pagebackref
\usepackage[pagebackref,dvipdfmx]{hyperref}
\usepackage[capitalize]{cleveref}
\hypersetup{
     colorlinks = true,
     citecolor  = blue,
     linkcolor  = blue, 
     urlcolor   = blue, 
}
%\usepackage{pxjahyper}%for hyperref in Japanese
\usepackage{bookmark}
\usepackage{dynkin-diagrams}

%%%% imakeidx

%%%%
\usepackage{pgf,tikz,pgfplots}
\pgfplotsset{compat=1.15}
\usetikzlibrary{arrows}



%%%%


%%%% theoremstyle

\theoremstyle{definition}
\newtheorem{theorem}{Theorem}[section]
\newtheorem*{theorem*}{Theorem}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{definition*}{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem*{example*}{Example}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem*{proposition*}{Proposition}
\newtheorem{Note}[theorem]{Note}
\newtheorem*{Note*}{Note}
\newtheorem{Ntc}[theorem]{Notice}
\newtheorem*{Ntc*}{Notice}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem*{lemma*}{Lemma}
\newtheorem{Fact}[theorem]{Fact}
\newtheorem*{Fact*}{Fact}
\newtheorem{question}[theorem]{Question}
\newtheorem*{question*}{Question}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem*{conjecture*}{Conjecture}
\newtheorem{Rule}[theorem]{Rule}
\newtheorem*{Rule*}{Rule}
\newtheorem{notation}[theorem]{Notation}
\newtheorem*{Not*}{Notation}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem*{corollary*}{Corollary}
\newtheorem{remark}[theorem]{Remark}
\newtheorem*{Rmk*}{Remark}
\newtheorem{condition}[theorem]{Condition}
\newtheorem*{condition*}{Condition}
\newtheorem{Conv}[theorem]{Convention}
\newtheorem*{Conv*}{Convention}
\newtheorem{observation}[theorem]{Observation}
\newtheorem*{observation*}{Observation}
%%%% newcommand

%%%logic symbol
\newcommand{\deq}{\coloneqq}

\newcommand{\dbraket}[1]{\hspace{-1.5pt}\braket{\hspace{-2.2pt}\braket{#1}\hspace{-2.2pt}}}

\newcommand{\textcmd}[1]{\texttt{\symbol{"5C}#1}}

%%special sets
\newcommand{\emp}{\varnothing}%emptyset
\newcommand{\C}{\mathbb{C}}%complex number
\newcommand{\Ha}{\mathbb{H}}%quaternion
\newcommand{\F}{\mathbb{F}}%field
\newcommand{\R}{\mathbb{R}}%real number
\newcommand{\Q}{\mathbb{Q}}%rational number
\newcommand{\Z}{\mathbb{Z}}%integer
\newcommand{\N}{\mathbb{N}_{0}}%natural number
\newcommand{\Pj}{\mathbb{P}}%bold p
\newcommand{\vep}{\varepsilon}%varepsilon

%%%%

\newcommand{\mb}[1]{\mathbb{#1}}%blackboard bold (for math mode)
\newcommand{\mcal}[1]{\mathcal{#1}}%

\newcommand{\opn}[1]{\operatorname{#1}}
\newcommand{\catn}[1]{\mathbf{#1}}

\newcommand{\abk}[1]{\langle {#1} \rangle}%angle bracket 
\newcommand{\Abk}[1]{\left \langle {#1} \right \rangle}%angle bracket (auto sizing)
\newcommand{\dabk}[1]{\langle\! \langle {#1}\rangle \! \rangle}%double angle bracket
\newcommand{\Dabk}[1]{\left \langle \! \left \langle {#1} \right \rangle \! \right \rangle}%double angle bracket
\newcommand{\Sbk}[1]{\left[ {#1} ]\right }% square bracket [] (auto sizing)
\newcommand{\Cbk}[1]{\left \{ {#1}\right \}}% curly bracket {} (auto sizing)
\newcommand{\dcbk}[1]{\{\!\!\{ {#1}\}\!\!\}} % double curly bracket {{}} 
\newcommand{\Dcbk}[1]{\left \{\!\! \left \{ {#1} \right\} \!\!\right \}} % double curly bracket {{}} (auto sizing)
\newcommand{\Paren}[1]{\left ( {#1} \right )}%parenthesis () (auto sizing)
\newcommand{\dparen}[1]{(\!({#1})\!)}%double parenthesis
\newcommand{\xto}[1]{\xrightarrow{#1}}
\newcommand{\xgets}[1]{\xleftarrow{#1}}
\newcommand{\hookto}{\hookrightarrow}


%%%% 

%%%% mathabx.sty (font) 
\DeclareFontFamily{U}{matha}{\hyphenchar\font45}
\DeclareFontShape{U}{matha}{m}{n}{
      <5> <6> <7> <8> <9> <10> gen * matha
      <10.95> matha10 <12> <14.4> <17.28> <20.74> <24.88> matha12
      }{}
\DeclareSymbolFont{matha}{U}{matha}{m}{n}

\DeclareFontFamily{U}{mathb}{\hyphenchar\font45}
\DeclareFontShape{U}{mathb}{m}{n}{
      <5> <6> <7> <8> <9> <10> gen * mathb
      <10.95> mathb10 <12> <14.4> <17.28> <20.74> <24.88> mathb12
      }{}
\DeclareSymbolFont{mathb}{U}{mathb}{m}{n}

\DeclareFontFamily{U}{mathx}{\hyphenchar\font45}
\DeclareFontShape{U}{mathx}{m}{n}{
      <5> <6> <7> <8> <9> <10>
      <10.95> <12> <14.4> <17.28> <20.74> <24.88>
      mathx10
      }{}
\DeclareSymbolFont{mathx}{U}{mathx}{m}{n}

%DeclareMathSymbol (from mathabx.sty)
\DeclareMathSymbol{\bigboxslash}{\mathop}{mathx}{"FE}
\DeclareMathSymbol{\bigboxtimes}{\mathop}{mathx}{"D2}
%%%%

%%%% MnSymbol.sty (font)
\DeclareFontFamily{U}{MnSymbolC}{}
\DeclareFontShape{U}{MnSymbolC}{m}{n}{
  <-6> MnSymbolC5
  <6-7> MnSymbolC6
  <7-8> MnSymbolC7
  <8-9> MnSymbolC8
  <9-10> MnSymbolC9
  <10-12> MnSymbolC10
  <12-> MnSymbolC12}{}
\DeclareFontShape{U}{MnSymbolC}{b}{n}{
  <-6> MnSymbolA-Bold5
  <6-7> MnSymbolC-Bold6
  <7-8> MnSymbolC-Bold7
  <8-9> MnSymbolC-Bold8
  <9-10> MnSymbolC-Bold9
  <10-12> MnSymbolC-Bold10
  <12-> MnSymbolC-Bold12}{}

\DeclareSymbolFont{MnSyC}{U}{MnSymbolC}{m}{n}

%%%% DeclareMathSymbol (from MnSymbol.sty)

\DeclareMathSymbol{\tplus}{\mathbin}{MnSyC}{43}
\DeclareMathSymbol{\aplus}{\mathbin}{MnSyC}{190}

%%%% renewcommand




%%%% footnote

\newcommand{\cfootnote}[1]{\footnote{#1}}

\newcommand{\myfootnote}[1]{\hspace{-5pt}\footnote{#1}}

\newcommand{\TB}{\mcal{T}_{B}}
\newcommand{\TBZ}{\mcal{T}_{\Z,B}}
\newcommand{\AffS}{{\mathop{\mcal{A}\!f\!\!f\!}\nolimits}}
\newcommand{\FBZ}{\mcal{F}_{\Z,B}}
\newcommand{\FB}{\mcal{F}_{B}}
\newcommand{\simto}{ 
\mathrel{\raisebox{0.13em}{${\sim}$}}
\kern -0.75em \mathrel{\raisebox{-0.11em}{${\scriptstyle \to}$}}  
}
%%%% from 

%%%% from  https://tex.stackexchange.com/questions/183702/formatting-back-references-in-bibliography-bibtex
\renewcommand*{\backrefalt}[4]{
    \ifcase #1 [Not cited.]%
        \or        [Cited on p.#2.]%
        \else      [Cited on p.#2.]%
    \fi}


\usepackage{mathrsfs}
\usepackage{upgreek}
\numberwithin{equation}{section}
\title[Graded modules associated with line bundles]{Graded modules associated with line bundles on 
tropical curves and integral Hessian manifolds}
\author[Y. Tsutsui]{Yuki Tsutsui}
\address{Graduate School of Mathematical Sciences,
The University of Tokyo, 3-8-1 Komaba, Meguro-Ku,
Tokyo, 153-8914, Japan}
\email{tyuki@ms.u-tokyo.ac.jp}
\date{\today}

\begin{document}

\begin{abstract}
We use ideas from the Strominger-Yau-Zaslow conjecture and 
Morse theory to consider a tropical version of the Euler 
characteristic of line bundles on algebraic varieties, 
but this time for compact tropical manifolds without 
boundaries. As a preliminary experiment,
we prove a version of the Riemann--Roch formula 
for compact tropical curves and integral affine 
manifolds equipped with a Hessian form. 
Our approach differs from the tropical Riemann--Roch 
theorem established by Gathmann and Kerber.
\end{abstract}
\maketitle
\section{Introduction}
%TODO: 日本語で4000字の論文の要旨

\subsection{Background}

Tropical geometry is a combinatorial and convex 
geometrical analog of
algebraic geometry or analytic geometry.
In tropical geometry,
a main geometric object is represented by 
a \emph{rational polyhedral sapce}, see 
\cite[Definition 2.2]{gross2019sheaftheoretic}. 
A rational polyhedral space is a pair 
$(S,\mathcal{O}^{\times}_S)$ of a 
topological space $S$ and 
the sheaf $\mathcal{O}^{\times}_S$ of 
locally affine linear functions with 
$\mathbb{Z}$-valued slopes such that 
$S$ is locally isomorphic to an open subset
of a polyhedral subset of tropical affine 
spaces $\overline{\mathbb{R}}^{k}=
(\mathbb{R}\cup\{+\infty\})^{k}$.
The sheaf $\mathcal{O}_S^{\times}$ is a tropical analog
of the sheaf $\mathcal{O}_X^{\times}$ of 
units of the structure sheaf $\mathcal{O}_X$ of 
algebraic varieties $X$.
The first cohomology 
$H^{1}(S;\mathcal{O}_S^{\times})$ parameterize the 
isomorphism classes of (tropical) line bundles on $S$
\cite[Proposition 3.13]{gross2019sheaftheoretic}.
A \emph{tropical manifold} is 
a rational polyhedral space which are locally 
isomorphic to the direct product of a 
Bergman fan $\Sigma_M$ for some loopless 
matroid $M$ and a tropical affine space 
$\overline{\mathbb{R}}^{k}$,
see \cite[Definition 6.1]{gross2019sheaftheoretic} 
or the original definition of tropical manifold 
in \cite[Definition 1.14]{mikhalkinTropicalEigenwaveIntermediate2014a}.
A typical example of tropical manifold is 
\emph{tropical curve}
\cite[Definition 3.1]{mikhalkinTropicalCurvesTheir2008a}
(see also \cite[Definition 1.1]{gathmannRiemannRochTheoremTropical2008a}
for a combinatorical definition of tropical curve).
In this paper, the term `tropical curve' refers to a 
$1$-dimensional tropical manifold.
Every (finite) metric graph 
(with no $1$-valent vertex) also has 
a natural structure of tropical curve 
\cite[Proposition 3.6]{mikhalkinTropicalCurvesTheir2008a}.


Many important examples of tropical manifolds (or tropical 
varieties) 
are obtained from a certain type of limits of 
degeneration family of algebraic varieties or 
\emph{tropicalization}. 
The former limit is called the \emph{tropical limit}
\cite{itenbergTropicalHomology2019b}, and 
the fundamental properties of tropicalization 
are detailed in the tropical geometry 
textbook \cite{MR3287221}. 
Algebraic geometry and tropical geometry are 
strongly connected through these operations.

Finding tropical analogues of various theorems 
in algebraic geometry is one of the 
important themes in the study of tropical geometry.
The tropical Riemann--Roch theorem for a 
divisor $D$ on a compact (and connected) tropical curve $C$ is proved 
by Gathmann--Kerber \cite{gathmannRiemannRochTheoremTropical2008a}
as an extension of Riemann--Roch theorem for graphs
\cite{MR2355607} (see also 
\cite{mikhalkinTropicalCurvesTheir2008a}) as 
the following equation: 
\begin{align}
r(D)-r(K_C-D)=\opn{deg}(D)+\chi_{\opn{top}}(C).
\end{align}
where $r(D)$ is the rank of the linear system of 
$D$ 
\cite[Definition 1.12]{gathmannRiemannRochTheoremTropical2008a}, 
$K_C$ is the canonical divisor of $C$
\cite[Definition 1.3]{gathmannRiemannRochTheoremTropical2008a}
and $\chi_{\opn{top}}(C)$ is the topological 
Euler characteristic of $C$.

It is natural to consider a tropical analog of 
the Hirzebruch--Riemann--Roch theorem
(HRR for short), 
a higher-dimensional version of the Riemann--Roch theorem, 
but there are many difficulties in such a generalization.
In other words, tropical Riemann--Roch theorem 
for tropical manifolds has been proved yet 
as a generalization of 
\cite{gathmannRiemannRochTheoremTropical2008a}.
Let's recall the Hirzebruch--Riemann--Roch 
theorem for complex line bundles on 
projective complex manifolds 
before explaining about the difficulties.
\begin{theorem}[{\cite{MR0202713}}]
Let $X$ be a compact projective complex manifold and
$\mathcal{L}$ a holomorphic line bundle on $X$.
Then there exists the following equation:
\begin{align} \label{equation-HRR}
\chi(H^{\bullet}(X;\mathcal{L}))
=\int_X \opn{ch}(\mathcal{L})\opn{td}(X)
\end{align}
where $\opn{ch}(\mathcal{L})$ is the Chern character 
of $\mathcal{L}$, 
$\opn{td}(X)$ is the Todd class of $X$
and $\int_X$ is the trace map of $X$. 
\end{theorem}
We note the HRR is generalized for 
general compact complex 
manifolds as a corollary of Atiyah--Singer index 
theorem. Besides, the HRR for projective complex 
manifold is a special case 
of the Grothendieck--Riemann--Roch theorem (GRR for short). 

The main issue in formulating the HRR 
for line bundles over 
tropical manifolds is that 
tropical analogs of 
$\chi(H^{\bullet}(X;\mathcal{L}))$ and 
$\opn{td}(X)$ have not yet been defined in general.
In particular, the reason why the Euler number 
of line bundles over tropical varieties cannot 
be defined is due to a root cause 
that the basic theory of homological 
algebra cannot be used, 
because line bundles over tropical 
varieties are not sheaves of Abelian groups
but commutative monoids.
(For more detail about the previous related results of 
tropical Riemann--Roch theorem
and more difficulties for 
this problem, see 
\cref{section-tropical-riemann-roch}.)

The following question is the main theme of this 
paper.
\begin{question} \label{question-tropical-euler}
What is a tropical analog of Euler 
characteristic of sheaf 
cohomology of line bundles on algebraic varieties for 
tropical manifolds? Is there some analogs of the HRR 
for this Euler characteristic?
\end{question}

In this paper, we pursue a different tropical
analog of the Euler characteristic of line bundles with the help of 
ideas on toric varieties, geometric prequantization,
Morse theory, microlocal sheaf theory,
the \emph{Strominger--Yau--Zaslow conjecture}
(SYZ conjecture for short), and related topics.
Especially, our approach for 
\cref{question-tropical-euler} is 
strongly influenced by the ideas of the SYZ conjecture.
Roughly speaking, our apporoach is to define
the `Floer complex without differential' instead 
of the `sheaf cohomology of tropical line bundles' 
under the philosophy of \emph{Homological Mirror 
Symmetry}. 
In the next subsection, we will explain the SYZ conjecture 
within the scope necessary for our approach, 
pose a certain conjecture,
and state the main theorem of this paper.
If you are interested in how our approach 
relates to toric geometry and geometric quantization, 
please see \cref{section-toric-geometry} and 
\cref{appendix-geometric-quantization} respectively.
In this paper, we don't discuss the general theory of 
the Todd class of $S$
(see also \cref{remark-todd-class}).
\begin{remark}
\label{remark-todd-class}
We note about the RHS of \cref{equation-HRR} 
for tropical manifolds.
Let $S$ be a compact tropical manifolds.
The \emph{tropical cohomology}
$H^{\bullet,*}(S;\mathbb{Z})$ 
\cite{mikhalkinTropicalEigenwaveIntermediate2014a,
itenbergTropicalHomology2019b}
behaves like singular cohomology 
$H^{\bullet}(X;\mathbb{Z})$ 
of complex manifolds $X$.
We adopted the notation for tropical cohomology 
from \cite[Definition 2.6]{MR3894860}. 
The trace map 
$\int_S\colon H^{\bullet,*}(S;\mathbb{Z})
\to \mathbb{Z}$ also exists like 
complex manifolds, see 
\cref{equation-trace-integration}.  
The $1$-st Chern class $c_1(\mathcal{L})$ of 
tropical line bundle $\mathcal{L}$ and 
the Chow group of rational polyhedral spaces and 
its cycle map is also 
well-studied,
and thus we can define the Chern character
$\opn{ch}(\mathcal{L})\deq 
\sum_{n=0}^{\infty}\frac{c_1(\mathcal{L})^{n}}{n!}
\in H^{\bullet,*}(S;\mathbb{Z})$ of 
$\mathcal{L}$ naturally.
On the other hand, the Todd class of tropical manifold
have not been studied well enough yet  
when the dimension of tropical manifold is greater
than $2$.
We won't discuss the general theory of Todd class of tropical 
manifolds in this paper, 
but should be essentially defined from the theory of 
Chern--Schwartz--MacPherson cycles for matroids 
\cite[Previous work]{lopezdemedranoChernSchwartzMacPhersonCyclesMatroids2020}.
See also \cite[5.3]{mikhalkinTropicalGeometryIts2006} and
\cite[Definition 3.20]{shawTropicalSurfaces2015a}.
\end{remark}

%TODO: ラグランジュ切断に関して説明。

\subsection{SYZ conjecture and main results}

The \emph{Strominger--Yau--Zaslow conjecture} is
a conjecture in mathmatical physics 
derived from string theory \cite{stromingerMirrorSymmetryTduality1996}. 
The SYZ conjecture 
predicts that a mirror $\mathcal{X}$ of 
a given Calabi--Yau manifold
$\check{X}$ gets from the dual 
$f_B\colon \mathcal{X} \to B$
of a special Lagrangian torus fibration 
$\check{f}_{B}\colon \check{X} \to B$ onto 
a topological manifold $B$.
The two fibrations may have singular fibers.
A mathematical formulation of this conjecture is 
expected to induce a quasi-equivalent
functor $\Phi_{\mathrm{SYZ}}$ 
from the Fukaya category 
$\catn{fuk}(\check{X})$ of $\check{X}$ 
to the derived category of coherent sheaves 
$\catn{coh}(\mathcal{X})$ on $\mathcal{X}$, i.e.,
a concrete solution of 
Kontsevich's Homological 
Mirror Symmetry conjecture for Calabi-Yau manifolds
\cite{MR1403918}:
\begin{align} \label{equation-SYZ}
  \Phi_{\mathrm{SYZ}} \colon 
\catn{fuk}(\check{X})\simto \catn{coh}(\mathcal{X}).
\end{align}
The \emph{Fukaya category} of $\check{X}$ 
is a $A_{\infty}$-category
whose object are compact Lagrangian submanifold
$\check{X}$ with additional data. 
To our knowledge, the general definition 
is announced by Abouzaid, Fukaya, Oh, Ohta, and Ono.
Therefore, in the context of mirror symmetry, 
it is often the case that one investigates 
a quasi-isomorphism between the $A_{\infty}$-category, 
which should become a subcategory of the Fukaya category, 
and $\catn{coh}(\mathcal{X})$.
The tranformation by $\Phi_{\mathrm{SYZ}}$ is called 
the \emph{SYZ transform}. 


Well-known examples of special Lagrangian torus 
fibration comes from integral affine manifolds.
An $n$-dimensional 
\emph{integral affine manifold} $B$ 
is a differential manifold 
with a fixed atlas whose transition maps is locally in 
$\opn{GL}(n,\mathbb{Z})\ltimes \mathbb{R}^{n}$.
Every integral affine manifold is a tropical manifold.
Historically, integral affine manifolds are 
deeply-studied in the field of symplectic geometry 
as base spaces of Lagrangian torus fibrations 
\cite{duistermaatGlobalActionangleCoordinates1980a} before
the term `tropical geometry' appeared.
Every integral affine manifold $B$ has 
a canonical $\mathbb{Z}$-local system 
$\mathcal{T}^{\vee}_{\mathbb{Z},B}$ of integer
valued cotangent vectors. The integral affine 
structure of $B$ induces a canonical 
Lagrangian torus fibration 
$\check{f}_{B}\colon \check{X}(B)
\to B$ and its dual 
$f_{B}\colon \mathcal{X}(B)\to B$
\cite{MR1882331}. In this case 
the mirror $\mathcal{X}(B)$ is defined as a 
rigid analytic space.
The SYZ mirror associated with 
integral affine manifold is well-studied in 
\cite{MR1882331,MR3728639,MR3656481,MR4301560}.

The following previous results are important for 
understanding our approach.

\begin{theorem}
\label{proposition-semi-flat-syz}
Let $B$ be a compact integral affine manifold
such that $\pi_2(B)=0$
and $\catn{fuk}(\check{X}(B))$ 
the Fukaya category of $\check{X}(B)$ in the 
sense of \cite{MR4301560}.
Let $\mathcal{O}_{B}^{\times}$ be the sheaf of 
affine functions with $\mathbb{Z}$-valued slopes and 
$\mathcal{C}^{\infty}_{B}$ the sheaf of 
$C^{\infty}$-functions. Then,
\begin{enumerate}
\setlength{\leftskip}{-12pt}
\item The canonical injection 
$\mathcal{O}^{\times}_{B}\hookto \mathcal{C}^{\infty}_{B}$
induces a surjection 
$H^{0}(B;\mathcal{C}^{\infty}_{B}/
\mathcal{O}^{\times}_{B})
\to H^{1}(B;\mathcal{O}^{\times}_{B})$.
\item Every element 
$s\in H^{0}(B;\mathcal{C}^{\infty}_{B}/
\mathcal{O}^{\times}_{B})$ corresponds to 
a \emph{Lagrangian section}, a section 
$\check{s}$ of 
$\check{f}_{B}$ such that $L_s\deq\opn{Im}(\check{s})$ is 
a Lagrangian submanifold of 
$\check{X}(B)$. Besides, 
$L_s$ can be considered as an object
$\mathscr{L}_{s}$ of 
$\catn{fuk}(\check{X}(B))$ by choosing an
additional data.
\item The SYZ transform 
$\mathcal{L}_s$ of $\mathscr{L}_s$ is a line bundle
on $\mathcal{X}(B)$.
\item The SYZ transform induces 
the canonical isomorphism 
$\opn{HF}^{\bullet}(\mathscr{L}_s,\mathscr{L}_{s'})
\simeq \opn{Ext}^{\bullet}_{\mathcal{O}_{\mathcal{X}(B)}}(\mathcal{L}_s,\mathcal{L}_{s'})$
where $\opn{HF}^{\bullet}(\mathscr{L}_s,\mathscr{L}_{s'})$
is the (Lagrangian) Floer cohomology (over the 
Novikov field $\Lambda_{\mathrm{nov}}^{\mathbb{C}}$
with $\mathbb{C}$-coefficients).
In particular, the following isomorphism holds 
for the zero section $s_0$ and $s$:
\begin{align}
\label{equation-hf-sheaf-cohomology}
\opn{HF}^{\bullet}(\mathscr{L}_{s_0},\mathscr{L}_s)
\simeq H^{\bullet}(\mathcal{X}(B);\mathcal{L}_s).
\end{align}
\item If $\mathscr{L}_s$ and 
$\mathscr{L}_{s'}$ intesect transversally, then 
the Floer complex 
$\opn{CF}^{\bullet}(\mathscr{L}_s,\mathscr{L}_{s'})$
of $\opn{HF}^{\bullet}(\mathscr{L}_s,\mathscr{L}_{s'})$ 
can be written by $s,s'$ and $B$
except the differential of 
$\opn{CF}^{\bullet}(\mathscr{L}_s,\mathscr{L}_{s'})$.
In particular, $s$ and $s'$ 
determine the Euler characteristic 
$\chi(\opn{HF}^{\bullet}(\mathscr{L}_s,\mathscr{L}_{s'}))
=\chi(\opn{CF}^{\bullet}(\mathscr{L}_s,\mathscr{L}_{s'}))$.
\end{enumerate}

\end{theorem}
\cref{proposition-semi-flat-syz}. (1), (5), and
the first part of (2) will be explained further 
in \cref{section-integral-affine-manifold} 
and \cref{appendix-integral-affine-manifold}.
If Markus conjecture is true, then the 
assumption $\pi_2(B)=0$ is not necesary,
see \cref{remark-markus-conjecture}.

In a recent study 
\cite{auroux2022lagrangian}, 
SYZ mirror sostudied for the derived category 
of coherent sheaves on algebraic curves 
of general type. 
They also expect their SYZ mirror can be 
generalized for more
general varieties in 
\cite[{\textsection 7}]{auroux2022lagrangian}.

From now on, we present the following conjecture
for boundaryless tropical manifolds 
\cite[\textsection 4.2]{MR4246795},
inspired by \cref{proposition-semi-flat-syz}
and various related works including 
\cite{auroux2022lagrangian}.
Let's recall \cref{remark-todd-class} for notations 
to read the conjecture.

\begin{conjecture}
\label{conjecture-tropical-MRR-preface}
For any compact tropical manifold $S$, 
there exists an element $\opn{td}(S)$ of the tropical 
cohomology group $H^{\bullet,*}(S;\mathbb{Z})$ such that, 
for any tropical line bundle $\mathcal{L}$ on $S$ and 
any $C^{\infty}$-Cartier divisor $s$ representing 
$\mathcal{L}$ that satisfies 
\cref{condition-good-divisor}, 
the following equation holds:
\begin{align}
\chi(\opn{LMD}^{\bullet}(S;s))=
\int_S \opn{ch}(\mcal{L})\opn{td}(S)
\end{align}
where $\opn{LMD}^{\bullet}(S;s)$ is a graded $\Z$-module 
associated with $s$ 
(\cref{definition-local-morse-data-divisor}). 

In particular, 
$\chi(\opn{LMD}^{\bullet}(S;s))=\chi_{\opn{top}}(S)$
when $\mcal{L}$ is trivial.
Besides, such a $C^{\infty}$-Cartier divisor $s$ exists
for any $\mathcal{L}$.
\end{conjecture}
The graded module $\opn{LMD}^{\bullet}(S;s)$ is 
an analog of the Floer complex of the pair of Lagrangian 
sections. In fact, if $B$ is a compact integral affine 
manifold and $s$ is a $C^{\infty}$-Cartier divisor of 
$B$ such that its Lagrangian section $\mathscr{L}_s$ intersects 
with the zero section $\mathscr{L}_{s_0}$ transversely,
then 
\begin{align}
\opn{CF}^{\bullet}(\mathscr{L}_{s_0},\mathscr{L}_{s})
\simeq \opn{LMD}^{\bullet}(S;s)\otimes_{\mathbb{Z}}
\Lambda_{\mathrm{nov}}^{\mathbb{C}}.
\end{align}
However, $\opn{LMD}^{\bullet}(S;s)$ is different 
from any Floer complex of the pair of Lagrangian 
submanifolds when $S$ is not an integral affine 
manifold, see also \cref{remark-calabi-yau-condition} 
if you are interested in this. 
To define $\opn{LMD}^{\bullet}(S;s)$, 
we use tools in microlocal sheaf theory.
\cref{conjecture-tropical-MRR-preface} 
is our mathematical formulation 
of \cref{question-tropical-euler}.


The main results of this paper are that 
the construction of the 
$\opn{LMD}^{\bullet}(S;s)$ and affirmative 
proofs of \cref{conjecture-tropical-MRR-preface}
for compact tropical curves and integral affine 
manifolds with Hessian forms. 

\begin{theorem}[{\cref{theorem-MRR-tropical-curve}}] 
\label{theorem-MRR-curve-preface}
Let $C$ be a compact tropical curve.
For any tropical line bundle 
$\mathcal{L}$ on $B$ and any $C^{\infty}$-Cartier
divisor $s$ satisfying \cref{condition-good-divisor},
the following equation holds:
\begin{align}
\chi(\opn{LMD}^{\bullet}(C;s))=
\int_C c_1(\mathcal{L})+\frac{1}{2}c_1(-K_C)
=\opn{deg}(\mathcal{L})+\chi_{\opn{top}}(C). 
\end{align}
Besides, such a $C^{\infty}$-Cartier divisor $s$ exists
for any $\mathcal{L}$.
\end{theorem}

\begin{theorem}
\label{theorem-MRR-hesse-preface}
Let $B$ be an $n$-dimensional compact integral affine manifold $B$ with 
a Hessian form. For any tropical line bundle 
$\mathcal{L}$ on $B$ and any $C^{\infty}$-Cartier
divisor satisfying \cref{condition-good-divisor},
the following equation holds:
\begin{align}
\chi(\opn{LMD}^{\bullet}(B;s))=
\int_B \frac{c_1(\mathcal{L})^{n}}{n!}.
\end{align}
Besides, such a $C^{\infty}$-Cartier divisor $s$ exists
for any $\mathcal{L}$.
\end{theorem}


We note that our results are highly related with 
 \cite{MR4301560} and \cite{auroux2022lagrangian} 
(see \cref{section-syz-trivalent-graph} and 
\cref{section-floer-lmd} 
for more details), but our theorems 
are self-contained within the language of tropical 
geometry and our proofs do not use the SYZ
transform.


\begin{example}
Let $B$ is a tropical elliptic curve 
$\mathbb{R}/\mathbb{Z}$ and
$f_n\colon \mathbb{R}\to \mathbb{R};
x\mapsto \frac{n}{2}x^{2}$ be a quadratic polynomial
for some $n\in \mathbb{Z}\setminus\{0\}$.
The polynomial induces a $C^{\infty}$-Cartier divisor 
$s_n$ on $\mathbb{R}/\mathbb{Z}$ naturally.
The associated Lagrangian section of $f_n$ is
$s_n'\colon\mathbb{R}/\mathbb{Z}\to 
\check{X}(\mathbb{R}/\mathbb{Z});x\mapsto (x;nx)$.
Then,
\begin{align}
\chi(\opn{LMD}^{\bullet}(B;s_n))=
\sharp(L_{s_0}\cap L_{s_n})=n
=\opn{deg}(s_n)+\chi_{\opn{top}}(\mathbb{R}/\mathbb{Z}). 
\end{align}
This is a typical example of a weaker version of 
\cref{conjecture-tropical-MRR-preface}.
\end{example}

\begin{remark}
We expect our approach works for various style 
of tropical spaces. 
Our approach is 
also inspired from Gross's 
works 
\cite{grossSpecialLagrangianFibrations1998a} 
and Gross--Siebert programs
(see \cite[Conjecture 1.6]{MR3525095}).
If the SYZ conjecture for Calabi--Yau manifolds
is true, our apporoach should
be true for integral affine manifold 
with singularities of Calabi--Yau type.
We expect that 
our approach make sense for not only rational polyhedral
spaces, integral affine manifold with singularities,
but also for tropical spaces 
in the sense of \cite[Definition 2.8]{cavalieri2020tropical}.
\end{remark}

\begin{remark}
\label{remark-calabi-yau-condition}
We note a typical property of Lagrangian 
Floer cohomology which is far from that of 
$\opn{LMD}^{\bullet}(S;s)$ when $S$ is not 
an integral affine manifold.
Let $\check{X}$ be a $2n$-dimensional 
compact symplectic manifold and 
$L_1,L_2$
compact Lagrangian submanifolds of $\check{X}$ 
which has the ($\mathbb{Z}/2\mathbb{Z}$-graded)
Floer cohomology under a certain condition, 
(for example, see \cite[Theorem 1.5]{MR3220941}).
From definition of  
Floer cohomology and 
property of intersection number of cycles of singular 
cohomology, there exists the
following isomorphism:
\begin{align}
\label{equation-floer-poincare}
\chi (\opn{HF}^{\bullet}(L_2,L_1))
=(-1)^{n} 
\chi(\opn{HF}^{\bullet}(L_1,L_2)).
\end{align}

On the other hand, let $\mathcal{X}$ be a 
$n$-dimensional
projective manifold and $\mathcal{L}_1$, $\mathcal{L}_2$ be a
line bundle on $\mathcal{X}$. 
Then, by Serre duality there exists 
the following equation:
\begin{align}
\label{equation-serre-duality}
\chi(\opn{Ext}^{\bullet}_{\mcal{O}_{\mathcal{X}}}
(\mcal{L}_2,\mcal{L}_1))
&= (-1)^{n}\chi(\opn{Ext}^{\bullet}_{\mcal{O}_{\mathcal{X}}}
(\mcal{L}_1,\mcal{L}_2\otimes_{\mathcal{O}_{\mathcal{X}}} 
\upomega_{\mathcal{X}})), \\
\label{equation-serre-line}
\chi(H^{\bullet}(\mathcal{X};\mathcal{L}_1^{\vee}))
&= (-1)^{n}\chi(H^{\bullet}(\mathcal{L}_1
\otimes_{\mathcal{O}_{\mathcal{X}}}\upomega_{\mathcal{X}})).
\end{align}
Here $\upomega_{\mathcal{X}}$ is the canonical bundle on $X$.
If $\mathcal{X}$ is a mirror of $\check{X}$, then 
the (\ref{equation-floer-poincare}) and 
(\ref{equation-serre-duality}) should be compatible.
Obviously, 
$\upomega_{\mathcal{X}}$ is not trivial for many 
projective manifolds $\mathcal{X}$,
and thus we cannot consider the mirror cohomology of 
$\opn{Ext}^{\bullet}_{\mathcal{O}_{\mathcal{X}}}(\mathcal{L}_2,\mathcal{L}_1)$
from classical Lagrangian Floer cohomology directly.
Our
Therefore, we need to replace $\check{X}$ 
with different data when we discuss of the mirror 
symmetry for $\catn{coh}(\mathcal{X})$. 
If $\mathcal{X}$ is Fano, then a
mirror of $\mathcal{X}$ is not a symplectic 
manifold but a Landau--Ginzburg model
$(\check{X},f)$.
Such HMS is discussed for many authors, 
but the relationships between HMS and SYZ
for Fano manifold
are not easier than 
for Calabi--Yau manifolds.
On the other hand, the Euler characteristic 
$\chi(\opn{LMD}^{\bullet}(S;s))$ of 
a permissible $C^{\infty}$-Cartier divisor
$s$ on a tropical manifold $S$ behaves 
like \cref{equation-serre-line} for various 
cases.

\end{remark}

\subsection{Outline of this paper}

This paper is organized as follows:
In Section 2, we define the permissible conditions 
and local Morse data $\opn{LMD}^{\bullet}(S;s)$ for 
$C^{\infty}$-Cartier divisors $s$ on a boundaryless
tropical manifolds.
Section 3 contains the proof of 
\cref{theorem-MRR-curve-preface}.
In Section 4, we prove 
\cref{theorem-MRR-hesse-preface} after preparing from 
the theory of tropical cohomology.
In Section 5, we explain 
more examples satisfying Riemann--Roch type 
formula.

\begin{Note}[Guide for reading this paper]
  In order to reveal the relationships between our study
  and other topics, we cannot avoid introducing various
  notions. However, our results are almost elementary
in the case of tropical curves,
  so we write down a shortcut course of this paper as below:
\end{Note}

\textit{Acknowledgments:}
We would like to thank Felipe Rinc\'on 
for explaining about the unpublished recent works
about Noether formula for general tropical surfaces.
We also thanks Jin Miyazawa
for explaining us a heart of localization of 
the index of Dirac operator and answering some 
questions about it.
We also thank Yoshinori Gongyo for 
giving a question about relationships 
between a kind of Pick's formula for
tropical Kummer surfaces and Atiyah--Singer
index formula. This question gives me 
an opportunity to know \cite{MR2676658}.
We also thank for Kentaro Yamaguchi for explaining about
\cite{MR4234675} and his results of master thesis 
\cite{yamaguchimaster}. We thank for Yuto Yamamoto for
explaining and answering questions about his works in
\cite{yamamotoTropicalContractionsIntegral2021}
and Gross--Siebert programs.
We thanks for Masanori Kobayashi for 
pointing out some mistakes. 
This work was supported by JSPS KAKENHI 
Grant Number 21J14529.



\begin{notation} \label{notation-general}

We will use the following notation in this paper:

\begin{itemize}

%\setlength{\itemsep}{-2pt}
\setlength{\parskip}{0pt}
\setlength{\leftskip}{-20pt}
\item $\underline{\mathbb{R}}\deq 
\mathbb{R}\cup \{-\infty\}$, $\overline{\mathbb{R}}
\deq \mathbb{R}\cup \{+\infty\}$.
\item $\mathbb{T}\deq(\mathbb{R}\cup\{-\infty\},
\opn{max},+)$: the (max-plus) tropical semifield.
\item For every continuous function $f\colon X\to {\mathbb{R}}$,
\begin{align*}
\{f<f(v)\}\deq \set{x\in X\mid f(x)< f(v)},\quad
\{f\geq f(v)\}\deq \set{x\in X\mid f(x)\geq f(v)}.
\end{align*}
\item  For $n\in \mathbb{Z}_{\geq 1}$,
$\|\cdot \|_{\mathbb{R}^{n}}\colon 
\mathbb{R}^{n}\to \mathbb{R};(x_1,\ldots,x_n)\mapsto 
\sqrt{\sum_{i=1}^{n}x_i^{2}}$.
\item For simplicity, $\mathbb{R}^{0}\deq \{0\}$ 
and 
$\|\cdot\|_{\mathbb{R}^{0}}\colon \mathbb{R}^{0}\to \mathbb{R}
; x\mapsto 0$.
\item For $n\in \mathbb{Z}_{\geq 0}$, $\varepsilon,\varepsilon'\in \mathbb{R}_{\geq 0}$
and $x \in \mathbb{R}^{n}$, 
\begin{align*}
B^{n}_{\varepsilon}(x)\deq 
\{v\in \mathbb{R}^{n}\mid \|x-v\|_{\mathbb{R}^{n}}
\leq \varepsilon\},
& \quad  
S^{n-1}_{\varepsilon}(x)\deq \partial B^{n}_{\varepsilon}(x),
\quad \bar{B}^{n}_{\varepsilon}(x)\deq 
B^{n}_{\varepsilon}(x)\cup \partial B^{n}_{\varepsilon}(x),  \\
B_{\varepsilon,\varepsilon'}^{n}(x)\deq 
B^{n}_{\varepsilon}(x)\setminus 
\bar{B}^{n}_{\varepsilon '}(x), 
& \quad \bar{B}_{\varepsilon,\varepsilon'}^{n}(x)\deq 
B_{\varepsilon,\varepsilon'}^{n}(x)\cup 
\partial B_{\varepsilon,\varepsilon'}^{n}(x).
\end{align*}
\item $\opn{Crit}(f)$: the subset of critical points of
a $C^{1}$-function $f$ on a smooth manifold.
\item $\{\opn{pt}\}$: the topological space of 
a fixed singleton set.
\item $a_X\colon X\to \{\opn{pt}\}$:
the continuous map from a topological space $X$ to
$\{\opn{pt}\}$.
\item $A_X$: the constant sheaf on a topological space $X$ 
with fiber $A$.
\item $\catn{Mod}(\mathcal{R})$: the category of 
sheaves of $\mathcal{R}$-modules
(e.g. \cite[Definition 2.2.6]{MR1299726}).
\item $\opn{D}^{b}(\mathcal{C})$: the derived category
of bounded complexes of a given abelian category 
$\mathcal{C}$.
\end{itemize}

\end{notation}

\begin{Note}
We also impose the following assumption for simplicity in this paper:
\begin{itemize}
\setlength{\leftskip}{-20pt}
\item Any topological space is Hausdorff and
locally compact unless otherwise specified.
\item Any ring is a ring with unity.
\item $A$ is a PID.
\item We identify any ring $A$ with a constant sheaf on
$\{\opn{pt}\}$ with fiber $A$.
\item We identify any $A$-module with a sheaf of 
$A_{\{\opn{pt}\}}$-module.
\item Any $C^{\alpha}$-manifold is paracompact for 
$\alpha=0,1,\ldots,\infty,\omega$.
\item We mainly use max-plus algebra.
\end{itemize}



\end{Note}

\section{The cohomological local Morse datum}
In this section, we recall some elementary results
for cohomological local Morse data of sheaves from
\cite{MR2031639,MR1299726}.



\subsection{Sheaf theory on locally compact 
Hausdorff spaces.}
In this subsection, we follow some classical results of
the theory of sheaves on locally compact topological
spaces from \cite{iversenCohomologySheaves1986a,
MR1299726,MR1269324,MR2050072}.
The notion and symbols for 
sheaf theory mainly follows from \cite{MR1299726}
unless otherwise specified.

\subsubsection{Notes for modules over PID}

Henceforth, we assume $A$ is a PID. 
Then, the (global) homological dimension of 
$\catn{Mod}(A)$ is less than or equal to $1$
\cite[Exercise I.17, I.28]{MR1299726}.
Therefore, for any $M^{\bullet}\in \opn{Ob}(\opn{D}^{b}(\catn{Mod}(A)))$
there exists the following quasi-isomorphism 
\cite[Exercise I.18]{MR1299726}:
\begin{align}
M^{\bullet}\simeq 
\bigoplus_{i\in \Z}H^{i}(M^{\bullet})[-i].
\end{align}

Let $\catn{mod}(A)$ be the category of 
finitely generated $A$-modules.
Since $A$ is PID, then the Grothendieck group 
$K_0(\catn{mod}(A))$ is isomorphic to $\Z$ by
the rank $\opn{rk}_A M$ of a finitely generated
$A$-module $M$.
If $M^{\bullet}$ is a bounded $\Z$-graded finitely generated $A$-module,
then we can define the Euler characteristic 
$\chi(M^{\bullet})\deq 
\sum_{i\in \Z}(-1)^{i}\opn{rk}_A M^{i}$.
If $(M^{\bullet},d)$ is a bounded chain complex of finitely 
generated $A$-module, then 
$\chi(M^{\bullet})=\chi(H^{\bullet}(M^{\bullet}))$.
We note $K_0(\mathcal{C})\simeq 
K_0(\opn{D}^{b}(\mathcal{C}))$ for any abelian category 
\cite[Exercise I.27]{MR1299726}.

\subsubsection{Some operations of sheaves}

From now on, we recall some elementary 
operations of sheaves. 
Let $f\colon Y\to X$ be a continuous map.
$f$ induces the functor $f_!$ of
the direct image with proper supports 
\cite[(2.5.1)]{MR1299726}. 
We note $a_{X!}\mathcal{F}\simeq \Gamma_c(X;\mathcal{F})$.

Let $X$ be a topological space, $Z$ a locally closed 
subset of $X$
and $i\colon Z\to X$ be the inclusion map.
For a given sheaf $\mathcal{F}$ on $X$, 
\begin{align}
\mcal{F}|_{Z}\deq i^{-1}\mcal{F}, \quad 
\mcal{F}_Z\deq i_! i^{-1}\mcal{F}, \quad 
(A_X)_Z\deq i_!i^{-1}A_X, \quad \Gamma(Z;\mathcal{F})=\Gamma(Z;\mathcal{F}|_{Z})
\end{align}

From \cite[Proposition 2.5.4]{MR1299726}, $i_!$ is exact 
and $\mcal{F}_Z$ is isomorphic to the sheaf defined in
\cite[p.93]{MR1299726}.
If $Z'$ be a closed subset of $Z$, then
there exists the following exact sequence 
\cite[Proposition 2.3.6.(v)]{MR1299726}:
\begin{align}
0\to \mathcal{F}_{Z\setminus Z'} \to 
\mathcal{F}_Z \to \mathcal{F}_{Z'}\to 0.
\end{align}

Let $\Gamma_{Z}(\mcal{F})$ be the sheaf of sections of 
$\mcal{F}$ supported by a locally closed subset $Z$
\cite[Definition 2.3.8]{MR1299726} and 
$\Gamma_{Z}(X;\mcal{F})$ the global section of 
$\mathcal{F}$ supported by $Z$.
This sheaf is defined as follows:

\begin{enumerate}
\item Let $U$ be a open subset of $X$ such that $U$ contains
$Z$ as a closed subset of $U$ then we write
\begin{align}
  \Gamma_Z(U;\mcal{F})\deq \opn{Ker}(\mcal{F}(U) \to 
\mcal{F}(U\setminus Z)).
\end{align}
\item If $V$ is an open subset of $U$ contain $Z$, then
$\Gamma_{Z}(U;\mcal{F})\simeq \Gamma_{Z}(V;\mcal{F})$
via the canonical morphism. Therefore, we can define
$\Gamma_{Z}(X;\mcal{F})\deq \Gamma_{Z}(U;\mcal{F})$.
\item The sheaf $\Gamma_{Z}(\mcal{F})$ is defined as the presheaf 
$U\mapsto \Gamma_{Z\cap U}(U;\mcal{F})$ on $X$.
\end{enumerate}

$\Gamma_Z(X;\cdot)$ is a left exact functor from 
$\opn{Mod}(A_X)$ to $\opn{Mod}(A)$,
and $\Gamma_{Z}(\cdot)$ is a left exact functor from
$\opn{Mod}(A_X)$ to $\opn{Mod}(A_X)$ 
\cite[Proposition 2.3.9 (i)]{MR1299726}.



If $j\colon V\to X$ is an open inclusion of $X$, then 
$\Gamma_V(\mathcal{F})\simeq j_*j^{-1}\mathcal{F}$ 
\cite[Proposition 2.3.9 (iii)]{MR1299726}.

Let $f\colon Y\to X$ be a continuous map,
$\mathcal{F}\in \opn{Ob}(\catn{Mod}(A_X))$
and $\mathcal{G}\in\opn{Ob}(\catn{Mod}(A_Y))$.

Then, we have the following isomorphism 
\cite[(2.3.19)-(2.3.20)]{MR1299726}:
\begin{align}
f^{-1}\mathcal{F}_Z\simeq 
(f^{-1}\mathcal{F})_{f^{-1}(Z)},\quad 
\Gamma_Zf_*\mathcal{G}\simeq f_*\Gamma_{f^{-1}(Z)}
\mathcal{G}.
\end{align}

Let $\mathscr{I}$ be the full subcategory of 
$\opn{Mod}(A_X)$ consisting of flabby sheaves. 
Then $\mathscr{I}$ is $\Gamma_{Z}$-injective and
$\Gamma_{Z}(\mathcal{I})\in\mathscr{I}$ for 
$\mathcal{I}\in \mathscr{I}$ \cite[Proposition 2.4.6]{MR1299726}.

Let $X$ be a topological space, $Z$ a locally 
closed subset of $X$ and $Z'$ a closed subset of $Z$.

There exists the following distinguished triangle 
for any $\mathcal{F}^{\bullet}\in \opn{Ob}(\opn{D}^{b}(A_X))$ 
\cite[(2.6.32)]{MR1299726}:
\begin{align} \label{equation-exact-local}
  R\Gamma_{Z'}(\mcal{F}^{\bullet})\to 
R\Gamma_{Z}(\mcal{F}^{\bullet})\to 
R\Gamma_{Z\setminus Z'}(\mcal{F}^{\bullet})\xto{[1]} 
R\Gamma_{Z'}(\mcal{F}^{\bullet})[1].
\end{align}

\begin{example}
\label{example-local-cohomology}
Let $Z$ be a open subset of $X$ 
$\mathcal{F}^{\bullet}=A_{X}$ 
and $U=Z\setminus Z'$.
By taking the global 
section for \cref{equation-exact-local}, we get 
the following exact sequence:
\begin{align}
  \cdots \to H^{i}_{Z'}(X;A_X)\to
H^{i}(Z;A_{Z})\to H^{i}(U;A_U)\to 
H^{i+1}_{Z'}(X;A_X) \to \cdots.
\end{align}
If $H^{\bullet}(X;A_X)$ and $H^{\bullet}(U;A_U)$ 
is isomorphic to the singular cohomology of $X$ and $U$
respectively, $H^{\bullet}_{Z'}(X;A_X)$ is isomorphic to
the singular cohomology group of the topological space 
pair $(Z,U)$.
The cohomology $H^{\bullet}_{\{x\}}(X;A_X)$ is called
the local cohomology of $X$ at $x$.
If $Z$ is acyclic and $x\in Z$, then $H^{\bullet}_{\{x\}}(X;A_X)$ is 
isomorphic to the $(-1)$-shift of the reduced cohomology 
$\tilde{H}^{\bullet-1}(Z\setminus \{x\};
A_{Z\setminus \{x\}})$
of the constant sheaf on $Z\setminus \{x\}$.
(see 
\cite[p.199]{hatcherAlgebraicTopology2002a} for 
reduced singular cohomology.)
\end{example}

\begin{example}

We mention two elementary properties 
about stalks of $R\Gamma_{Z}(\mcal{F})$ of a sheaf on 
$X$.

\begin{enumerate}
\item Let $j:V\to X$ be an open inclusion and $Z$ be a 
closed subset of $X$. Then, 
\begin{align}
\Gamma_{Z\cap V}(\mathcal{F}|_V)=\Gamma_{Z}(\mathcal{F})|_V.
\end{align}
We can see the above from definition or the following 
equation:
\begin{align}
\Gamma_{j^{-1}(Z)} \circ j^{-1}
=j^{-1}\circ j_*\circ \Gamma_{j^{-1}(Z)} \circ j^{-1}
=j^{-1}\circ\Gamma_{Z}\circ \Gamma_V
=j^{-1}\circ \Gamma_V \circ \Gamma_Z
=j^{-1} \circ \Gamma_Z.
\end{align}
$j^{-1}=j^{!}$, and thus 
$R\Gamma_{j^{-1}(Z)} \circ j^{-1}=j^{-1}\circ R\Gamma_Z$.
Here, we used $j^{!}$ is the right adjoint of 
the exact functor $j_!$.
In particular, for any point $v\in V$ we have
\begin{align}
(R\Gamma_{Z\cap V}(\mcal{F}|_{V}))_v\simeq 
(R\Gamma_{Z}(\mcal{F}))_v.
\end{align}



Therefore, the stalk is independent of 
the choice of $V (\ni v)$.
\item Let $i: S\to X$ be a closed inclusion.
Since $i_!=i_*$ and $i_!$ is exact,
\begin{align}
  i^{-1}R\Gamma_{Z}(i_*\mcal{F})\simeq 
i^{-1}R(\Gamma_{Z}\circ i_*)\mcal{F}
  \simeq i^{-1}R(i_*\circ \Gamma_{i^{-1}(Z)})\mcal{F}
  \simeq R\Gamma_{Z\cap S}\mcal{F}
\end{align}
In particular, $(R\Gamma_{Z}(i_*\mcal{F}))_v
  \simeq (R\Gamma_{Z\cap S}\mcal{F})_v$ for $v\in S$.
\end{enumerate}

By combining the above two examples, for an open 
subset $V' (\ni v)$ of $S$ we get 
\begin{align} \label{equation-local-stalk}
(R\Gamma_{Z}((A_{X})_S))_v\simeq 
(R\Gamma_{Z\cap S}(A_{S}))_v\simeq
(R\Gamma_{Z\cap S\cap V'}(A_{V'}))_v.
\end{align}

\end{example}




\subsection{Cohomological local Morse data and index}

The following stalk complex (or graded module) is 
the most important notion
for this paper which is naturally appeared in
microlocal sheaf theory \cite{MR1299726}, 
and which is called ``local Morse datum'' in \cite[p.271]{MR2031639} 
or microlocal stalk in \cite{MR4132582}.
\begin{definition}[{Cohomological local Morse datum}]
\label{definition-local-morse-data}
Let $f\colon X\to {\mathbb{R}}$ be a continuous map on a 
topological space $X$ and $x\in X$. Fix 
$\mathcal{F}^{\bullet}\in 
\opn{Ob}(\opn{D}^{b}(\catn{Mod}(A_X)))$.
The cohomology group of the \emph{cohomological local Morse 
data} of the pair $(\mathcal{F}^{\bullet},f)$ at $x$ 
is the following $A$-module: 
\begin{align}
\opn{LMD}^{\bullet}(\mcal{F}^{\bullet},f,x)\deq 
H^{\bullet}(R\Gamma_{\{f\geq f(x)\}}\mathcal{F}^{\bullet})_x
=H^{\bullet}(R\Gamma_c(\{x\};R\Gamma_{\{f\geq f(x)\}}
\mathcal{F}^{\bullet})).
\end{align}

The \emph{local Morse index} of $f$ at $x$ is the 
following number if 
$R\Gamma_{\{f\geq f(x)\}}\mathcal{F}^{\bullet})_x
\in \opn{D}^{b}(\catn{mod}(A))$:
\begin{align} \label{equation-local-index}
\opn{ind}_x^{A}(f)\deq \chi(\opn{LMD}^{\bullet}(A_X,f,x)), \quad
\opn{ind}_x(f) \deq \opn{ind}_x^{\mathbb{Z}}(f).
\end{align}

\end{definition}

In this paper, we simply say 
\emph{local Morse data} as cohomological Morse data 
if we are not afraid of confusing it with local Morse data
in the theory of stratified Morse theory 
\cite[Part I. Definition 3.5.2]{MR932724}.

\begin{remark}
\begin{enumerate}
\item We follow the above notation from 
\cite[p.271]{MR2031639} for two reasons.
One of this is for easy to see the triple 
$(\mcal{F}^{\bullet},f,x)$. 
The other one is for emphasizing on analogy to
Morse complexes, see \cref{example-poincare-hopf}.
\item The name of local Morse data may be misleading.
We don't assume $f$ satisfies some 
`Morse condition' since
 we need to use some $C^{\infty}$-function
which is \emph{not} a Morse function in the sense of 
stratified Morse theory. 
We will give an explanation in 
\cref{remark-nondeprave-curve}.
Moreover, 
$\opn{LMD}^{\bullet}(\mathcal{F}^{\bullet},f,x)$
is closely related with (real) Milnor fiber, so
the name \emph{(cohomological) local Milnor data} may 
be more appropriate 
than the name cohomological local Morse data. 
\item We also note that we need to use 
the graded module $\opn{LMD}^{\bullet}(\mcal{F},f,x)$ instead of 
the complex $R\Gamma_{\{f\geq f(x)\}}\mathcal{F}$ in order to define
a graded module associated with line bundle on tropical
spaces. See also \cref{remark-differential-graded-module} for more about 
this reason.
\end{enumerate}
\end{remark}

Before we see some important examples of cohomological
local Morse datum, we will see some elementary
properties of them.







By \cref{equation-local-stalk}, we get the following
isomorphism:

\begin{proposition} \label{prop-local-morse-data}
Let $f\colon X\to \mathbb{R}$ be a continuous function
on $X$, $S$ a closed subset
of $X$, $V$ open subset of $S$ and $x\in V$. Then,
\begin{align} 
\opn{LMD}^{\bullet}((A_{X})_S,f,x
) &\simeq  
\opn{LMD}^{\bullet}(A_S,f|_S,x)
\simeq \opn{LMD}^{\bullet}(A_{V},f|_V,x) \\
&\simeq \varinjlim_{U\in\opn{Nbh}(x,S)} 
\tilde{H}^{\bullet-1}(S\cap \{f<f(x)\}\cap U;A).
\end{align}

Here, $\tilde{H}^{i-1}(X;A)$ is the $(i-1)$-th reduced cohomology 
group
of $A_X$ and $\opn{Nbh}(x,S)$ the set of open neighborhoods
of $x$ in $X$. 
\end{proposition}
\begin{proof}
The fist and second isomorphism follows from
\cref{equation-local-stalk} by 
replacing $Z$ (resp. $V'$) with 
$\{f\geq f(x)\}$ (resp. $V$) and the isomorphism
$H^{\bullet}(\mathcal{F}^{\bullet})_x\simeq 
H^{\bullet}(\mathcal{F}^{\bullet}_x)$ for any 
$\mathcal{F}^{\bullet}\in D^{b}(A_X)$ and $x\in X$.

From now on, we may assume $S=X$.
From \cref{equation-exact-local} and by taking stalks,
we have the following distinguished triangle:
\begin{align}
(R\Gamma_{\{f\geq f(x)\}}A_S)_x \to 
(A_S)_x\to 
(R\Gamma_{\{f<f(x)\}}A_S)_x\to 
(R\Gamma_{\{f\geq f(x)\}}A_S)_x[1].
\end{align}
Let $j\colon \{f<f(x)\}\to S$ be the open inclusion map. 
We can see 
$R\Gamma_{\{f< f(x)\}}\simeq Rj_*\circ j^{-1}$
from $j^{-1}=j^{!}$ preserve injectives.
From the elemental properties of higher direct image
(e.g. \cite[II. Proposition 5.11]{iversenCohomologySheaves1986a}),
we have
\begin{align}
(R^{i}\Gamma_{\{f< f(x)\}}A_S)_x\simeq 
(R^{i}j_* A_{\{f<f(x)\}})_x \simeq 
\varinjlim_{U\in \opn{Nbh}(x,S)} 
H^{i}(\{f<f(x)\}\cap U;A).
\end{align}
\end{proof}

We will see several examples of local Morse data.

\begin{example}
Let $f\colon X \to \mathbb{R}$ a continuous function 
such that $\{f<f(x_0)\}\cap S=\emptyset$ and 
$\{f=f(x_0)\}\cap S=\{x_0\}$ for some $x_0\in X$. 
Then,
\begin{align}
\opn{LMD}^{\bullet}(A_S,f|_{S},x_0)\simeq 
\tilde{H}^{\bullet-1}(\emptyset;A)\simeq A[0].
\end{align}

\end{example}

\begin{example} \label{example-fundamental-system}
Let $\{U_j\}_{j\in J}$ be an open fundamental system of 
$x\in X$ satisfying
$H^{\bullet}(\{f<f(x)\}\cap U_j;A)\simeq 
H^{\bullet}(\{f<f(x)\}\cap U_{j'};A)$ via the 
inclusion map $U_{j'}\hookto U_j$. Then, 
\begin{align}
\opn{LMD}^{\bullet}(A_X,f,x)\simeq H^{\bullet-1}(\{f<f(x)\}\cap U_j;A).
\end{align}

\end{example}

\begin{example}
\label{example-morse-index}
In this example we see
the local Morse index of is a certain generalization of 
Poincar\'e--Hopf index of the gradient 
$\opn{grad}(f)$ of a smooth function $f$ 
when $f$ is a Morse function. 
we recall \cref{notation-general}
and set
\begin{align}
f_{n,m}\colon \mathbb{R}^{n}\times \mathbb{R}^{m}\to \mathbb{R};
(x,y)\mapsto \|x\|_{\mathbb{R}^{n}}^2
-\|y\|_{\mathbb{R}^{m}}^2.
\end{align}
In order to calculate 
$\opn{LMD}^{\bullet}(A_{\mathbb{R}^{n+m}},f_{n,m},0)$, we 
see
\begin{align}
\partial (\bar{B}^{n}_{\varepsilon}(0)
\times \bar{B}^{m}_{\varepsilon}(0))=
& S^{n-1}_{\varepsilon}(0)\times B^{m}_{\varepsilon}(0) 
\cup B^{n}_{\varepsilon}(0)\times S^{m-1}_{\varepsilon}(0) \\
& \cup 
S^{n-1}_{\varepsilon}(0)\times S^{m-1}_{\varepsilon}(0) \\
=& \{\|\cdot\|_{\mathbb{R}^{n}}=\varepsilon\} 
\times \{\|\cdot\|_{\mathbb{R}^{m}} < \varepsilon\} 
\cup \{\|\cdot\|_{\mathbb{R}^{n}} < \varepsilon\} \times 
\{\|\cdot\|_{\mathbb{R}^{m}}= \varepsilon\} \\
& \cup 
\{\|\cdot\|_{\mathbb{R}^{n}}=\varepsilon\} \times 
\{\|\cdot\|_{\mathbb{R}^{m}}= \varepsilon\}.
\end{align}

Therefore,  
\begin{align}
\partial (\bar{B}^{n}_{\varepsilon}(0)
\times \bar{B}^{m}_{\varepsilon}(0)\cap 
\{f_{n,m}<f_{n,m}(0)\}
= B^{n}_{\varepsilon}(0)\times S^{m-1}_{\varepsilon}(0).
\end{align}

The above equation and \cref{prop-local-morse-data} 
gives
\begin{align}
\opn{LMD}^{\bullet}(A_{\mathbb{R}^{n+m}},f_{n,m},0)\simeq 
\tilde{H}^{\bullet-1}(S^{m-1};A_S) \simeq A[-m],& \\
\opn{ind}^{A}_{0}(f_{n,m})=(-1)^{m}=
\opn{ind}^{\opn{PH}}_{0}(\opn{grad}(f_{n,m})).&
\end{align}
Here, $\opn{ind}^{\opn{PH}}_{0atod}(\opn{grad}(f_{n,m}))$ is 
the Poincar\'e-Hopf index of $f_{n,m}$ at 
the origin $0$.
From Morse lemma,
for every critical point $x$ on a Morse function 
$f\colon X\to \mathbb{R}$ on a smooth manifold 
$\opn{ind}_x^{A}(f)=\opn{ind}^{\opn{PH}}_x(f)$. 
This equation can be generalized for more cases.
\end{example}




If $X$ is a locally compact space, then there exists a 
closed and compact neighborhood $S$ of $x\in X$. 
By the second isomorphism of \cref{prop-local-morse-data},
we have 
$\opn{LMD}^{\bullet}(A_X,f,x)\simeq 
\opn{LMD}^{\bullet}(A_S,f|_S,x)$, so 
we can choose a sufficiently small closed and 
compact neighborhood 
of $x$. 









By \cref{prop-local-morse-data}, we can calculate
of local Morse index of a continuous function on 
a given polyhedral complex by the theory of sheaves on 
real manifolds.

\begin{notation}

We denote $Y\deq 
\{x\in X\mid \opn{LMD}^{\bullet}(\mathcal{F}^{\bullet},f,x)
\not \simeq 0\}$ and set

\begin{align}
\opn{LMD}^{\bullet}(\mathcal{F}^{\bullet},f)\deq 
\bigoplus_{x\in Y}
\opn{LMD}^{\bullet}(\mathcal{F}^{\bullet},f,x).
\end{align}
\end{notation}

The graded module $\opn{LMD}^{\bullet}(\mathcal{F}^{\bullet},f)$
behaves like the graded part of a Morse complex in Morse 
homology when $X$ is a smooth manifold.

Next, we recall about the micro-support of sheaves 
from \cite{MR1299726}.
Let $X$ be a $C^{\alpha}$ manifold for
$\alpha\in\{1,2,\ldots,\infty,\omega\}$ and let
$\mcal{F}^{\bullet}\in\opn{Ob}(\opn{D}^{b}(A_X))$ and
$\opn{SS}(\mcal{F}^{\bullet})$ 
the micro-support of $\mcal{F}^{\bullet}$:
\begin{definition}[{Citation 
\cite[Definition 5.1.2]{MR1299726}}]
The element $p\in T^{*}X$ 
is  $p\notin \opn{SS}(\mathcal{F}^{\bullet})$
if there exists an open neighborhood $U$ of $p$ such 
that for any $x_1\in X$ any any real 
function $\psi$ of class $C^{\alpha}$ defined 
in a neighborhood $V$ of $x_1$, with 
$d\psi(x_1)\in U$, we have
\begin{align}
(R\Gamma_{\{\psi \geq \psi(x_1)\}}(\mathcal{F}^{\bullet}|_V))_{x_1}
\simeq 0,\, \mathrm{i.e.} \, , 
\opn{LMD}^{\bullet}(\mathcal{F}^{\bullet}|_V,\psi,x_1)
\simeq 0.
\end{align}

\end{definition}

As remarked in \cite[Remark 5.1.6]{MR1299726},
the dependence of the micro-support 
$\opn{SS}(\mcal{F}^{\bullet})$ is solely 
on the $C^{1}$-structure of $X$, and the forgetful functor 
$\phi_X \colon \opn{D}^{b}(A_X)\to \opn{D}^{b}(\Z_X)$
preserves the micro-support of $\mcal{F}^{\bullet}$ 
\cite[Remark 5.1.5]{MR1299726}.

\begin{example}
If $M$ is a closed submanifold of $X$, then
$\opn{SS}((A_{X})_M)=T^{*}_M X$ \cite[Proposition 5.3.2]{MR1299726}.
\end{example}
For simplicity,
$\opn{SS}(\mcal{F})_x\deq \opn{SS}(\mcal{F}) 
\cap T^{*}_x X$ 
and $\check{\pi}_{X}\colon T^{*}X\to X$
is the cotangent bundle.
From definition of the micro-support of sheaves, 
$\opn{SS}(\mcal{F}|_{U})_x=\opn{SS}(\mcal{F})_x$
for any open neighborhood $U$ of $x$.





The following condition and proposition is also important.
\begin{condition}[{\cite[Proposition 5.4.20]{MR1299726}}]
\label{condition-global-morse}
Let $X$ be a smooth manifold, $A$ a PID, 
$\mathcal{F}^{\bullet}\in \opn{D}^{b}(A_X)$,
and $f\colon X\to \mathbb{R}$ a smooth function.
The pair $(\mathcal{F}^{\bullet},f)$ satisfies
\begin{enumerate}
\item for all $t\in \mathbb{R}$, 
$\{x\in\opn{supp}(\mathcal{F}^{\bullet})\mid f(x)\leq t\}$ 
is compact,
\item $\sharp (\Lambda_f\cap \opn{SS}(\mathcal{F}^{\bullet}))
<\infty$ where $\Lambda_f$ is the image of 1-form 
$df\colon X\to T^{*}X$,
\item the graded module 
$\opn{LMD}^{\bullet}(\mathcal{F}^{\bullet},f)$ 
is finitely generated.



\end{enumerate}

\end{condition}







\begin{proposition}[{\cite[Proposition 5.4.20]{MR1299726},
\cite[Remark 1.2]{MR1160840}}]
Under the \cref{condition-global-morse}, 
\begin{align}
\chi(H^{\bullet}(X;\mathcal{F}^{\bullet}))=
\chi (\opn{LMD}^{\bullet}(\mathcal{F}^{\bullet},f)).
\end{align}

\end{proposition}
This proposition can be considered as the intersection 
of two Lagrangian cycles in $T^{*}X$ when 
$\mathcal{F}^{\bullet}$ is a complex of 
constructible sheaves on an analytic manifold,
see \cite[Corollary 9.5.2, Theorem 9.5.6]{MR1299726}.
This is called the microlocal index formula or Kashiwara's 
index formula.

\begin{remark}
We can cahnge \cref{condition-global-morse}.(2) 
to a weaker version \cite[(H.2)]{MR1160840}:
\begin{enumerate}
\setlength{\leftskip}{0pt}
\item[(2)'] $\check{\pi}_X(\Lambda_f\cap \opn{SS}(\mathcal{F}^{\bullet}))$
is a finite disjoint union of compact subsets of $X$ and
$f|_{\check{\pi}_X(\Lambda_f\cap \opn{SS}(\mathcal{F}^{\bullet}))}$ 
is locally constant.
\end{enumerate}
If $X$ is compact and $f$ is constant, then 
the pair $(A_X,f)$ satisfies 
\cref{condition-global-morse}.(1),(3) and (2)' but not 
(2).
\end{remark}

\begin{example}
Let $M$ be a compact integral affine manifold and $S$  
a compact rational polyhedral subspace in $M$ and 
$\iota\colon S\hookto M$ the inclusion map of $S$. 
Let $f\colon M \to \mathbb{R}$ be a smooth function such
that the pair $(\iota_*\mathbb{R}_S,f)$ satisfies 
\cref{condition-global-morse}:
\begin{align}
\chi(H^{\bullet}(M;\iota_*\mathbb{R}_S))
=\chi(\opn{LMD}(\iota_*\mathbb{R}_S,f))
\end{align}
for any smooth function $f\colon M\to \mathbb{R}$.
Therefore, this is a certain sheaf theoretic version of 
Poincar\'e--Hopf theorem for some polyhedral spaces. Under
the \cref{observation-tropical-euler}, 
$H^{\bullet}(M;\iota_*k_S)$
 should be considered as a
certain analog of 
$H^{\bullet}(X;\iota_*\mcal{O}_Z)$ for closed embedding of 
scheme.
\end{example}

\begin{example}[{cf. \cite[Exercise V.12]{MR1299726}}]
\label{example-poincare-hopf}
Let $U$ be an open neighborhood of the origin 
$0\in \mathbb{R}^{n}$,
$f\colon U\to \mathbb{R}$ be a smooth 
function 
with a unique isolated critical point at $0$. 
From \cref{prop-local-morse-data},
$\opn{LMD}^{\bullet}(A_U,f,0)\simeq 
\opn{LMD}^{\bullet}(A_{B_{\varepsilon}(0)},
f|_{B_{\varepsilon}(0)},0)\simeq 
\opn{LMD}^{\bullet}(A_{\bar{B}_{\varepsilon}(0)},
f|_{\bar{B}_{\varepsilon}(0)},0)$ 
for a sufficiently small $\varepsilon \in \mathbb{R}_{>0}$.
Fix $\varepsilon$ and an open smooth 
inclusion of $j\colon U \to M$
where $M$ is a compact smooth manifold,
$x_0\deq j(0)$ and $K\deq j(\bar{B}_{\varepsilon}(0))$. 
$S^{n}$ is a typical example of $M$.
The sheaf $\mathcal{C}^{\infty}_M$ of smooth functions 
on $M$ is c-soft, so we can extend
$f|_{\bar{B}_{\varepsilon}(0)}$ to 
$f_0\in C^{\infty}(M)$.
From \cref{prop-local-morse-data}, 
$\opn{LMD}^{\bullet}(A_M,f_0,x_0)
\simeq \opn{LMD}^{\bullet}(A_U,f,0)$.
By Morse perturbation, we can deform 
$f_0$ to a smooth function $f_1$ such that 
$f_0|_{K}=f_1|_K$ and $f_1$ is nondegenerate except at 
$x_0$. If $\opn{LMD}^{\bullet}(A_U,f,0)$ is 
a finitely generated graded $A$-module,
then we have
\begin{align} \label{equation-local-poincare-hopf}
\chi(H^{\bullet}(M;A))=
\chi(\opn{LMD}^{\bullet}(A_M,f_1,x_0))+
\sum_{x\in \opn{Crit}(f_1)\setminus \{x_0\}}
\chi(\opn{LMD}^{\bullet}(A_M,f_1,x))
\end{align}
by \cite[Proposition 5.4.20]{MR1299726}
when $\opn{LMD}^{\bullet}(A_M,f_1,x_0)$ is finitely
generated.
From Poincar\'e--Hopf theorem and 
\cref{example-morse-index}, 
\begin{align} \label{equation-poincare-hopf}
\opn{ind}_0^{A}(f)=
\opn{ind}_x^{A}(f_1) =
\opn{ind}_x^{\opn{PH}}(\opn{grad}(f_1))=
\opn{ind}_0^{\opn{PH}}(\opn{grad}(f)) 
\end{align}
where $\opn{ind}^{\opn{PH}}_x(\opn{grad} f)$ is the 
Poincar\'e--Hopf index at $x$ of the gradient
vector field of $f$ 
for a fixed Riemannian metric.
We note
$\opn{LMD}^{\bullet}(A_M,\tilde{f})=
\bigoplus_{x\in \opn{Crit}(\tilde{f})}
\opn{LMD}^{\bullet}(A_M,\tilde{f},x)$ is isomorphic
to the graded module of an $A$-valued Morse complex of 
$\tilde{f}$ when $\tilde{f}$ is a Morse function.
\end{example}







%TODO: 適切な箇所に配置

% \begin{remark}
% Since the global homological 
% dimension of $A$ is finite,
% the weak global dimension of $A_X$ \cite[Definition 2.6.2]{MR1299726} is also finite.
% \end{remark}



% \begin{definition}[{\cite{MR4294126}}]

% \end{definition}

% Every PL set is subanalytic, and thus 
% we can use the theory of microsupport of sheaves
% effectively.
% Let $\mcal{F}$ be a 

% Every real analytic function is \emph{nondepraved} 
% \cite[Part I, Definition. 2.3,]{MR932724} and
% every nondepraved function $f\colon \to {\mathbb{R}}$ satisfies Whitney b-condition
% for the pair $(\{f(x)=0\},x)$. Such a function satisfies the 
% following condition

% Let $S$ be a rational PL set in ${\mathbb{R}}^{n}$ and
% $f$.

The following example is a $C^{\infty}$-function on a 
smooth manifold with an unique isolated critical point such
that $\opn{LMD}^{\bullet}(A_M,f)$ is bounded and 
finitely generated.


\begin{example}
Let $f\colon M\to \mathbb{R}$ be a 
$C^{\infty}$-function on a compact smooth
Riemannian manifold 
$(M,g)$ and 
$\varepsilon$ a 
sufficiently small positive real number. Then, 
\begin{align}
\opn{LMD}^{\bullet}(A_{M},f,x)\simeq 
\opn{LMD}^{\bullet}(A_{\bar{B}_{\varepsilon}^{n}(x)},
f|_{\bar{B}_{\varepsilon}^{n}(x)},x) \simeq 
\opn{LMD}^{\bullet}(A_{\bar{B}_{\varepsilon}^{n}(x)},
f|_{\bar{B}_{\varepsilon}^{n}(x)},x).
\end{align}

If $f$ is smooth and has a unique isolated \emph{nondepraved} 
critical point at $x$, then 
$\{\{f=f(x)\}\setminus \{x\}$ is a smooth submanifold 
and $\{\{f=f(x)\}\setminus \{x\},\{x\} \}$ induces 
a stratification satisfying Whitney's condition B
\cite[Part I. Lemma 2.5.1]{MR932724}. 
We can assume $f$
For sufficiently small $\varepsilon\in \mathbb{R}_{> 0}$, 
$S_{\varepsilon}(x) \cap \{f=f(x)\}$ 
intersect transversely \cite[Part I. Lemma 3.5.1]{MR932724},
and thus $S_{\varepsilon}(x) \cap \{f=f(x)\}$
is also a submanifold and compact.
A relative version of Ehresmann's lemma for 
$\|\cdot\|_{\mathbb{R}^{n}}^2$ induces the 
following homeomorphism of pairs of smooth manifold 
with boundary:
\begin{align}
&(\bar{B}_{\varepsilon}^{n}(x)\setminus \{x\}, 
 \bar{B}_{\varepsilon}^{n}(x)\cap \{f=f(x)\} \setminus \{x\}) \\ 
\simeq & ((0,\varepsilon] \times S_{\varepsilon}^{n-1}(x),
(0,\varepsilon] \times
(S_{\varepsilon}^{n-1}(x) \cap \{f=f(x)\})). \notag
\end{align}
The proof of relative version of Ehresmann's lemma is 
in \cite{359708}.
Besides, there exists a homeomorphism of pairs of
topological spaces:
\begin{align}
(\bar{B}_{\varepsilon}^{n}(x),
\bar{B}_{\varepsilon}^{n}(x)\cap \{f=f(x)\})
\simeq (\opn{Cone}(S_{\varepsilon}^{n-1}(x)),
\opn{Cone}(S_{\varepsilon}^{n-1}(x) \cap \{f=f(x)\})).
\end{align}
Here $\opn{Cone}(X)$ is the topological cone over
$X$ \cite[Example 4.4]{hatcherAlgebraicTopology2002a}.
This homeomorphism is classically proved when 
$f$ is real analytic function and $x$ is an 
isolated critical point
\cite[Theorem 2.10]{MR0239612}.
The homeomorphism induces 
\begin{align}
\opn{LMD}^{\bullet}(A_{\bar{B}_{\varepsilon}(x)},
f|_{\bar{B}_{\varepsilon}(x)},x)\simeq 
\tilde{H}^{\bullet-1}(S_{\varepsilon}^{n-1}(x)
\cap \{f<f(x)\};A).
\end{align}

By Alexander duality, 
$H^{\bullet}(S_{\varepsilon}^{n-1}(x)\setminus \{f=f(x)\};A)$ 
is bounded and finitely generated, so 
is $\opn{LMD}^{\bullet}(A_{\bar{B}_{\varepsilon}(x)},
f|_{\bar{B}_{\varepsilon}(x)},x)$.

We also add explanation of real Milnor fiber from
\cite[3.2]{MR3779558}. Every isolated critical point 
of real analytic function is nondepraved 
\cite[Part I.2.4]{MR932724}.
If $f$ is a real analytic, then 
$S_{\varepsilon}^{n-1}(x)\cap \{f\leq f(x)\}\simeq 
f^{-1}(-\delta)\cap \bar{B}_{\varepsilon}(x)$
for sufficiently small $\vep>\delta>0$.
$f^{-1}(-\delta)\cap \bar{B}_{\varepsilon}(x)$ is called 
the (negative) \emph{real Milnor fiber}.
By Khimshiashvili [Him\v{s}ia\v{s}vili] formula \cite{MR0458467}, we have
\begin{align} \label{equation-Khimshiashvili}
  \opn{ind}_x^{A}(f)
=1-\chi(f^{-1}(-\delta)\cap \bar{B}_{\varepsilon}(x))
=\opn{ind}^{\opn{PH}}_{x}(\opn{grad}(f)).
\end{align}

\end{example}

\begin{remark}[{A vanishing properties
for some cone}]
Fix $X\deq \mathbb{R}^{n}$.
Let $f\colon X\to {\mathbb{R}}$ be a convex $C^{1}$-
function $X$ with the minimum point $x$
and $S$ be a cone in $X$, i.e., 
$rS=S$ for all $r\in \mathbb{R}_{> 0}$.
One of trivial but remarkable point is that
\begin{align}
|\opn{ind}_x(f|_S,0)|\neq |\opn{ind}_x(-f|_S,0)|
\end{align}
except for special cases such like
\cref{example-poincare-hopf}.
From \cref{example-local-cohomology},
\cref{prop-local-morse-data} and
\cref{example-fundamental-system}, we have
\begin{align}
\opn{LMD}^{\bullet}(A_S,-f|_S,0)=
\tilde{H}^{\bullet-1}(S\setminus \{x\};A_{S}).
\end{align}



If $S$ is a purely $n$-dimensional Bergman fan, then 
$\opn{LMD}^{\bullet}(A_S,-f|_S,x)\simeq 
H^{n-1}(S\setminus\{x\};A)[-n]$ since every Bergman fan has a good subdivision 
\cite[Theorem 1]{MR2185977} and its link is shellable
(e.g. \cite[7.9.1. Theorem]{MR1165544}).
The vanishing property of the local cohomology is conjectured for
tropicalization of very affine algebraic variety by Hacking in
\cite{MR2452307}.

Hacking also proved that conjecture is true for a suitable condition
\cite[Theorem 2.5]{MR2452307}.
Since any tropical varieties is connected
through codimension $1$ \cite[Theorem 3.3.5]{MR3287221},
this conjecture is true when $\dim S \leq 2$.
This phenomenon gives a certain analog of Kodaira vanishing theorem for 
positive line bundles, see 
also \cref{example-tropical-kodaira-vanishing}. 
A certain shellability for tropical fans is studied in
\cite{amini2021homology}.
\end{remark}

\subsection{Smooth Cartier divisors on rational 
polyhedral spaces}



We recall about line bundles on 
rational polyhedral spaces and discuss the notion of
\emph{$C^{\infty}$-Cartier divisor}
for boundaryless rational polyhedral spaces.
We mainly follow 
from \cite{MR3903579,gross2019sheaftheoretic}.

%TODO: 引用の整理

Let $S$ be a rational polyhedral space
\cite[Definition 2.2]{gross2019sheaftheoretic}, 
$\mathcal{O}^{\times}_S$ the sheaf of 
locally integral affine linear function on $S$
and $\mathcal{A}^{0,0}_S$ the sheaf of 
$(0,0)$-superforms on $S$ 
\cite[Definition 2.24]{MR3903579}. 

\begin{remark}
In \cite{MR3903579},the sheaf of superforms 
defined for polyhedral spaces with 
face structures \cite[Definition 2.4.(c)]{gross2019sheaftheoretic}.
We can also define the sheaf of $(0,0)$-superforms for 
rational polyhedral spaces as the same way,
at least.
\end{remark}

In various scenes, we assume rational polyhedral spaces
satisfies the following \emph{boundaryless condition}:

\begin{condition}[{\cite[\textsection 4.2]{MR4246795}}]
\label{condition-Rn}
Let $S$ be a rational polyhedral space  
a coordinate system $\{(U_i,\phi_i)\}_{i\in I}$
such that the image of each chart 
$\phi_i\colon U_i \to \mathbb{T}^{n}$
is in $\mathbb{R}^{n}$.
\end{condition}

The \cref{condition-Rn} is strict for rational polyhedral
spaces, but it is enough to
give a test play for our approaches.

As like tropical line bundles on tropical curves
\cite[Definition 4.4]{mikhalkinTropicalCurvesTheir2008a},
there exists the notion of tropical line bundle on 
rational polyhedral space
\cite[Definition 3.12]{gross2019sheaftheoretic}.
Every isomorphism class of 
tropical line bundles on $S$ is parametrized by 
$H^{1}(S;\mathcal{O}^{\times}_S)$
\cite[Proposition 3.13]{gross2019sheaftheoretic}.
The group $H^{1}(S;\mcal{O}^{\times}_S))$ is called 
the \emph{Picard group} of $S$.
There exists the following exact sequence:
\begin{align}
\label{equation-smoooth-cartier-divisor-sequence}
0\to \mathcal{O}^{\times}_S \to
\mathcal{A}^{0,0}_{S} \to
\mathcal{A}^{0,0}_{S}/\mathcal{O}^{\times}_S\to 0.
\end{align}

This is a smooth version of the following exact
sequences associated with the sheaf 
$\mcal{M}_S^{\times}$
of (real valued) \emph{tropical rational functions}
\cite[Definition 4.1]{MR3894860}:
\begin{align}
\label{equation-cartier-divisor-sequence}
0 \to \mcal{O}^{\times}_S \to \mcal{M}_S^{\times} 
\to \mcal{M}_S^{\times}/\mathcal{O}^{\times}_S\to 0.
\end{align}
There are several different definitions of  
tropical rational function 
(for example, see \cite{mikhalkin2018tropical}).
By taking a global section of the
short exact sequence 
(\ref{equation-cartier-divisor-sequence}),
there exists a connecting homomorphism 
$\delta \colon 
H^{0}(S;\mcal{M}_S^{\times}/\mathcal{O}^{\times}_S)
\to H^{1}(S;\mathcal{O}^{\times}_S)$.
We note $H^{1}(S;\mcal{M}_{S}^{\times})=0$, 
and thus $\delta$ is surjective
\cite[Lemma 4.5, Proposition 4.6]{MR3894860}.
The element $H^{0}(S;\mcal{M}_S^{\times}/\mathcal{O}^{\times}_S)$
is called a \emph{Cartier divisor} on $S$.
Therefore, for every line bundle $\mathcal{L}$ on a rational polyhedral 
space, there exists a Cartier divisor $D$ 
which represents $\mathcal{L}$.

By taking a global section of the
short exact sequence
(\ref{equation-smoooth-cartier-divisor-sequence}),
there also exists a connecting homomorphism 
$\delta' \colon 
H^{0}(S;\mathcal{A}^{0,0}_{S}/\mathcal{O}^{\times}_S)
\to H^{1}(S;\mathcal{O}^{\times}_S)$. 
$\mathcal{A}^{0,0}_S$ is a fine sheaf 
\cite[Lemma 2.7, Proposition 2.26]{MR3903579}, so 
$H^{1}(S;\mathcal{A}^{0,0}_S)=0$ and 
so $\delta'$ is also surjective.

\begin{definition}
Let $S$ be a boundaryless rational polyhedral space.
A \emph{$C^{\infty}$-Cartier divisor} on 
$S$ is an element of
$H^{0}(S;\mathcal{A}^{0,0}_{S}/\mathcal{O}^{\times}_S)$.
Let 
$(\cdot)^{\mathrm{sm}}\colon 
H^{0}(S;\mathcal{A}^{0,0}_S)\to 
H^{0}(S;\mathcal{A}^{0,0}_{S}/\mathcal{O}^{\times}_S)$ 
be a morphism defined from 
(\ref{equation-smoooth-cartier-divisor-sequence}).
The \emph{principal $C^{\infty}$-Cartier divisor} of a $(0,0)$-superform 
$f$ is the image $(f)^{\mathrm{sm}}$ of $f$.
\end{definition}
We write $\opn{CDiv}^{\infty}(S)$ for 
$H^{0}(S;\mathcal{A}^{0,0}_{S}/\mathcal{O}^{\times}_S)$
when $S$ is a boundaryless rational polyhedral space.
We will define $\opn{CDiv}^{\infty}(S)$
for general rational polyhedral space $S$ by replacing 
the sheaf $\mathcal{A}^{0,0}_{S}$ with the sheaf 
$\mathcal{A}^{\mathrm{weak}}_S$ of weakly-smooth 
functions on $S$.
It's difficult to explain the reason why we need 
$\mathcal{A}^{\mathrm{weak}}_S$ now, 
so this explanation is done in 
\cref{section-tropical-curve-general}.
We will see a $C^{\infty}$-Cartier divisor is
an analog of Lagrangian section 
(\cref{proposition-cartier-lagrangian}).

We also use the following representation of 
$C^{\infty}$-Cartier divisor like 
\cite[Definition 4.0.12]{MR2810322}.
\begin{definition}[{$C^{\infty}$-Cartier local data}]
\label{definition-Cartier-local-data}
Let $s\in \opn{CDiv}^{\infty}(S)$, 
$\{U_i\}_{i\in I}$ an open cover of $S$ and 
$f_i\colon U_i \to \mathbb{R}$ a $(0,0)$-superform
on $U_i$. The set 
$\{(U_i,f_i)\}_{i\in I}$ is 
a \emph{local data} for $s$ if 
$s|_{U_i}=(f_i)^{\mathrm{sm}}$ for all 
$i\in I$. 
\end{definition}


In the next subsection, 
we will define an analog of Floer complex of 
Lagrangian submanifolds
(without differential) for $C^{\infty}$-Cartier 
divisors on boundaryless rational polyhedral spaces
satisfying \cref{condition-good-divisor}.





\subsection{Permissible conditions}

In this subsection, we define 
the \emph{permissibility condition} for
$C^{\infty}$-Cartier divisors on rational 
polyhedral spaces.
We will define an analog of a Morse complex
without differential for permissible divisors 
later.

Fix a polyhedral set $S$ 
in $\mathbb{R}^{n}$.
Let 
$\mathcal{F}^{1}_{\mathbb{Z},S}
\deq \mathcal{O}^{\times}_S/\mathbb{R}_{S}$
,
$\mathcal{F}^{1}_{S}\deq 
\mathcal{F}^{1}_{\mathbb{Z},S}
\otimes_{\mathbb{Z}_S} \mathbb{R}_S$ 
and $T_x S\deq \opn{Hom}_{\mathbb{Z}}(
(\mathcal{F}^{1}_{\mathbb{Z},S})_x,\mathbb{R})$.
From definition of polyhedral set, 
we can see 
the stalk $(\mathcal{F}^{1}_{\mathbb{Z},S})_x$
at $x$ is a free 
$\mathbb{Z}$-module of finite rank.

In order to define the permissible condition,
we define the subset $\opn{SS}(S)_x$ of cotangent
space $(\mathcal{F}^{1}_{S})_x$ at $x\in S$ for 
a boudaryless rational polyhedral
space $S$.


%TODO: きちんとかく
Let $S$ be a rational polyhedral space, 
$x\in S$ and $\opn{LC}_x S$ the 
local cone of $S$ at $x$ 
\cite[2.2]{gross2019sheaftheoretic}.
This is a subset of the tangent vector space
$T_{x}S$ at $x$ which spans of $T_{x}S$
\cite[Corollary 2.6]{gross2019sheaftheoretic}.
Then, there exists an open neighborhood 
$V$ of $0$ in $\opn{LC}_x S$ and
a canonical morphism $\phi \colon V\to S$ 
such that $\phi(0)=x$ and
$d_{0}\phi\colon T_0(\opn{LC}_xS) \simto T_x S$
\cite[Proposition 2.5]{gross2019sheaftheoretic}.
The $d_0 \phi$ does not depend on the choice of 
$V$. 
We frequently identify $T_0(\opn{LC}_x S)$ with 
$T_x S$ for simplicity.
\begin{definition}
For the above notation, we set
\begin{align}
\opn{SS}(S)_x\deq 
d_0\phi(\opn{SS}((\mathbb{Z}_{T_x S})_{\opn{LC}_x S})_0).
\end{align}

\end{definition}



In general, $\opn{SS}(S)_x$  
is complicated, but this is related with the 
follwoing vector 
spaces:

\begin{definition}[{Lineality subspace 
\cite[\textsection 2.1]{MR4246795}}]
Let $Z$ be a subset of
$\mathbb{R}^{n}$. A \emph{lineality subspace} of $Z$ is 
a linear subspace $V$ of
$\mathbb{R}^{n}$ such that $x+s\in Z$ for all 
$s\in Z$ and $x\in V$, i.e.,
\begin{align}
Z+V=Z.
\end{align}
where $Z+V$ is the Minkowski sum of $Z$ and $V$.
\end{definition}
If $0\in Z$, then 
every lineality subspace of $Z$ is a subset of $Z$.
If $V$ and $W$ are a lineality subspace of $Z$, 
then the Minskowski sum $V+W$ is 
also a lineality space.
We write $\opn{lineal}(Z)$ for the maximal lineality 
subspace of $Z$. If $P$ is a polyhedron in 
$\mathbb{R}^{n}$, $\opn{lineal}(P)$ is the lineality space
in the sense of \cite[p.60]{MR3287221}, see also 
\cite[\textsection 5]{MR3041763}.


\begin{proposition}
\label{condition-good-linearity-space}
Let $S$ be a boundaryless rational polyhedral space 
and $x\in S$. Then,
\begin{align} \label{equation-W-SS-Lin}
(\mathcal{W}_{1,S}^{\mathbb{R}})_{x}^{\bot}\subset 
\opn{span}_{{\mathbb{R}}}\opn{SS}(S)_x\subset
\opn{lineal}(\opn{LC}_xS)^{\bot}
\end{align}
where $(V)^{\bot}$ the orthogonal complement of 
$V$ for the standard pairing of dual vector spaces
and $\mathcal{W}_{1,S}^{\mathbb{R}}=
\mathcal{H}om(\mathcal{F}^{1}_{\mathbb{Z},S};\mathbb{R}_S)$ is 
the sheaf of (real) wave tangent 
vector spaces of $S$ at $x$. (See \cite[1.3]{mikhalkinTropicalEigenwaveIntermediate2014a} and 
\cite[Definition 2.16, Proposition 2.20, Remark 2.21]{yamamotoTropicalContractionsIntegral2021}).
\end{proposition}
\begin{proof}
Since
$\opn{LC}_x S\simeq 
\opn{lineal}(\opn{LC}_x S)\times 
(\opn{LC}_x S/\opn{lineal}(\opn{LC}_x S))$
and 
\cite[Proposition 5.4.1]{MR1299726}, we have
\begin{align} 
\opn{SS}(\opn{LC}_x S)_0\simeq \{0\}\times 
\opn{SS}(\opn{LC}_x S/\opn{lineal}(\opn{LC}_x S))_0
\subset \opn{lineal}(\opn{LC}_xS)^{\bot}.
\end{align}

Next, we prove the following inclusion:
\begin{align}
(\mathcal{W}_{1,S}^{\mathbb{R}})_{x}^{\bot}=(\bigcap_{y \in (\opn{LC}_xS)_{\opn{reg}}} 
\opn{span}_{\mathbb{R}} U_y)^{\bot}=
\sum_{y \in (\opn{LC}_xS)_{\opn{reg}}} 
(\opn{span}_{\mathbb{R}} U_y)^{\bot} \subset 
\opn{span}_{\mathbb{R}}\opn{SS}(\opn{LC}_x S)_0.
\end{align}
where $U_y$ is the intersection 
$(\opn{LC}_xS)_{\opn{reg}}$ with a sufficiently 
small open ball $V_y$ of $y$ in $T_0(\opn{LC}_xS)$.
If the diameter of $V_y$ is sufficiently small, 
then $\opn{span}_{\mathbb{R}} U_y$ is independent of 
the choice of $V_y$. 
Let $h\in (\opn{span}_{\mathbb{R}} U_y)^{\bot}$ and 
$\rho_{V_y}\colon T_0 (\opn{LC}_x S)\to \mathbb{R}$
be a smooth function such that 
$\{z \in T_0 (\opn{LC}_x S) \mid \rho_{V_y}(z)<0\}=V_y$.
Since $h(z)=0$ for $z\in U_y$, we have
\begin{align}
\chi(\{z\in \opn{LC}_x S\mid h(z)+\rho_{V_y}(z)<0\})
-\chi(\{z\in \opn{LC}_x S\mid h(z)<0\})=1.
\end{align}
Therefore, $h+\rho_{V_y}$ or $h$ induces 
$h\in \opn{SS}(\opn{LC}_x S)_0$.
\end{proof}

\begin{remark}
In many cases, the three vector space in 
\cref{equation-W-SS-Lin} is equal.
For instance, if $S$ is a tropical curve 
or integral affine manifold, 
then $S$ satisfies this condition.
Let $S$ be the tropical hypersurface of
$f=\max\{x_1,\ldots,x_n,1\}$ in $\mathbb{R}^{n}$. 
We can see
$((\mathcal{W}_{1,S}^{\mathbb{R}})_{x})^{\bot}=\opn{span}_{{\mathbb{R}}}(\opn{SS}(S)_x)=\mathcal{F}_{S,x}^{1}$
when $x\deq (0,\ldots,0)$. 
Of course, the other points in $S$ satisfies 
that the three vector space in 
\cref{equation-W-SS-Lin} is equal. If 
$S=\mathbb{R}_{\geq 0}$, then 
$((\mathcal{W}_{1,S}^{\mathbb{R}})_{0})^{\bot}=\{0\}$ and
$\opn{span}_{\mathbb{R}}(\opn{SS}(S)_x)=
(\opn{lineal}(\opn{LC}_x S))^{\bot}=\mathbb{R}$. 
We expect the middle and right vector space in 
\cref{equation-W-SS-Lin} is equal for various 
important cases.
\end{remark}

From now on, we define the permissiblity condition 
for $C^{\infty}$-Cartier divisors on boundaryless
rational polyhedral spaces.
From definition of superforms on 
polyhedral spaces 
\cite[Definition 2.10, 2.24]{MR3903579}, we 
can define the set of \emph{critical points} 
of $(0,0)$-superform on boundaryless
rational polyhedral space
like that of $C^{\infty}$-function on differential
manifolds.
Let $f\colon S \to \mathbb{R}$ be a $(0,0)$-superform on 
a boundaryless rational polyhedral space $S$. 
The differential $d''f\in \mathcal{A}^{0,1}_S$ of $f$ has the 
differential vector $df (x)\in (\mathcal{F}_{S}^{1})_x$ for any 
$x\in S$ from the definition of $(0,0)$-superforms
and properties of the local 
cone \cite[Corollary 2.6]{gross2019sheaftheoretic}.
In general, we can define the 
differential of $f$ at $x$ by the pullback of 
the germ of morphisms 
$(\opn{LC}_x S,0)\to (S,x)$, and we will use 
in \cref{definition-permissible-weakly-smooth}.


\begin{condition}[{permissiblity}] \label{cond: permissible}
Let $S$ be a boundaryless rational polyhedral space.
A $(0,0)$-superform $f\colon S \to {\mathbb{R}}$ is \emph{permissible} at $x$ 
if 
\begin{align}
df(x)\notin (\opn{span}_{{\mathbb{R}}}
\opn{SS}(S)_x+\mathcal{F}_{\mathbb{Z},S,x}^{1})
\setminus \mathcal{F}_{\mathbb{Z},S,x}^{1}.
\end{align}
\end{condition}

From definition, if $f$ is permissible at $x$ then
$f|_{U_x}+m$ is also permissible at $x$ for any 
$m\in \mathcal{O}_{S}^{\times}(U_x)$.
Therefore, we can define the permissibility condition
for principal divisors directly.
\begin{remark}
Suppose $\opn{span}_{\mathbb{R}}(\opn{SS}(S)_x)=(\mathcal{F}_{S}^{1})_x$. 
Then, $f$ is permissible if and only if 
$d''f(x)\in (\mathcal{F}_{\mathbb{Z},S}^{1})_x$.
Therefore, permissibility
condition may be not a generic condition.
If $\dim_{\mathbb{R}} \opn{span}_{{\mathbb{R}}}
(\opn{SS}(S)_x)<\dim_{\mathbb{R}} \mathcal{F}_{S,x}^{1}$, the 
set of permissible cotangent vector at $x$ is dense and 
connected.
\end{remark}


\begin{definition}[{permissible $C^{\infty}$-Cartier divisor}]
\label{definition-permissible-smooth-cartier-divisor}
A $C^{\infty}$-Cartier divisor $s$ is \emph{permissible} 
if there exists a local data $\{(U_i,f_i)\}_{i\in I}$ 
for $s$
such that $f_i$ is permissible for all $i\in I$. 
In general, a pair $(s',s)$ of smooth 
Cartier divisors $s,s'$ is 
\emph{permissible} if $s-s'$ is 
permissible. 
\end{definition}

Let $s_0$ be the zero $C^{\infty}$-Cartier data on $S$. 
Then, a pair $(s_0,s)$ of $C^{\infty}$-Cartier divisors 
is permissible if and only if $s$ is permissible.
If a $C^{\infty}$-Cartier divisor is permissible, 
then every local data satisfies the above 
permissibility condition.

\begin{definition}
\label{definition-divisor-intersection}
Let $(s,s')$ be a permissible pair of 
$C^{\infty}$-Cartier divisors and 
$\{(U_i,f_i)\}_{i\in I}$ a local $C^{\infty}$-Cartier data
for $s-s'$. The intersection set of the pair 
$(s,s')$ is the following set
\begin{align}
s'\cap s\deq \set{x\in S \mid  df_i(x)\in 
\mathcal{F}^{1}_{\mathbb{Z},S,x} 
\text{ for some } i\in I}.
\end{align}
\end{definition}

The set $s'\cap s$ is independent of the choice of 
a local data for $s-s'$. 

\subsection{Stratified torus fibration}
\label{section-stratified-torus-fibration}
We will explain the set $s'\cap s$ is the 
intersection of two `Lagrangian sections' of
stratified torus fibration in this subsection.
We can skip this subsection for following 
our main theorem.

Let $S$ be a rational polyhedral space satisfying
\cref{condition-Rn}.
We can define a naive analog of Lagrangian torus 
fibration 
$\bigcup_{x\in S}(\mathcal{F}^{1}_{S})_x/
(\mathcal{F}^{1}_{\mathbb{Z},S})_x \to S$
for $S$ (as a set). Instead of this fibration, 
we define (the underlying set of) 
another torus fibration as follows. 
\begin{definition}[{Stratified torus fibration}]
Let $S$ be a compact rational polyhedral space.
Let $\check{X}(S)_x$ be 
the real torus defined as follows:
\begin{align}
\check{X}_0(S)_x\deq  
(\mathcal{F}_{\mathbb{Z},S,x}^{1}/\opn{span}_{{\mathbb{R}}}
(\opn{SS}(S)_x)\cap \mathcal{F}_{\mathbb{Z},S,x}^{1})\otimes_{\Z} {\mathbb{R}}/\Z.
\end{align}
We call the union $\check{X}_0(S)\deq \bigcup_{x\in S}
\check{X}_0(S)_x$
the underlying set of the \emph{stratified torus 
fibration} of $S$.
\end{definition}
We won't pursue about
topological structures of $\check{X}_0(S)$ 
here.

\begin{example}
{\setlength{\leftmargini}{22pt}
\begin{enumerate}
\item If $B$ is an integral affine manifold, then
$\check{X}_0(B)$ is equal to $\check{X}(B)$ as a set.
\item 
Let $C$ be a compact trivalent tropical curve.
The stratified torus fibration $\check{X}_0(C)$ is equal to 
the stratified space associated
with a trivalent metric graph defined in \cite{auroux2022lagrangian}
as a set.
\end{enumerate}
}
\end{example}

Let $\check{f}_S\colon \check{X}_0(S)\to S$ be the 
canonical projection of stratified torus fibration of $S$.

We recall the following elementary proposition 
in order to define `Lagrangian section' for $\check{f}_S$.

\begin{proposition}

Let $M$ (resp. $N$) be a $\mathbb{Z}$-module and
$i\colon M'\to M$ (resp. $j\colon N'\to N$) be the 
inclusion map of submodules, and 
$\opn{pr}\colon M\otimes_{\mathbb{Z}}N \to M/M'\otimes_{\mathbb{Z}} N/N'$
is the canonical projection map induced from the following
commutative diagram:
\begin{equation}
% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRAFkAdTiPAW3gB9YNz50cACwBGU4AC0AvgoByIBaXSZc+QigCM5KrUYs27APTsA5N15YBcYaPHTZilWo0gM2PASIGekb0zKyIHJY2PPxCIpxikjLySsrmylaemr46RGRB1CGm4VzR9rHOiW4paRkKRjBQAObwRKAAZgBOEHxIZCA4EEgAzOrtXT2IQ9QDSABMoyCd3UgG-YOI815LE30ziHp1CkA
\begin{tikzcd}
M\otimes_{\mathbb{Z}}N \arrow[d] \arrow[r] & M/M'\otimes_{\mathbb{Z}}N \arrow[d] \\
M\otimes_{\mathbb{Z}}N/N' \arrow[r]        & M/M'\otimes_{\mathbb{Z}}N/N'.       
\end{tikzcd}
\end{equation}
Then, 
\begin{align}
\opn{pr}^{-1}(0)=\opn{Im}(i\otimes_{\mathbb{Z}}\opn{id}_N)+
\opn{Im}(\opn{id}_M\otimes_{\mathbb{Z}}j).
\end{align}
\end{proposition}

From the above proposition,
the canonical projection
$\opn{pr}_{S,x}\colon (\mathcal{F}_{S}^{1})_x\simeq 
(\mathcal{F}_{\mathbb{Z},S}^{1})_x\otimes_{\mathbb{Z}}\mathbb{R}
\to \check{X}_0(S)_x$ satisfies 
\begin{align}
\label{equation-torus-fiber}
\opn{pr}_{S,x}^{-1}(0)
=\opn{span}_{\mathbb{R}}(\opn{SS}(S)_x)+
(\mathcal{F}^{1}_{\mathbb{Z},S})_x
\end{align}
for all $x\in S$.

\begin{definition}
Let $s$ be a $C^{\infty}$-Cartier divisor 
on a boundaryless rational polyhedral space $S$ 
and $\{(U_i,f_i)\}_{i\in I}$ a local data for $s$. 
The \emph{stratified Lagrangian section} associated with $s$ is the following
section of $\check{f}_S$:
\begin{align}
\check{s}\colon S \to \check{X}_0(S); x \mapsto \opn{pr}_{S,x} (df_i(x)).
\end{align}
\end{definition}

The $\check{s}$ is independent of the choice of local
$C^{\infty}$-Cartier data for $s$ since 
$(\mathcal{F}^{1}_{S})_x/(\mathcal{F}^{1}_{\mathbb{Z},S})_x$
is naturally isomorphic to
$(\mathcal{F}^{1}_{\mathbb{Z},S})_x
\otimes_{\mathbb{Z}}\mathbb{R}/\mathbb{Z}$.
 

From the permissibility condition and
\cref{equation-torus-fiber}, we get the following proposition.

\begin{proposition}
Let $(s',s)$ be a permissible $C^{\infty}$-Cartier pair
on a boundaryless rational polyhedral space, 
$\{(U_i,f_i)\}_{i\in I}$ the local data 
for $s-s'$ and $L_s\deq \opn{Im}(\check{s})$.
Then,
\begin{align}
\check{f}_S(L_{s'}\cap L_s)=s'\cap s.
\end{align}

\end{proposition}






 
\subsection{Cohomological local Morse data for permissible divisors}

In this subsection, we
define the graded module of a given permissible pair 
$(s',s)$ of $C^{\infty}$-Cartier divisors such that 
$\sharp (s'\cap s)<\infty$.
In order to define the graded module
$\opn{LMD}^{\bullet}(s',s)$, we define the 
intersection data of 
the permissible pair $(s',s)$.

\begin{definition}[{intersection data}]
Fix a bounaryless 
rational polyhedral space $S$.
Let $s$ be an permissible $C^{\infty}$-Cartier divisor 
on $S$ such that $\sharp (s\cap s_0)<\infty$. 
An \emph{intersection data} for $s$ is the set 
$\{(U_p,f_p)\}_{p\in s\cap s_0}$ of pairs of open subsets
$U_i$ of $S$ and (0,0)-superforms
$f_p\colon U_p \to \mathbb{R}$ indexed by 
$ s_0\cap s$ 
such that
\begin{enumerate}
\item $s|_{U_p}=(f_p)^{\mathrm{sm}}$
for all $p\in s_0\cap s$,
\item $\opn{Crit}(f_p)=\{p\}$ for all $p\in s_0\cap s$,
\item $f_p(p)=0$ for all $p\in s_0\cap s$.
\end{enumerate}
An intersection data for a permissible pair 
$(s',s)$ of $C^{\infty}$-Cartier divisors is 
an intersection data for $s-s'$.
\end{definition}

\begin{definition}[{Cohomological local Morse data for 
$C^{\infty}$-Cartier divisors}]
\label{definition-local-morse-data-divisor}
Let $S$ be a (boudaryless) rational polyhedral space 
and $s$ be a permissible 
$C^{\infty}$-Cartier divisor such that
$s'\cap s$ is finite and 
$\{(U_p,f_p)\}_{p\in s_0\cap s}$ 
be an intersection data for $s$.
We set
\begin{align}
\opn{LMD}^{\bullet}_{A}(s',s)\deq 
\bigoplus_{p\in s' \cap s} 
\opn{LMD}^{\bullet}(A_{U_p},f_{p},p), \quad 
\opn{LMD}^{\bullet}(s',s)
\deq \opn{LMD}^{\bullet}_{\mathbb{Z}}(s',s)\\
\opn{LMD}^{\bullet}_A(S;s)
\deq \opn{LMD}^{\bullet}_{A}(s_0,s), \quad
\opn{LMD}^{\bullet}(S;s)\deq
\opn{LMD}^{\bullet}_{\mathbb{Z}}(S;s).
\end{align}
\end{definition}

\begin{remark}
\label{remark-differential-graded-module}
We stress that we should not consider 
$\opn{LMD}^{\bullet}_{A}(S;s)$ as the cohomology of $s$,
but just
a graded module 
since we need to define the differentials 
$\mathfrak{m}_1$ of 
$\opn{LMD}^{\bullet}_{A}(S;s)$ as an analog of
Floer cohomology. We don't have, however,
the definition of the true differential of 
$\opn{LMD}^{\bullet}_A(S;s)$ in general, except when 
$A=\Lambda_{\mathrm{nov}}^{\mathbb{C}}$ and
$\opn{LMD}^{\bullet}_{A}(S;s)$ is equal to a Floer complex
of Lagrangian submanifolds (e.g. \cite[5.2]{MR1882331}).
\end{remark}

It is important that 
$\opn{LMD}^{\bullet}_{A}(S;s)\simeq \opn{LMD}^{\bullet}(A_{\coprod_{p} U_p},\coprod_p f_p)$ is
for a given intersection data for $s$, and thus
we can use topological tools for computations of 
$\opn{LMD}^{\bullet}_{A}(S;s)$.

\begin{example}
\label{example-tropical-kodaira-vanishing}
Let $S$ be a boundaryless rational polyhedral space, 
$s$ a $C^{\infty}$-Cartier divisor on $S$ 
and $\{(f_i,U_i)\}_{i\in I}$ the local data of $s$. 
$s$ is 
\emph{Bohr--Sommerfeld type},
\emph{strongly-positive}
or \emph{Hessian type} if every
$f_i$ is locally a resctriction of a strictly convex 
function on an open neighborhood of $T_0(\opn{LC}_x)S$ 
for any $i\in I$. 
This is a certain analog of positive form on
complex manifolds. In this case, 
\begin{align}
\opn{LMD}^{\bullet}_{A}(S;s)\simeq 
\bigoplus_{x\in s_0 \cap s} A[0], \quad
\opn{LMD}^{\bullet}_{A}(S;-s)\simeq 
\bigoplus_{x\in s_0\cap -s} 
H^{n}(S,S\setminus\{x\};A)[-n].
\end{align}
In this case, the `cohomology' of 
$\opn{LMD}^{\bullet}_{A}(S;s)$ is independent of the choice of 
differential of $\opn{LMD}^{\bullet}(S;s,A)$.
This is a tropical analog of Kodaira's vanishing theorem
for a (multiple of) positive line bundle
$\mathcal{L}$ on a complex manifold $M$: 
\begin{align}
H^{\bullet}(M;\mcal{L}^{-1})\simeq H^{n}(M;\mcal{L}^{-1})[-n].
\end{align}
The name of Bohr--Sommerfeld type comes from 
the set $s_0\cap s$ can be considered as the set of 
Bohr--Sommerfeld point if $S$ is a strictly integral affine manifold 
with a Hessian form by semi-flat SYZ mirror pair
(see \cref{sec: BSRR}).
The name of strongly-positive follows 
from \cite{MR2892935}.
\end{example}

The following is the `good' conditions for 
$C^{\infty}$-Cartier divisor 
$s$ to consider Riemann--Roch type theorems.

\begin{condition}
\label{condition-good-divisor}
$s$ is a permissible $C^{\infty}$-Cartier divisor on 
$S$ such that $s_0\cap s$ is finite and 
$\opn{LMD}^{\bullet}(S;s)$ is bounded and 
finitely generated.
\end{condition}

With this, all the preparations necessary 
to formulate \cref{conjecture-tropical-MRR-preface} 
have been completed when $S$ is boundaryless.

The following proposition is an analog of \'{e}tale multiplicity of Euler characteristics
(cf. \cite[Proposition 1.1.28]{MR2095471}).
Let's see \cref{definition-etale-covering} for 
the definition of tropical \`etale covering 
map in this paper.
\begin{proposition}
\label{proposition-euler-number-etale}
Let $S$ be a compact boundaryless rational polyhedral 
space and $s$ be an permissible 
$C^{\infty}$-Cartier divisor
satisfying \cref{condition-good-divisor}.
For a tropical \`etale covering 
map $q \colon S' \to S$ of 
(topological) degree 
$\opn{deg}_{\opn{top}}(q)$,
\begin{align}
\chi(\opn{LMD}^{\bullet}(S';q^{*}(s)))=
\opn{deg}_{\opn{top}}(q)\chi(\opn{LMD}^{\bullet}(S;s)).
\end{align}
\end{proposition}

The proof of \cref{proposition-euler-number-etale} is trivial from definition.
Besides, we can apply Meyer--Vietoris exact sequence 
for $\opn{LMD}^{\bullet}(S;s)$ under a suitable condition.
We will use this feature for tropical curves
(\cref{proposition-gluing-formula}).



\begin{remark}
Obviously, $\opn{LMD}^{\bullet}(S;s)$ is not usually 
finitely generated and this is not invariant 
for linearly equivalent $C^{\infty}$-Cartier divisors
if $S$ is not compact.
This corresponds that Morse homology does not work directly
for non-compact manifolds such 
like for compact manifolds.
Besides, $\chi(\opn{LMD}^{\bullet}(S;s))$ is \emph{not}
an invariant for line bundles for general compact rational 
polyhedral spaces. See also 
\cref{remark-rotation-closed-interval}.  
\end{remark}

\subsection{$C^{\infty}$-Cartier divisors 
for general rational polyhedral spaces}
\label{section-weakly-smooth-functions}
In this section, we will define $C^{\infty}$-Cartier divisors 
for general rational polyhedral spaces 
and finish preparations necessary to formulate
\cref{conjecture-tropical-MRR-preface} for any 
compact tropical manifolds.
We recall \cref{condition-good-divisor}
and the definition of $(0,0)$-superforms
on tropical affine space $\underline{\mathbb{R}}^{n}$
\cite[Definition 2.4]{MR3903579}.
As explained in \cite[Example 2.6]{MR3903579},
every $(0,0)$-superform on $\underline{\mathbb{R}}$ 
 is constant at $-\infty$.
For instance, 
$f\colon \underline{\mathbb{R}} \to \mathbb{R}; x\mapsto 
\opn{log}(1+e^{x})$ is not a $(0,0)$-superform
on $\underline{\mathbb{R}}$.
This is constrast with \cref{condition-good-divisor}.
In order to covercome the weak point, we define 
the sheaf $\mathcal{A}^{\mathrm{weak}}_S$ of 
weakly-smooth functions for rational polyhedral 
sapces $S$.

\begin{definition} \label{definition-weakly-smooth}
Let $\opn{exp}\colon \underline{\mathbb{R}}^{l}\to 
\mathbb{R}_{\geq 0}^{l}$ be the coordinate-wise 
exponential map of 
$\underline{\mathbb{R}}^{l}$ and $\Omega$
an open subset of a rational polyhedral subset 
in $\underline{\mathbb{R}}^{l}$.
A continuous function $f_0\colon \Omega\to \mathbb{R}$
is a \emph{primitively weakly-smooth} if 
$f_0=\opn{log}\circ h\circ \opn{exp}$ for some 
smooth function $h\colon V\to \mathbb{R}_{>0}$ on 
an open subset $W$ of $\mathbb{R}^{l} 
(\supset \mathbb{R}_{\geq 0}^{l})$:
% https://q.uiver.app/#q=WzAsNCxbMSwwLCJcXG1hdGhiYntSfV97PiAwfSJdLFsxLDEsIlxcbWF0aGJie1J9Il0sWzAsMSwiVSJdLFswLDAsIlYiXSxbMCwxLCJcXGxvZyJdLFsyLDEsImYiLDJdLFszLDAsImgiXSxbMiwzLCJcXG9wZXJhdG9ybmFtZXtleHB9Il1d
\[\begin{tikzcd}
	W & {\mathbb{R}_{> 0}} \\
	\Omega & {\mathbb{R}}
	\arrow["\log", from=1-2, to=2-2]
	\arrow["f_0"', from=2-1, to=2-2]
	\arrow["h", from=1-1, to=1-2]
	\arrow["{\operatorname{exp}}", from=2-1, to=1-1].
\end{tikzcd}\]
Let $f$ be a continuous function on a rational polyhedral 
space $S$ and $x\in S$ such that 
there exists a chart 
$\psi\colon U \simto \Omega$ satisfying $f=f_0 \circ \psi$.
The data $(x,U,\psi,W,h)$ is 
called a \emph{primitive data} of $f$ at $x$.
\end{definition}

\begin{example}
Let 
$g\in \mathbb{R}_{\geq 0}[x_1,\ldots,x_n]$ 
be a polynomial 
function with nonnegative coefficients such that $g(0)\ne 0$. 
Then, $f=\opn{log}\circ g \circ \opn{exp}$ is 
primitively weakly-smooth 
on $\underline{\mathbb{R}}^{n}$.
\end{example}










\begin{definition}
Let $f$ is a continuous function on a rational polyhedral 
space $S$.
The function $f$ is \emph{weakly-smooth} at $x$ if 
there exists a chart 
$\psi \colon U\simto \Omega (\subset \underline{\mathbb{R}}^{l})$ 
of $S$ and a primitively weakly-smooth 
function $f_0$ such that $x\in U$ and $f=f_0\circ \psi$.

\end{definition}


\begin{definition}
Let $S$ be a rational polyhedral space and 
$U$ an open subset of $S$:
\begin{align}
\label{equation-weakly-smooth-definition}
\mathcal{A}_S^{\mathrm{weak}}(U)
\deq \{ f\in C^0(U)\mid
f \text{ is weakly-smooth at } x 
\text{ for all } x\in U\}.
\end{align}
The sheaf $\mathcal{A}_S^{\mathrm{weak}}$ 
of weakly-smooth functions on $S$ is the sheaf defined from 
(\ref{equation-weakly-smooth-definition}). 
\end{definition}

\begin{proposition}
$\mathcal{A}_S^{\mathrm{weak}}$ is the sheaf of Abelian groups.
\end{proposition}

\begin{proof}
The condition is local, and thus $\mathcal{A}_S^{\mathrm{weak}}$ 
is a sheaf.
Fix an open subset $U$ of $S$, a point $x$ in $U$ 
and $f_1,f_2\in \mathcal{A}_S^{\mathrm{weak}}(U)$.
Each $f_i$ ($i=1,2$) has the primitive data
$(x,U_i,\psi_i,W_i,h)$ of
weakly-smooth function $f$ at $x$
respectively. We can assume $U_1=U_2$.
The charts 
$\psi_1\colon U_1 \to \Omega_1$ and 
$\psi_2\colon U_2\to \Omega_2$ induces
the diagonal morphism
$\psi\colon 
U_1\cap U_2\to \Omega_1\times \Omega_2; x\mapsto 
(\psi_1(x),\psi_2(x))$.
The $\psi$ is also a chart.
Let $\pi_1\colon W_1\times W_2\to W_1$ 
and $\pi_2\colon W_1\times W_2\to W_2$
the canonical projections.
Then, we get the following commutative diagram:  
% https://q.uiver.app/#q=WzAsNCxbMSwwLCJcXG1hdGhiYntSfV97PiAwfSJdLFsxLDEsIlxcbWF0aGJie1J9Il0sWzAsMSwiVVxcY2FwIFUnIl0sWzAsMCwiVlxcdGltZXMgViciXSxbMCwxLCJcXGxvZyJdLFsyLDEsImYiLDJdLFsyLDMsIlxcb3BlcmF0b3JuYW1le2V4cH0iXSxbMywwLCJcXHBpXzFeeyp9aCtcXHBpXzJeeyp9aCJdXQ==
\[\begin{tikzcd}
	{W_1\times W_2} & {\mathbb{R}_{> 0}} \\
	{\psi(U_1\cap U_2)} & {\mathbb{R}}
	\arrow["\log", from=1-2, to=2-2]
	\arrow["f_1+f_2"', from=2-1, to=2-2]
	\arrow["{\operatorname{exp}}", from=2-1, to=1-1]
	\arrow["{\pi_1^{*}h_1\cdot\pi_2^{*}h_2}", from=1-1, to=1-2]
\end{tikzcd}\]
The continuous map
$\pi_1^*h_1\cdot \pi_2^{*}h_2$ is also smooth
on $W_1\times W_2$.

Therefore, the data
$(x,U_1\cap U_2,\psi,W_1\times W_2,
\pi_1^*h_1\cdot \pi_2^{*}h_2)$ forms a primitive data
of $f_1+f_2$ at $x$. Hence, 
the $f_1+f_2$ is also weakly-smooth at $x$ for all
$x\in U$. 
\end{proof}

From definition of the sheaf of $(0,0)$-superforms, 
$\mathcal{A}_S^{(0,0)}=\mathcal{A}_S^{\mathrm{weak}}$
if $S$ is boundaryless.

There exists a canonical injective morphism 
$\mathcal{O}_S^{\times}\to \mathcal{A}_S^{\mathrm{weak}}$ 
since every 
affine map $x\mapsto \langle u,x \rangle+b$ 
with integer slope on $\mathbb{R}^{n}$
is equal to $\opn{log} \circ h\circ \opn{exp}$ for 
some Laurent monomial $h$ over the semifield 
$\mathbb{R}_{\geq 0}$ of nonnegative real numbers. 



\begin{definition}
A \emph{$C^{\infty}$-Cartier divisor} on 
a rational polyhedral space $S$ is an 
element of $H^{0}(S;\mathcal{A}_S^{\opn{weak}}/
\mathcal{O}^{\times}_S)$. 
A \emph{principal Cartier divisor} of $f$ is 
the value $(f)^{\mathrm{sm}}$ 
of the canoical morphism
$(\cdot)^{\mathrm{sm}}\colon 
H^{0}(S;\mathcal{A}_S^{\opn{weak}})\to 
H^{0}(S;\mathcal{A}_S^{\opn{weak}}/
\mathcal{O}^{\times}_S)$.
\end{definition}

We write 
$\opn{CDiv}^{\infty}(S)\deq 
H^{0}(S;\mathcal{A}_S^{\opn{weak}}/
\mathcal{O}^{\times}_S)$ for simplicity.
We can define a \emph{local data} for 
$s$ like when $S$ is boundaryless naturally, 
see \cref{definition-Cartier-local-data}.
We can extend the permissibility condition for
weakly-smooth functions and $C^{\infty}$-Cartier divisors on
general rational polyhedral spaces by the following lemma.  

\begin{lemma}
Let 
$(x,U,\psi_1,W_1,h_1)$ and $(x,U,\psi_2,W_2,h_2)$
be data of a weakly-smooth function $f$ at $x$.
Then, there exists an open subset $V_0$ of 
$T_x S$ and the following natural commutative diagram of 
morphisms:
% https://q.uiver.app/#q=WzAsOCxbMiwwLCJVXzAiXSxbMiwyLCJVXzEiXSxbMiwxLCJWXzAiXSxbMywxLCJcXG1hdGhiYntSfSJdLFsxLDIsIlVfMVxcY2FwIFEiXSxbMSwwLCJVXzBcXGNhcCBQIl0sWzEsMSwiXFxvcGVyYXRvcm5hbWV7TEN9X3hTIFxcY2FwIFZfMCJdLFswLDEsIlUiXSxbMiwwLCIiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6InRvcCJ9fX1dLFsyLDEsIiIsMix7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoiYm90dG9tIn19fV0sWzQsMSwiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiaG9vayIsInNpZGUiOiJ0b3AifX19XSxbNSwwLCIiLDIseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6InRvcCJ9fX1dLFs2LDUsIiIsMix7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV0sWzYsNCwiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiaG9vayIsInNpZGUiOiJib3R0b20ifX19XSxbNiwyLCIiLDEseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6InRvcCJ9fX1dLFswLDMsImZfMCJdLFsxLDMsImZfMSIsMl0sWzYsNywiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiaG9vayIsInNpZGUiOiJ0b3AifX19XSxbNyw0LCJcXHBzaV97MX0iLDJdLFs3LDUsIlxccHNpXzAiXV0=
\begin{equation}
\begin{tikzcd}
	& {\psi_1(U)} & {\opn{exp}^{-1}(W_1)} \\
	U & {V_0\cap\operatorname{LC}_xS} & {V_0} & {\mathbb{R}} \\
	& {\psi_2(U)} & {\opn{exp}^{-1}(W_2)}
	\arrow[hook, from=2-3, to=1-3]
	\arrow[hook', from=2-3, to=3-3]
	\arrow[hook, from=3-2, to=3-3]
	\arrow[hook, from=1-2, to=1-3]
	\arrow[hook, from=2-2, to=1-2]
	\arrow[hook', from=2-2, to=3-2]
	\arrow[hook, from=2-2, to=2-3]
	\arrow["{\opn{log}\circ h_1\circ \opn{exp}}", from=1-3, to=2-4]
	\arrow["{\opn{log}\circ h_2\circ \opn{exp}}"', from=3-3, to=2-4]
	\arrow[hook, from=2-2, to=2-1]
	\arrow["{\psi_{1}}"', from=2-1, to=3-2]
	\arrow["{\psi_0}", from=2-1, to=1-2].
\end{tikzcd}
\end{equation}
where $\phi \colon V_0\cap \opn{LC}_x S\hookto U$ is the 
canonical morphism induced from a morphism of germs 
in \cite[Proposition 2.5]{gross2019sheaftheoretic}.
In partiuclar, the pullback $\phi^{*}f$ of $f$ is also 
weakly-smooth at $x$.
\end{lemma}
Every local cone $\opn{LC}_x S$ is boundaryless, and thus
we can define the permissible condition for any 
weakly-smooth functions.
The \emph{differential vector} 
$df(x)\in \mathcal{F}^{1}_{S,x}$ at $x$
is that of $\phi^{*}f$ via the indentification 
$T_0(\opn{LC}_x S)=T_xS$.
\begin{definition}[{Permissibility condition}]
\label{definition-permissible-weakly-smooth}
Let $f$ be a weakly-smooth function on a rational polyhedral 
space $U$. The $f$ is \emph{permissible} at $x\in U$ if 
the pullback $\phi^{*}f$ is permissible at 
$0\in \opn{LC}_x U$.
The weakly-smooth function $f$ is permissible if 
$f$ is permissible at $x$ for all $x\in U$.
Let $s\in H^{0}(S;\mathcal{A}^{\mathrm{weak}}_S/
\mathcal{O}^{\times}_S)$ be a $C^{\infty}$-Cartier
divisor on a rational polyhedral space $S$.
The $s$ is \emph{permissible} if there exists 
a local data $\{(U_i,f_i)\}_{i\in I}$ for $s$
such that every $f_i$ is permissible.
\end{definition}

\begin{example}
Let $f\colon \underline{\mathbb{R}}\to \mathbb{R}$ be a 
weakly-smooth function. The local cone 
$\opn{LC}_{-\infty} \underline{\mathbb{R}}$ 
at $-\infty$ is trivial, 
and thus every $f$ is permissible.
\end{example}

As like the permissibiliry condition,
we can define a \emph{permissible pair} $(s',s)$
of $C^{\infty}$-Cartier divisors, the
set $s\cap s'$ of $(s',s)$ 
(\cref{definition-divisor-intersection}), 
an intersection data for $s$ 
\cref{definition-intersection-data}, 
and cohomological local Morse data of $s$
(\cref{definition-local-morse-data-divisor}).
With this, all the preparations necessary to 
formulate \cref{conjecture-tropical-MRR-preface}
have been completed for any compact 
tropical manifolds.
\section{Proof for compact tropical curves}
In this section, we prove \cref{theorem-MRR-curve-preface}. 
(See \cite[Definition 3.1]{mikhalkinTropicalCurvesTheir2008a} 
for the definition of tropical curves.)
Our proof is highly effected from 
\cite{knill2012graph,MR2676658,auroux2022lagrangian}.
Our proof idea comes from 
\cite{knill2012graph,MR2676658} at first.  
The current proof is a modified version after reading 
\cite{auroux2022lagrangian}.
We also mainly follow the notation used in 
\cite{auroux2022lagrangian}.
Some propositions which have already proved as a special case
of the previous section will appeear, but we write a short proof 
for simplicity.

\subsection{Proof for \cref{theorem-MRR-curve-preface}}

The goal of this subsection is to prove 
\cref{theorem-MRR-curve-preface}.

Let $\Gamma_{n}$ be the projectivization of 
a certein tropical module defined in 
\cite[2.2]{mikhalkinTropicalCurvesTheir2008a}.
Each $\Gamma_{n}$ has a embedding 
into $\mathbb{T}P^{n-1}\deq \mathbb{P}(\mathbb{T}^{n})$.
The $\mathbb{T}P^{n-1}$ has a canonical inclusion
$\iota_n\colon \mathbb{R}^{n-1}\to 
\mathbb{T}P^{n-1}$ 
of tropical algebraic torus.
There exists the following isomorphism as rational 
polyhedral spaces:
\begin{align}
\Gamma_{n}^{\circ}\deq \Gamma_{n}\cap \iota_n(\mathbb{R}^{n-1}) \simeq \mathbb{R}_{\geq 0}(1,0,\ldots,0)\cup \cdots
\cup {\mathbb{R}}_{\geq 0}(0,\ldots,0,1)\cup 
{\mathbb{R}}_{\geq 0}(-1,\ldots,-1).
\end{align}

If $C$ is a compact tropical curve with 
no $1$-valent vertex, then every point in $C$ has 
an open neighborhood which is isomorphic to 
a open subset of some $\Gamma_{n}^{\circ}$.
Besides, every compact tropical curve with 
no $1$-valent vertex $C$ has a canonical metric structure 
associated with lattice structure of the tangent 
vector space of $C$ 
\cite[Proposition 3.6]{mikhalkinTropicalCurvesTheir2008a}.


\begin{proposition}
\label{proposition-permissible-curve}
Let $|\Sigma|$ be the support of a pure $1$-dimensonal 
finite convex polyhedral fan $|\Sigma|$ such that
$\Sigma$ spans $\mathbb{R}^{n}$.
Let $f\colon |\Sigma|\to \mathbb{R}$ be a 
$(0,0)$-superform on $|\Sigma|$. Then, 
$f$ is permissible at $x=(0,\ldots,0)$ if and only if 
$df(x)\in (\mathcal{F}^{1}_{\mathbb{Z},|\Sigma|})_x\simeq (\mathbb{Z}^{n})^{\vee}$
or $\opn{lineal}(|\Sigma|,x)\simeq \mathbb{R}$.

\end{proposition}

\begin{proof}
Obviously, 
$\opn{dim}_{\mathbb{R}}\opn{lineal}(|\Sigma|,x)\leq 1$.
If $\opn{dim}_{\mathbb{R}}\opn{lineal}(|\Sigma |,x)=1$, 
then $|\Sigma | \simeq \mathbb{R}$. 
From now on, we assume $\dim_{\mathbb{R}}\opn{lineal}(|\Sigma|,x)=0$.
Fix a vector $v_{\sigma}$ for $\sigma\in \Sigma \setminus\{0\}$ 
such that $\opn{span}_{\mathbb{R}}(v_{\sigma})=\sigma$.
We can choose a basis $\{v_{\sigma_i}\}_{i=1,\ldots, n}$ 
from $\{v_{\sigma}\}_{\sigma \in \Sigma}$,
and a linear form
$h=\sum_{\sigma \in \Sigma \setminus\{0\}} a_\sigma v^{*}_\sigma$
such that $a_\sigma<0$ for any 
$\sigma \in \Sigma \setminus\{0\}$.
Then, the lower set $|\Sigma|\cap \{h< 0\}$ is disconnected
when $n\geq 2$. If $n=1$, $|\Sigma|\cap \{-h<0\}$ is 
empty.
Thus, 
$\opn{span}_{\mathbb{R}}(\opn{SS}((\mathbb{Z}_{X})_S)_x)
=\mathbb{R}^{n}$ where $X=\mathbb{R}^{n}$ and $S=|\Sigma|$.
\end{proof}



\begin{proposition}[{cf. \cite{knill2012graph}}]
\label{proposition-n-valent}
Let $s_{p,q}\colon |\Sigma|\to \mathbb{R}$ be 
an permissible $(0,0)$-superform on $|\Sigma|$ 
such that $\opn{Crit}(s_{p,q})=\{x\}$ where
$x=(0,\ldots,0)$ and
\begin{align}
p=\sharp(\pi_0(\{s_{p,q}>0\})), \quad 
q=\sharp(\pi_0(\{s_{p,q}<0\})).
\end{align}

Then, 
\begin{align}
\opn{ind}_v(s_{p,q})=1-q ,\quad \opn{ind}_v(-s_{p,q})=1-p.
\end{align}

\end{proposition}

\begin{proof}
From definition, $f$ is a monotone function except 
at $x$.
\end{proof}

\begin{example}
When $p+q=3$, 
\begin{align}
\opn{ind}_x(s_{3,0})=1, \quad 
\opn{ind}_x(s_{2,1})=0, \quad \opn{ind}_x(s_{1,2})=-1, 
\quad \opn{ind}_x(s_{0,3})=-2.
\end{align}
\end{example}

\begin{remark}
\label{remark-nondeprave-curve}
Every $|\Sigma|$ of \cref{proposition-n-valent}
has a coarse polyhedral cone structure 
$\mathscr{C}$. 
For this structure, $s_{p,q}$ has a unique critical 
point at the origin with respect to 
$\mathscr{C}$ in the theory of stratified 
Morse theory \cite[Part I.2.1]{MR932724}
but does not satisfy the nondegeneracy condition.
In particular, $s_{p,q}$ is not nondepraved 
at the origin \cite[Part I.2.3]{MR932724}, 
and thus we cannot use the theory of local Morse 
data for nondepraved functions directly 
\cite[Part I. Definition 3.5.2]{MR932724}. 
We expect, however, that there exists a 
generalized version of local Morse data 
which can apply for our settings.
\end{remark}

\begin{proposition}
\label{proposition-1-valent}
Let $U\deq [-\infty,a) (\subset \underline{\mathbb{R}})$ be a connected open neighborhood of 
$-\infty$ and $f\colon U\to \mathbb{R}$ a weakly-smooth
function on $U$ such that $\opn{Crit}(f)=\{-\infty\}$.
Then, $\{f< 0\}$ is equal to $\emptyset$ or 
$U\setminus\{-\infty\}$.
\end{proposition}

As like \cite{auroux2022lagrangian},
we also use the notion of the rotation number of 
permissible Cartier divisor.
Fix a connected smooth tropical curve $C$
 and $C_0$ the 
regular part of $C$.
If $C$ is not isomorphic to a circle, then
$C_0$ is a disjoint union of open interval:
\begin{align}
  C_0\simeq \coprod_{e\in E} (a_e,b_e), \quad
(a_e\in \mathbb{T}
=\mathbb{R}\cup\{-\infty\}, b_e\in \mathbb{R}\cup\{+\infty\}).
\end{align}

$C_0$ is an integral affine manifold, 
and thus $C_0$ has a standard Lagrangian torus fibration
$\check{f}_{C_0}\colon \check{X}(C_0)\to C_0$ and
a dual torus fibration 
$f_{C_0}\colon X(C_0)\to C_0$,
(see \cref{definition-integral-affine-manifold}
and \cref{definition-SYZ-torus-fibration}).

\begin{definition}
\label{definition-continuous-section}
Let $C$ be a tropical curve.
We set the following spaces:
\begin{align}
\check{X}(C_0)\deq T^{*}C_0/\mathcal{T}_{\mathbb{Z},C_0}^{\vee}, \quad 
\check{X}_0(C)\deq \check{X}(C_0)\sqcup_{i,\check{s}_0}C
\end{align}
where $\check{X}(C_0)\sqcup_{i,s}C$ is the pushout of 
the inclusion $i\colon C_0 \to C$ and 
$\check{s}_0\colon C_0\to \check{X}(C_0)$ is the zero 
section of $\check{f}_{C_0}\colon \check{X}(C_0)
\to C_0$.
\end{definition}

Obviously, $\check{X}_0(C)$ has a canonical projection
$\check{f}_C \colon \check{X}_0(C)\to C$.

\begin{example}
If $C=\mathbb{T}P^{1}$, then 
$\check{X}_0(C_0)$ is just a 
cylinder with infinity length.
$\check{X}_0(\mathbb{R})$ has a canonical homeomorphism:
$\Phi \colon \check{X}_0(\mathbb{R})\to 
\mathbb{R}\times (\mathbb{R}^{\vee}/\mathbb{Z}^{\vee});
(p,q dx_p)\mapsto (p,q)$.
\begin{align}
\check{X}_0(\mathbb{T}P^{1})\simeq 
\{(-\infty,0)\}\cup(\mathbb{R}\times 
\mathbb{R}^{\vee}/\mathbb{Z}^{\vee})
\cup \{(+\infty,0)\}.
\end{align}
The negation map
$\iota \colon\mathbb{T}P^{1}\to \mathbb{T}P^{1}; x\mapsto -x$
induces the canonical automorphism induced from the pullback of cotangent bundles:
\begin{align}
\iota^{*}\colon \check{X}_0(\mathbb{T}P^{1})
\to \check{X}_0(\mathbb{T}P^{1}); (x;y)\mapsto (-x;-y). 
\end{align}
This is a symplectic automorphism on 
$\check{X}_0(\mathbb{R}) (\subset \check{X}_0(\mathbb{T}P^{1}))$ since 
$dx\wedge dy=d(-x)\wedge d(-y)$.
This automorphism can be visualized as the 180-degree rotation of the 
cylinder.
\end{example}

The following proposition is a repeative work of
\cref{section-stratified-torus-fibration}.

\begin{proposition}[{continuous sections}]
\label{proposition-permissible-section}
Let $s$ be an permissible Cartier divisor 
$s=\{(U_i,f_i)\}_{i\in I}$ on a tropical curve 
$C$ with no 1-valent vertex. 
Then, 
{\setlength{\leftmargini}{22pt}
\begin{enumerate}
\item There exists the following continuous map:
\begin{align}
\check{s}\colon C\to \check{X}_0 (C); x
\mapsto (x,\opn{pr}_{C,x}(df_{i}(x))).
\end{align}
\item If $\check{s}_0\colon C\to \check{X}_0 (C)$ be the 
zero section, then $s_0\cap s=\check{\pi}_C(\check{s}_0\cap \check{s})$.
\end{enumerate}
}
\end{proposition}
\begin{proof}
(1): First, we check $\check{s}$ is well-defined.
Choose $(U_i,f_i)$ and $(U_j,f_j)$ such that
$U_i\cap U_j\neq \emp$. 
Then, $df_i(x)-df_j(x)\in 
(\mathcal{F}_{\mathbb{Z},C}^{1})_x$ and
$df_i(x)\in (\mathcal{F}_{\mathbb{Z},C}^{1})_x$
from \cref{proposition-permissible-curve} (2).
Therefore, the construction of $\check{s}$ is well-defined.
$\check{s}$ is continuous, obviously.

(2): Omit.
\end{proof}





Let $C$ be a tropical curve and 
$\mathcal{A}_C^{\opn{weak}}$ be the sheaf 
of weakly-smooth functions on $C$. From definition,
$\mathcal{A}_C^{0,0}\subset \mathcal{A}_C^{\opn{weak}}$
and $\mathcal{A}_C^{\opn{weak}}$ is also a fine sheaf.
Since $\mathcal{A}_C^{\opn{weak}}$ is fine, 
the connected homomorphism 
$\delta\colon \Gamma(C;\mathcal{A}_C^{\opn{weak}}/
\mathcal{O}^{\times}_C)\to \opn{Pic}(C)$ is 
surjective.

\begin{proposition}
Let $s$ be a $C^{\infty}$-Cartier divisor on a compact
tropical curve $C$.
Then, there exists
an permissible Cartier divisor $s'$ which is linearly
equivalent to $s$ and
$s_0\cap s'$ is a finite set. 
\end{proposition}
\begin{proof}
Every $C^{\infty}$-Cartier divisor $s$ on $C$ is 
permissible at $1$-valent vertex on $C$. So, we
can assume $C$ has no 1-valent vertex. 
Choose a sufficently small open neighborhood 
$U_p$ of $p\in C\setminus C_0$. Then, there exists a 
$(0,0)$-superform $f\colon U_p \to \mathbb{R}$ such 
that $(f)^{\mathrm{sm}}=s|_{U_p}$. Besides, there exists 
a smooth function $f_0\colon U\to \mathbb{R}$ for 
an open subset $U$ of $T_p C$ 
which defines $f$. We can perturb $f$ with 
$\tilde{f}$ such that 
$d\tilde{f}(p)\in (\mathcal{F}_{\mathbb{Z},S}^{1})_p$
and $f|_{U\setminus K}=\tilde{f}|_{U\setminus K}$ for 
a sufficiently small compact neighborhood $K$ of $0$.
Therefore, we can assume $s$ is permissible.  
Next, we check that we can shoose $s'$ 
such that $s\cap s'$ is a finite set.
Fix an open edge $e$ of $C$.
Then, $s|_e$ is the principal divisor of a bounded smooth 
function $f$ on $e$. 
Therefore, we can choose a smooth bump function $g$ on $e$ such 
that $f+g$ is nondegenerate. We can extend $g$ on $C$ 
by zero, and thus $s+g$ is linearly equivalent to $s$.
By repeating this, we get an permissible Cartier divisor
$s'$ on $C$ such that $\sharp (s\cap s')<\infty$.
\end{proof}





$\check{X}(C_0)$ has a canonical symplectic structure
and thus there exists a canonical orientation induced
from the symplectic form on $\check{X}(C_0)$.
This form defines an orientation number of 
section defined in \cref{proposition-permissible-section}.

\tikzset{every picture/.style={line width=0.75pt}} %set default line width to 0.75pt        

\begin{figure}
  \centering
  \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
    %uncomment if require: \path (0,302); %set diagram left start at 0, and has height of 302

    %Shape: Ellipse [id:dp7113644287533367] 
    \draw   (220,160.5) .. controls (220,138.13) and (230.07,120) .. (242.5,120) .. controls (254.93,120) and (265,138.13) .. (265,160.5) .. controls (265,182.87) and (254.93,201) .. (242.5,201) .. controls (230.07,201) and (220,182.87) .. (220,160.5) -- cycle ;
    %Shape: Ellipse [id:dp2574876106229609] 
    \draw   (385,160.5) .. controls (385,138.13) and (395.07,120) .. (407.5,120) .. controls (419.93,120) and (430,138.13) .. (430,160.5) .. controls (430,182.87) and (419.93,201) .. (407.5,201) .. controls (395.07,201) and (385,182.87) .. (385,160.5) -- cycle ;
    %Straight Lines [id:da9747654267031158] 
    \draw    (242.5,120) -- (407.5,120) ;
    %Straight Lines [id:da6388065944921051] 
    \draw    (242.5,201) -- (407.5,201) ;
    %Straight Lines [id:da44727041223554886] 
    \draw  [dash pattern={on 15pt off 1.5pt}]  (220,160.5) -- (385,160.5) ;
    %Curve Lines [id:da44274218397801035] 
    \draw    (220,160.5) .. controls (263,97.5) and (348,224.5) .. (385,160.5) ;
  \end{tikzpicture}

\caption{A continuous section $s\colon [0,1]\to [0,1]\times \mathbb{R}/\mathbb{Z}$}
\end{figure}

\begin{definition}[{rotation number of closed interval}]
Fix a closed interval $[a,b]$ in $\mathbb{T}P^{1}$.
Let $s\colon [a,b]\to [a,b]\times \mathbb{R}/\mathbb{Z}$ be 
a continuous section of the canonical projection
$p\colon [a,b]\times \mathbb{R}/\mathbb{Z} \to [a,b]$
such that $s(a)=(a,0)$ and $s(b)=(b,0)$. 
The rotation number
is the homotopy class of the closed path
$q\circ s\colon [a,b]\to \mathbb{R}/\mathbb{Z}$
induced from $s$ and the canonical projection
$q\colon [a,b]\times \mathbb{R}/\mathbb{Z} 
\to \mathbb{R}/\mathbb{Z}$. Here, 
we identify $\pi_1(\mathbb{R}/\mathbb{Z},0)\simeq \mathbb{Z}$
via the canonical orientation of $\mathbb{R}/\mathbb{Z}$.
\end{definition}

\begin{proposition} \label{proposition-rotation-number}
Let 
$\phi \colon [a,b] \to [a,b]$ be an automorphism of 
a closed interval in $\mathbb{T}P^{1}$, 
$s\colon [a,b]\times \mathbb{R}/\mathbb{Z}$ and 
$\varphi \colon [a,b]\times \mathbb{R}/\mathbb{Z} \to 
[a,b]\times \mathbb{R}/\mathbb{Z}$ 
the symplectic automorphism induced from $\phi$.
Then, $\opn{rot}(\varphi\circ s)=\opn{rot}(s)$.
\end{proposition}
\begin{proof}
Since every automorphism of 
$[a,b]$ is a composition of the negation map 
with a translation map, we only need to consider the case
when $\phi$ is the negation map.
In this case, $\varphi(x,y)=(b+a-x,-y)$ for 
$(x,y)\in [a,b]\times \mathbb{R}/\mathbb{Z}$ if 
$a,b\notin \{-\infty,\infty\}$.
\end{proof}


From \cref{proposition-permissible-section} and \cref{proposition-rotation-number}, we can define the 
rotation number for every permissible smooth 
Cartier divisors as follows.
\begin{definition}[{cf. \cite{auroux2022lagrangian}}]
Let $s$ be a $C^{\infty}$-Cartier divisor and 
$\check{s}$ its assocaited Lagrangian section.
The \emph{rotation number} of $s$ is the sum of
the rotation number of all edges of $C$: 
\begin{align}
\opn{rot}(s)\deq \sum_{e\in \pi_0(C_0)}
\opn{rot}(\psi_{\bar{e}}^{*}(\check{s}))
\end{align}
where 
$\psi_{\bar{e}}\colon [a_e,b_e]\to C$ is 
a continuous map such that the restriction of $\psi_{\bar{e}}$ 
on $(a_e,b_e)$ is an isomorphism onto $e$.
\end{definition}

\begin{definition}
Let $s\in \opn{CDiv}^{\infty}(C)$ be a $C^{\infty}$-Cartier
divisor and $\{(U_i,f_i)\}_{i\in I}$ a local data
for $s$. The data is \emph{locally constractible} if 
every $U_i$ is isomorphic to a contractible open 
neighborhood of $0$ in $\opn{LC}_{p}C$ where 
$p\in U_i$.
\end{definition}
If a local data $\{(U_i,f_i)\}_{i\in I}$ for $s$ 
is locally contractible,
we can calculate the divisor class $[s]$ of $s$ easily
by using the \v{C}ech cohomology 
$\check{H}^{1}(C;\mathcal{O}_C^{\times})$ of 
$\mathcal{O}_C^{\times}$:
\begin{align}
[s]=(f_j-f_i)_{i,j\in I}.
\end{align}

\begin{proposition}
Let $s$ be an permissible $C^{\infty}$-Cartier divisor on
a compact tropical curve $C$.
\label{equation-rotation-number}
\begin{align}
\opn{rot}(s)=\opn{deg}([s])(=\int_{C} c_1([s])).
\end{align}
\end{proposition}

\begin{proof}
We can create an ordinary Cartier divisor $D$
from a $C^{\infty}$-Cartier divisor $s$ such 
that its divisor class is equivalent by 
using the \v{C}ech cocycle representation of 
$[s]$. Then, we can easily calculate the 
\cref{equation-rotation-number} for 
an typical $D$. The degree of $D$ is 
invariant for any choice of $D$.
\end{proof}

\begin{remark}
\label{remark-rotation-closed-interval} 
The above proposition 
is \emph{not} true for general compact metric curves.
Let $C\deq [0,1]$ be a closed interval
and $f_n\colon C\to \mathbb{R};x \mapsto nx^{2}$.
All $f_n$ is an permissible $(0,0)$-superform on $C$.
From the definition of smooth principal Cartier divisor,
$\opn{deg}(D_{(f_n)^{\mathrm{sm}}})=0$. 
A philosophical reason of this is that
a closed interval with finite length is a tropical
analog of a closed annulus in $\mathbb{C}$ but not for
a complex projective line (cf. 
\cite[Definition 3.7]{MR3903579}). In fact, $X(C_0)$ 
has a standard complex structure which is holomorphic to
an open annulus in $\mathbb{C}$.
\end{remark}

\begin{proposition}
\label{proposition-simple-interval-rr}
Let $C=[a,b]$ be a closed interval in $\mathbb{T}P^{1}$
and $s$ a permissible $C^{\infty}$-Cartier divisor on 
$C$
such that $s_0\cap s=\{a,b\}$. Then,
\begin{align}
\chi(\opn{LMD}^{\bullet}(C;s))=\opn{rot}(s)+
\chi_{\opn{top}}(C).
\end{align}
\end{proposition}
\begin{proof}
We can calculate from 
\cref{proposition-n-valent} and 
\ref{proposition-1-valent} directly for a case by case
type of an intersection data for $s$.
\end{proof}

A good point of the rotation number and the 
Euler number of $s$ is the 
following Meyer--Vietoris type lemma.

\begin{proposition}
\label{proposition-gluing-formula}
Let $s$ be an permissible $C^{\infty}$-Cartier divisor on a
compact metric graph $C$ such that $s_0\cap s<\infty$.
Fix two closed metric subgraph of $C$ such that
$C' \cup C''=C$ and $C'\cap C''\subset s_0 \cap s$.
Then, 
the inclusion $i_{C'}\colon C'\to C$ 
and $i_{C''}\colon C''\to C$ induces
\begin{align}
\label{equation-meyer-vietoris}
\chi(\opn{LMD}^{\bullet}(C;s))
&=\chi(\opn{LMD}^{\bullet}(C';i_{C'}^{*}(s)))
+\chi(\opn{LMD}^{\bullet}(C'';i_{C''}^{*}(s)))
-\sharp(C'\cap C''), \\
\label{equation-rotation-sum}
\opn{rot}(s)&=\opn{rot}(i_{C'}^{*}(s))
+\opn{rot}(i_{C''}^{*}(s)).
\end{align}
\end{proposition}
\begin{proof}
From assumption $i^{*}_{C'}(s)$ and 
$i^{*}_{C''}(s)$ are permissible.
The \cref{equation-rotation-sum} is true from
the definition of rotation number. 
 Besides,
\begin{align}
s_0\cap i^{*}_{C'}(s)=i^{-1}_{C'}(s_0\cap s), \quad 
s_0\cap i^{*}_{C''}(s)=i^{-1}_{C''}(s_0\cap s), \quad
s_0\cap i^{*}_{C'\cap C''}(s)=
i^{-1}_{C'\cap C''}(s_0\cap s).
\end{align}
By \cref{proposition-n-valent} 
and Meyer--Vietoris sequence, we get 
the \cref{equation-meyer-vietoris}.
\end{proof}

We can generalize
\cref{proposition-simple-interval-rr} by
\cref{proposition-gluing-formula} as follows.

\begin{proposition}
\label{proposition-MRR-1-dim-poly-space}
Let $C$ be a compact pure $1$-dimensional rational 
polyhedral space satisfying \cref{condition-Rn} 
and $s$ a $C^{\infty}$-Cartier divisor on $C$. Then,
\begin{align}
\chi(\opn{LMD}^{\bullet}(C;s))=\opn{rot}(s)+
\chi_{\opn{top}}(C).
\end{align}
\end{proposition}





\begin{proof}
Without loss of generality, we can assume $C$ is 
connected and $\sharp (s_0\cap s)\geq 1$.
Since $s_0\cap s\supset (C\setminus C_0)$, 
The set $s_0\cap s$ induces a cell decomposition of 
$C$. We will prove the theorem by mathematical 
induction for the cardinality of 
$\pi_0(C\setminus (s_0 \cap s))$, i.e., the 
number of edges of the cell decomposition.
When $\sharp\pi_0(C\setminus (s_0 \cap s))=1$, 
$C$ is homeomorphic to a closed interval 
or a closed circle and 
$\sharp (s_0\cap s)\leq 2$ 
from the definition of cell complex.
In this case, \cref{theorem-MRR-metric-graph} is 
true from \cref{proposition-n-valent} directly.

Suppose \cref{theorem-MRR-metric-graph} is true
for all $C^{\infty}$-Cartier divisors $s$ on 
$C$ such that $\sharp \pi_0(C\setminus (s_0 \cap s))=n$.
Let $C$ be a $1$-dimensional 
compact rational polyhedral space
such that $\sharp\pi_0(C\setminus (s_0 \cap s))=n+1$.

Then, we can choose a pair of proper subgraph $C',C''$ of
$C$ such that
$C'\setminus (s_0\cap i^{*}_{C'}(s))\leq n$,
$C''\setminus (s_0\cap i^{*}_{C''}(s))\leq n$,
$C'\cup C''=C$
and $(C'\cap C'')\subset (s_0\cap s)$.

By \cref{proposition-gluing-formula}, we get 
\begin{align*}
\chi(\opn{LMD}^{\bullet}(C;s))
&=\chi(\opn{LMD}^{\bullet}(C';i_{C'}^{*}(s)))
+\chi(\opn{LMD}^{\bullet}(C'';i_{C''}^{*}(s)))
-\sharp(C'\cap C'') \\
&=\opn{rot}(i_{C'}^{*}(s))
+\opn{rot}(i_{C''}^{*}(s))
+\chi_{\opn{top}}(C')+\chi_{\opn{top}}(C'')
-\chi_{\opn{top}}(C'\cap C'') \\
&=\opn{rot}(s)+\chi_{\opn{top}}(C).
\end{align*}

\end{proof}

\begin{proof}[{Proof of \cref{theorem-MRR-curve-preface}}]
We can prove it from \cref{proposition-MRR-1-dim-poly-space}
and \cref{equation-rotation-number}.
\end{proof}

\begin{remark}
\label{remark-non-permissible-divisor}
We explain the reason why we add permissible condition for 
$C^{\infty}$-Cartier divisors. 
One of reasons is that there exists smooth function $f$
on a polyhedral space $S$ and 
$x\notin\opn{Crit}(f|_S)$ such that
$\opn{LMD}^{\bullet}(A_S,f|_{S},x)$ is nontrivial.
Another reason is that we could not create 
convenient continuous sections like 
\cref{definition-continuous-section} easily.

The third reason is the most critical. 
We will explain about this problem by the following 
example:
Let 
$g$ be a weakly-smooth function on 
$\Gamma_3$
such that 
\begin{enumerate}
\item $dg=(\frac{1}{2},\frac{1}{2})$,
\item $\opn{Crit}(g)=\Gamma_3\setminus \Gamma_3^{\circ}$,
\item $\sum_{p\in \opn{Crit}(g)}\opn{ind}_p(g)=2$.
\end{enumerate}
$g$ is permissible except $x=(0,0)$.
If we generalize 
\cref{theorem-MRR-curve-preface} for 
a principal non-permissible 
$C^{\infty}$-Cartier divisors $(g)^{\mathrm{sm}}$, 
we need to add the index $\opn{ind}_x(g)$ at $x$ satisfying
\begin{align}
\sum_{p\in \opn{Crit}(g)}\opn{ind}_p(g)+
\opn{ind}_x(g)=1=\chi_{\opn{top}}(\Gamma_3).
\end{align}
At least, \cref{theorem-MRR-curve-preface} is not
true without correction the effect at non-permissible point
of $g$.
In this case, $\opn{ind}_x(g)$ should be $-1$.
This condition is independent of the choice
of $g$ satisfying the above condition.
On the other hand, the index of a given 
$C^{\infty}$-Cartier divisor should be 
independent of the choice of 
$C^{\infty}$-Cartier local data.
Since $\opn{ind}_x(g+m)$ depends on the choice
of monomials $m$, we need to choose a monomial $m_0$
with integer slope to 
define the index of $g$ at $x$ as a divisor.
We consider there is no canonical choice
of $m_0$ for $g$ as a principal divisor without
assumption permissibility.
Every permissible function $f$ has a canonical choice
of monomials which is determined by the condition 
whether $x\in \opn{Crit}(f+m)$ or not.
We could not use this condition for $g$ since 
$x\notin \opn{Crit}(g+m)$ for every monomial with
integer slope.
\end{remark}

\begin{remark}
Our definition of $C^{\infty}$-Cartier divisor 
has an analog of positive divisor by using 
the local data $\{(U_i,f_i)\}_{i\in I}$ as 
explained in \cref{example-tropical-kodaira-vanishing}.
However, this positive divisor is different 
from ample line bundles for tropical curves. 
If $s$ is a positive $C^{\infty}$-Cartier divisor, then
$\chi(\opn{LMD}(C;s))=\sharp(s_0\cap s)\geq \sharp 
(C\setminus C_{0})$. 
Thus, $\chi(\opn{LMD}(C;s))\geq 2g(C)-2$
when $C$ is a compact trivalent
graph with no $1$-valent vertex. This means that
$\opn{deg}(s)\geq 3g(C)-3$.
On the other hand, every divisor $D$ satisfying
$\opn{deg}(D)>0$ is ample \cite[Corollary 43]{MR2892941}.
In other words, there is no direct tropical
analog of Kodaira embedding theorem
in tropical geometry.
\end{remark}



\subsection{Relationships between previous results}
\label{section-tropical-curve-note}


\subsubsection{Relationships between
homological mirror symmetry of trivalent graphs}
\label{section-syz-trivalent-graph}

Our approach is mostly affected from 
\cite{auroux2022lagrangian}.
\label{section-syz-trivalent-graph}
When $C$ is a trivalent metric graph, 
our $\check{X}_0(C)$ are 
almost the trivalent cofiguration $M$ of 
$2$-spheres in 
\cite[3.1]{auroux2022lagrangian}.
Here, the space $M$ is the
union of $\C P^{1}$'s whose intersection complex is $C$, 
i.e., every edge of $C$ corresponds
$\C P^{1}$ and every trivalent vertex of $C$ corresponds
to the intersection points of some three $\C P^{1}$'s.
The mirror manifold of $M$ is an algebraic curve $X_K$
from Mumford's construction using the dual intersection
complex $C$.

The similarity of $\check{X}_0(C)$ and $M$ is evident 
since $M$ is a compactification of $\check{X}_0(C)$ 
as a topological space,
so below we will write the manin differences
between  
we will list the differences between 
$X_0(C)$ and $M$ below:
{\setlength{\leftmargini}{22pt}
\begin{enumerate}
  \item The local model of $M$ comes from the critical locus
of the potential function of a (A-side) Landau--Ginzburg 
model $(\C^{3},-xyz)$.
  \item If a $C^{\infty}$-Cartier divisor $s$ on $C$ 
satisfies 
\cref{condition-good-divisor} and has an interesection 
data $\{(U_p,f_p)\}_{p\in s_0\cap s}$ such that
$f_p$ is strictly convex at all $p\in C\setminus C_0$, 
then $\opn{LMD}_{\Lambda_{\mathrm{nov}}^{\mathbb{C}}}
(C;s)$ corresponds to the 
Floer complex \cite[(3.2)]{auroux2022lagrangian}
as a graded modules, but 
the both are different each other if not. 
In particular, the graded modules associated with 
an intersection point $p\in s_0\cap s$ may not 
be a shift of $1$-dimensional vector space.
\item We don't know the differential $\mathfrak{m}_1$ 
for $\opn{LMD}_{\Lambda_{\mathrm{nov}}^{\mathbb{C}}}
(C;s)$ in general.
\end{enumerate}
}


The stratified torus fibration of Riemann surface is 
closely related with pants decomposition and 
there exists a higher 
dimensional pants decomposition \cite{MR2079993} along
tropical hypersurfaces.
Auroux--Efimov--Katzarkov  
expect a SYZ conjecture
for projective hypersurfaces 
in \cite[\textsection 7]{auroux2022lagrangian}.
Our $\check{X}(S)$ for a boundaryless
rational polyhedral spaces $S$ may give a hint for 
a generalization of their expectation.  
\subsubsection{Relationships between 
Poincar\'e--Hopf theorem for graphs}

\cref{theorem-MRR-curve-preface} can be considered 
as a $C^{\infty}$-version of Knill's graph 
theoretical Poincar\'e--Hopf theorem \cite{knill2012graph}
or 
Banchoff's critical point theorem \cite{MR225327}
when the line bundle on a tropical curve is trivial.
We can easily see the index $i(v)$ defined in 
\cite[\textsection 3]{knill2012graph}
corresponds to $\opn{ind}_v(f)$ defined in 
\cref{equation-local-index} (see also 
\cref{proposition-n-valent} and 
\cite[\textsection 7]{knill2012graph}).

Banchoff proved a polyhedral complex version of Poincar\'e--Hopf theorem
for height functions \cite[Theorem 1]{MR225327}.
The definition of the index $a(v,f)$ 
\cite[p.246]{MR225327} which 
he used for the theorem may seem different 
from our index but essentially equal to it
(see also \cite[p.143-144]{grunert2017piecewise} 
for more detail about it).





\subsubsection{Relationships with a localization of 
index on compact Riemann surfaces.}

We mention relationships between 
\cref{theorem-MRR-curve-preface} and
\cite[6]{MR2676658}.
For simplicity,
we assume $C$ is a compact trivalent tropical curve, i.e.,
a compact tropical curve which only has $3$-valent
vertex in $C\setminus C_0$.  
$C_0$ has a canonical dual torus fibration 
$\pi_{C_0}\colon X(C_0)\to C_0$ of
$\check{\pi}_{C_0} \colon \check{X}(C_0)\to C_0$.
We can define $X_0(C)\deq C\sqcup_{i,s} X(C_0)$ like
$\check{X}_0(C)$.
$C$ has a canonical lattice length metric $d_{C}$, and
thus we can define the following set for sufficiently small
$\vep >0$: 
\begin{align}
C_{0,\vep}\deq \{p\in C\mid d_C(p,v)>\vep 
\text{ for all } v\in C\setminus C_0\}.
\end{align}

For a given $\vep>0$ (and a \emph{signed tropical structure}
on $C$ \cite{MR3076066}), 
$X_0(C)$ can be considered as a subset of a compact 
Riemann surface $X$ whose complex structure is 
compatible with $X(C_{0,\vep})$. 
Such a $X$ is given by gluing triangles for 
each open neighborhood of $p\in X_0(C)\setminus X(C_0)$
appropriately.
Let $s$ be an permissible $C^{\infty}$-Cartier divisor on $C$.
$s|_{C_0}$ corresponds to a Lagrangian section of 
$\check{\pi}_{C_0}$ from 
\cref{proposition-cartier-lagrangian}.
By topological SYZ transformation 
(see for example \cite{MR1876073} or 
\cite[\textsection 9.1]{MR1882331}),
$s|_ {C_0}$ induces a family of $U(1)$-holonomoy for
each torus fiber $\pi_{C_0}^{-1}(p)$ and defines a 
complex line bundle on $C_{0,\vep}$. From now on, 
we suppose $s_0\cap s<\infty$. 
Let $\{(U_p, f_p)\}_{p\in s_0\cap s}$ be the
 intersection data 
for $s$ such that 
$\{x\in C\mid d_C(p,x)\leq \vep\}\subset U_p$ for
all $p\in C\setminus C_0$.
Besides, we assume 
$(s\cap s_0)\setminus C_{0,\vep}=C\setminus C_0$ and $s$ satisfies the following cocycle
condition for each $p\in C\setminus C_0$:
\begin{align}
df_p(p_1)+df_p(p_2)+df_p(p_3)=0,\quad 
(\{p_1,p_2,p_3\}\deq \{x\in C\mid d_C(p,x)=\vep\}).
\end{align}

From the above condition, $0<|df_p(p_i)| \ll 1$ and
$f$ is of type $s_{2,1}$ or $s_{1,2}$ discussed
in \cref{proposition-n-valent}.
From the above condition, we can define 
a flat $U(1)$-bundle on each pants of a 
connected component of $X\setminus X(C_{0,\vep})$
as like \cite[6.1.3]{MR2676658}.
We remark the isomorphism
$(\mathcal{F}_{\mathbb{Z},C}^{1})_p\otimes_{\mathbb{Z}}
\mathbb{R}/\mathbb{Z}\simeq 
H^1(\mathbb{P}^{1}\setminus 
\{0,1,\infty\};\mathbb{R}/\mathbb{Z})$
is important for this construction.
The $s_{2,1}$
corresponds a small pants and the $s_{1,2}$
corresponds a large pants in 
\cite[Definition 6.3]{MR2676658}.


Each small pants and large pants have a local
Riemann--Roch number defined the theory of 
localization of Dirac-type operator and its 
number is equal 
to our index by the above correspondence.
The following equation is a correspondence about 
local index $\opn{ind}_v$ and the Local 
Riemann--Roch number under the above 
identification \cite[Theorem 6.7]{MR2676658}.
\begin{align} \label{equation-local-RR}
& [BS^{+}]=\opn{ind}_v(s_{2,0})=1, 
&& [BS^{-}]=\opn{ind}_v(s_{0,2})=-1,\notag \\
& [D^{+}]=\opn{ind}_v(s_{1,0})=1,
&& [D^{-}]=\opn{ind}_v(s_{0,1})=0, \\
& [P^{S}]=\opn{ind}_v(s_{2,1})=0,
&& [P^{L}]=\opn{ind}_v(s_{1,2})=-1 \notag.
\end{align}
The origin of our approach firstly comes from the 
above correspondence.

From this correspondence, 
our theorem for tropical curve can be 
proved by the theory of localization of index 
and classical Riemann--Roch formula.
We stress that both method of computation
of our index and the local Riemann--Roch number
defined in \cite{MR2676658} are different 
each other even though both indexes have various 
similar features.
We also note that it was the beginning of our 
approach that we 
noticed the above correspondence.
We can also consider the following question as 
like \cite{auroux2022lagrangian}.

\begin{question} \label{question-tropical-complex-rr}
Can we generalize the 
above correspondence \ref{equation-local-RR}
for more general the complement of
projective hyperplane arrangements and flat $U(1)$-bundles on it?
How about for pants decomposition of
  complex algebraic hypersurfaces in \cite{MR2079993} and line bundles?
\end{question}

We add two comments about the above question. 
First, the Bergman fan $\Sigma$ of a given complex 
(projective) hyperplane arrangement $\mathcal{A}$ does \emph{not} 
determine 
the homotopy type of the complement of (projective) 
hyperplane
arrangements $U(\mathcal{A})$ uniquely in general.
Second, every flat $U(1)$-bundle on 
$U(\mathcal{A})$ is, 
however, given
from a group homomorphism 
$\rho\colon T_{|\Sigma|,0}^{\mathbb{Z}}\to 
\mathbb{R}/\mathbb{Z}$ since 
$T_{|\Sigma|,0}^{\mathbb{Z}}\simeq 
H_1(U(\mathcal{A});\mathbb{Z})$ (see \cite[Theorem 4]{MR3153919}).
Therefore, we hope that we can get an affirmative answer 
for \cref{question-tropical-complex-rr}.

\section{Proof for integral affine manifold with Hessian form.}
\label{section-integral-affine-manifold}
In this section,
we recall the notion of affine manifolds from
\cite{MR2293045,
goldmanRadianceObstructionParallel1984a,
MR2181810,
grossMirrorSymmetryLogarithmic2006a} and 
\cite[Chapter 6]{MR2567952}.

\begin{definition} \label{definition-integral-affine-manifold}
An $n$-dimensional \emph{integral affine 
(resp. strongly integral affine, affine)} manifold
is a pair of an $n$-dimensional differential manifold $B$ 
and an atlas $\{(U_i,\psi_i)\}_{i \in I}$ of $B$ such that 
$\psi_i \circ \psi_j^{-1}$ is a restriction of 
an element in $\opn{GL}_n(\mathbb{Z})\ltimes \mathbb{R}^{n}$
(resp. $\opn{GL}_n(\mathbb{Z})\ltimes \mathbb{Z}^{n}$,
$\opn{GL}_n(\mathbb{R})\ltimes \mathbb{R}^{n}$) for any $i,j\in I$.
\end{definition}

\begin{remark}
An (integral) affine manifold is a special case of 
$(G,X)$-manifolds \cite[3.3]{MR1435975}.

The terminology integral affine manifold has 
different terminologies for different authors. 

For instance, an integral (resp. strongly integral) affine manifold 
is called a tropical affine manifold (resp. integral affine manifold)
in \cite[Definition 1.22]{MR2722115}. 
The terminology `strongly integral affine manifold' 
comes from \cite[Remark 5.10]{MR3079343}.
\end{remark}


We can consider a sheaf theoretic definition of 
integral affine manifold as explained 
in \cite[2.1]{MR2181810} 
and every integral affine manifold is a special case of 
tropical manifold. 
Every integral affine structure of $B$ induces a 
canonical local system $\mathcal{T}_{\mathbb{Z},B}$ 
of integer valued vector bundle and the dual 
local system $\mathcal{T}_{\mathbb{Z},B}^{\vee}$ of it.



Let $(B,\{(U_i,\psi_i)\}_{i \in I})$ be an affine manifold.
Every  $U_i$ has a coordinate system $\{x_k\}_{k=1,\ldots,n}$ 
induced from a coordinate system formed 
by affine functions on $\mathbb{R}^{n}$.
We call this coordinate system \emph{affine coordinate system} 
of $U_i$. 

\begin{definition}[{cf. \cite[p.213]{MR413010}}]
A \emph{Hessian metric} or \emph{metric of Hessian form} on an affine manifold 
$(B,\{(U_i,\psi_i)\}_{i \in I})$.
is a Riemannian metric $g$ such that 
there exists a multi-valued function $K$ on $B$ satisfying
$g=\sum_{k,l}\frac{\partial K}{\partial x_k \partial x_l}dx_k dx_l$ for 
an affine conndinate system of $U_i$. The triple
$(B,\{(U_i,\psi_i)\}_{i \in I},g)$ is called a \emph{Hessian manifold}.
\end{definition}
\begin{remark}
We follows the terminology Hessian metric and Hessian manifold 
from \cite{MR2293045}.
The terminology 
Hessian manifold is called
\emph{K\"ahler affine manifold}
in \cite{MR714338}, \emph{affine K\"ahler manifold}
or AK-manifold \cite{MR1882331} for short.
To our knowledge, the notion of Hessian metric have already
appeared in \cite{MR413010}.
\end{remark}


\begin{example}
Let $f \colon \mathbb{R}^{n} \to \mathbb{R}$ be a continuous function defined by 
\cref{equation-log-polynomial}.
$f$ is smooth and convex 
on $\mathbb{R}^{n}$.
Therefore, $(\mathbb{R}^{n},f)$ form an integral 
Hessian manifold. This is a typical example of
Hessian domain.
See also \cite[Appendix 2]{MR1301331} for general theory for
the relationships for Hessian form and 
the induced K\"{a}hler potential on
toric manifolds.
\end{example}

A Hessian metric can be considered as a $(1,1)$-superform 
naturally and this superform is a certain analog of 
K\"ahler form, so Hessian metric itself is called Hessian form.

\begin{remark} \label{remark-compact-hessian}
We recall a well-known result for 
compact special affine manifold with 
a Hessian form which is mentioned 
in some literature
(e.g. \cite[\textsection 5.2]{MR1882331}).
By \cite[Theorem 2.1 and Corollary 2.3]{MR714338},
 every closed special Hessian manifold $(B,g)$ has 
a flat Riemannian and Hessian metric $\tilde{g}$ such 
that its volume form $\opn{vol}_{\tilde{g}}$ is parallel 
with respect to the
affine connection induced from the affine structure 
on $B$. Moreover, $\tilde{g}$ satisfies 
real Monge--Amp\'ere equation, and thus
the associated first and second Koszul 
form of $\opn{vol}_{\tilde{g}}$ is trivial 
\cite[Definition 3.1.2]{MR2293045}.
If $B$ is a special integral affine manifold with 
a Hessian metric 
$g=\sum_{k,l}\frac{\partial K}{\partial x_k \partial x_l}dx_k dx_l$, 
then the K\"ahler metric $\omega=2\sqrt{-1}\partial \bar{\partial}
(K\circ f_{B})$ on $X(B)$ is Ricci--flat if 
and only if $K$ satisfies real Monge--Amp\'ere equation
\cite[Proposition 6.14]{MR2567952}. 
By applying the proof of \cite[Theorem 8.3.3]{MR2293045}
for $\tilde{g}$,
the Levi--Civita connection of $\tilde{g}$ is 
equal to the affine connection of $B$ 
\cite[Corollary 8.3.7]{MR2293045}. 
By Bieberbach theorem, every closed flat Riemannian manifold 
is covered by a Riemannian flat torus 
(see also \cite[Theorem 5.3]{MR862114}), and thus every closed 
integral Hessian manifold is an unramified finite cover of 
a tropical torus.
\end{remark}

\begin{remark}
The integral affine structure itself is a very strict condition.
\emph{Chern's conjecture} states 
every closed affine manifold $B$ has zero topological 
Euler characteristic.
If $B$ is a closed flat Riemannian manifold, Chern's conjecture is true from Chern--Gauss--Bonnet formula.
This conjecture is true for 
\emph{special affine manifold} \cite{MR3665000},
i.e., an affine manifold $(B, \{U_i,\psi_i\}_{i\in I})$ 
whose transition map is 
in $\opn{SL}_n(\mathbb{R})\ltimes \mathbb{R}^{n}$.
Therefore, every closed integral affine manifold satisfies Chern's conjecture since the orientable double over of an integral affine manifold has a compatible special integral affine structure.
\myfootnote{We have not checked 
the original source of Chern's conjecture yet.
Our knowledge about these conjectures
mainly comes from \cite{goldmanRadianceObstructionParallel1984a}
and \cite{MR3665000}.
}
\end{remark}

\begin{remark}[{Relationships between symplectic geometry}]
Integral affine manifolds naturally appear 
as base spaces of Lagrangian torus fibration 
\cite{duistermaatGlobalActionangleCoordinates1980a}. 
Besides, the deformation space of 
special Lagrangian submanifolds of
a Calabi-Yau $n$-fold with a nowhere vanishing 
holomorphic $n$-form has 
an integral affine structure with 
a Hessian metric by McLean's theorem \cite{MR1664890}.
See also \cref{appendix-geometric-quantization} 
for the relationships between integral affine manifolds 
and geometric quantization. 
\end{remark}


\subsection{Tropical homology, Tropical superform and Cartier data}
From now on, we follow about tropical homology and sheaf 
theory for tropical manifolds
from \cite{mikhalkinTropicalEigenwaveIntermediate2014a,
MR3903579,gross2019sheaftheoretic}.
In the case of affine manifold, this sheaf is already
studied in the field of Hessian geometry as a vector bundle
with a flat connection
(e.g. \cite[Chapter 7]{MR2293045}).
Let $\mathcal{F}^{p}_{\mathbb{Z},X}$ be 
the sheaf defined in 
\cite[2.4]{mikhalkinTropicalEigenwaveIntermediate2014a}
where $p\in \mathbb{Z}_{\geq 0}$.
 (We follow the notation in \cite[Definition 2.4]{MR3894860}.)
If $X$ is a tropical manifold, then 
$\mathcal{F}^{p}_{\mathbb{Z},X}$ is equal 
to the sheaf $\Omega_{X}^{p}$ of tropical $p$-forms 
\cite[Definition 2.7]{gross2019sheaftheoretic}
(see \cite[Remark 2.8]{gross2019sheaftheoretic}).
Throughout in this paper, we assume every rational polyhedral space $X$
satisfies $\Omega_X^{p}\simeq \mathcal{F}_{\mathbb{Z},X}^{p}$
for all $p$.
Let $\mathcal{W}_{p,X}^{\mathbb{Z}}
\deq \mathcal{H}om(\mathcal{F}^{p}_{\mathbb{Z},X},\mathbb{Z}_X)$
be the sheaf of $p$-th wave tangent spaces 
\cite{yamamotoTropicalContractionsIntegral2021,mikhalkinTropicalEigenwaveIntermediate2014a}.
We set $\mathcal{F}^{p}_{X}\deq 
\mathcal{F}^{p}_{\mathbb{Z}, X}
\otimes_{\mathbb{Z}_X}\mathbb{R}_X$ and 
$\mathcal{W}_{p,X}\deq 
\mathcal{W}_{p,X}^{\mathbb{Z}}
\otimes_{\mathbb{Z}_X}\mathbb{R}_X$.



\begin{example}
If $B$ is an integral affine manifold, then 
$\mathcal{F}^{p}_{\mathbb{Z},B}\simeq 
\bigwedge^{p}_{i=1} \mathcal{T}_{\mathbb{Z},B}^{\vee}$ for 
all $p\in \mathbb{Z}_{\geq 0}$ and
$\mathcal{W}^{\mathbb{Z}}_{p,B}\simeq 
\bigwedge_{i=1}^{p}\mathcal{T}_{\mathbb{Z},B}$.
\end{example}

 

We recall some results about tropical superforms from
\cite{MR3903579,smacka2017differential}.
Let $\mathcal{A}^{p,q}_X$ be the sheaf of 
$(p,q)$-superforms on $X$. 
\begin{example}
$\mathcal{A}_X^{0,0}$ can be considered as the 
sheaf of smooth functions on $X$.
In fact, $\mathcal{A}_X^{0,0}$ is isomorphic to 
the sheaf $\mathcal{C}^{\infty}(X)$ of smooth functions 
on $X$ if $X$ is an integral affine manifold.
\end{example}
The bigraded sheaf $\mathcal{A}_X^{\bullet,*}$ has 
a canonical bigraded
complex structure
$(\mathcal{A}_X^{\bullet,*},d',d'')$.

$\mcal{F}^{p}_{X}$ has the following acyclic resolution
\cite[Corollary 3.18, Lemma 3.21]{MR3903579}:
\begin{align}
  0 \to \mcal{F}^{p}_{X} \to \mcal{A}^{p,0}_{X}\xto{d''} 
\mcal{A}^{p,1}_{X} \xto{d''}\cdots.
\end{align}

$(\mathcal{F}_{\mathbb{Z},X}^{\bullet},d')$ has a canonical dga structure, 
and thus its hypercohomology 
$\mb{H}^{\bullet}(X;\mcal{F}_{\mathbb{Z},X}^{\bullet})$ is a 
graded-commutative algebra. 
This is a certain tropical analog of the singular cohomology
$H^{\bullet}(X;\C)$ for a complex manifold $X$ since 
the analytic de Rham theorem $\C_X \simeq \Omega_X^{\bullet}$ 
gives isomorphism 
$H^{\bullet}(X;\C)\simeq \mb{H}^{\bullet}(X;\Omega_X^{\bullet})$
of graded algebras. 

An elementary but remarkable fact of 
$(\mcal{F}_{\mathbb{Z},X}^{\bullet},d')$ is that 
$\mcal{F}_{\mathbb{Z},X}^{\bullet}\simeq 
\bigoplus_{i\in \Z}\mcal{F}_{\mathbb{Z},X}^{i}[-i]$, i.e., the differential 
of $\mcal{F}_{B}^{\bullet}$ is trivial unlike the analytic de Rham complex
of complex manifolds, see \cite[Corollary 2.15]{smacka2017differential}.
Therefore, we can calculate the multiplication of 
$\mb{H}^{\bullet}(X;\mcal{F}_{\mathbb{Z},X}^{\bullet})$ by 
cup product of each $H^{q}(X;\mcal{F}_{\mathbb{Z},X}^{p})$ easily.

Let $f\colon X\to Y$ be a morphism of rational polyhedral 
space. Then, this induces a canonical morphism
\begin{align}
b_f^{p}\colon \mathcal{F}^{p}_{\mathbb{Z},Y}\to 
f_* \mathcal{F}^{p}_{\mathbb{Z},X} \to
Rf_*\mathcal{F}^{p}_{\mathbb{Z},X}
\end{align}
for all $p\in \mathbb{Z}_{\geq 0}$ and the pullback 
$f^{*}\colon 
\mb{H}^{\bullet}(Y;\mcal{F}_{\Z, Y}^{\bullet})\to 
\mb{H}^{\bullet}(X;\mcal{F}_{\Z, X}^{\bullet})$
\cite[Proposition 4.17]{gross2019sheaftheoretic}.
The pullback $f^{*}$ is a graded ring homomorphism. 

The canonical monomorphism $\mcal{O}^{\times}_X \to \mcal{A}^{0,0}_X$
induces the following commutative diagram 
\myfootnote{Several similar diagrams for some special tropical spaces 
and similar spaces appear
in literature, e.g. \cite[p.468]{MR2567952}
and \cite[Definition 1.45]{grossMirrorSymmetryLogarithmic2006a}.}:

\begin{equation} \label{equation-smooth-cartier-diagram}
  \begin{tikzcd}
    & 0 \arrow[d]    & 0 \arrow[d]           &                      &   \\
    & \mb{R}_{X} \arrow[r,equal] \arrow[d]   & \mb{R}_{X} \arrow[d]\\
0\arrow[r] & \mathcal{O}_X^{\times} \arrow[r] \arrow[d] &
\mcal{A}^{0,0}_X \arrow[r] \arrow[d] & \mcal{A}^{0,0}_X /\mcal{O}_{X}^{\times}  \arrow[r] \arrow[d,equal] & 0 \\
    0 \arrow[r] & 
\mathcal{F}_{\mathbb{Z},X}^{1} \arrow[r] \arrow[d] & 
\mcal{Z}^{1}_{X} \arrow[r] \arrow[d]  & \mcal{Z}^{1}_{X}/
\mathcal{F}_{\mathbb{Z},X}^{1} \arrow[r]   & 0 \\
    & 0 & 0 &  &
  \end{tikzcd}
\end{equation}
Here $\mcal{Z}^{q}_{X}\deq
  \opn{Ker}(d'': \mcal{A}^{0,q}_X\to \mcal{A}^{0,q+1}_X)$.
Every row and column of the diagram (\ref{equation-smooth-cartier-diagram}) is exact
and $\mcal{A}_{X}^{0,0}/\mcal{O}^{\times}_X
  \simeq \mcal{Z}^{1}_X/\mcal{F}_{\Z,X}^{1}$ from the snake lemma.
The left column short exact sequence of 
\cref{equation-smooth-cartier-diagram} is called
the 
\emph{tropical exponential sequence}
(e.g. \cite{MR3894860}).

By taking the long exact sequence for 
\cref{equation-smooth-cartier-diagram}, we get a canonical morphism:
\begin{align} \label{equation-tropical-cartier}
c_1\colon \opn{CaDiv}^{\infty}(X)\to \opn{Pic}(X)\to 
H^{1}(X;\mathcal{F}_{\mathbb{Z},X}^{1}); s\mapsto [s] 
\mapsto c_1([s]).
\end{align}
The second morphism of (\ref{equation-tropical-cartier}) is 
called the Chern class map of 
$\opn{Pic}(X)$ in \cite[5]{mikhalkinTropicalCurvesTheir2008a}.
Let $f\colon X\to Y$ be a morphism of 
two rational polyhedral spaces.
From definition of morphism of rational polyhedral space
and a naturally induced morphism of superforms 
\cite[Lemma 2.21]{MR3903579},
$f$ induces the pullback 
$f^{*}\colon \opn{CaDiv}^{\infty}(Y)\to \opn{CaDiv}^{\infty}(X)$ 
and $c_1(f^{*}s)=f^{*}(c_1(s))$ from the diagram
(\ref{equation-smooth-cartier-diagram}). 
In particular, we have
$c_1(f^{*}(s)^{n})=f^{*}(c_1(s)^{n})$ for every 
$D\in\opn{CaDiv}^{\infty}(Y)$
by \cite[Proposition 4.17]{gross2019sheaftheoretic}.

\subsection{Verdier duality and Borel--Moore homology
for tropical spaces}
In this subsection, we recall Verdier duality for
tropical manifolds.
See \cref{section-verdier-dual} if you do not familiar 
with Verdier duality.
Every rational polyhedral space $X$ is locally compact, 
and thus we can use Verdier duality of tropical spaces.
We set $H^{p,q}(X;\mathbb{Z})\deq 
H^{q}(X;\mathcal{F}_{\mathbb{Z},X}^{p})$. 
Let $\upomega_X^{\bullet}$ be the dualizing complex 
of $D^{b}(\mathbb{Z}_X)$.
The $(p,q)$-th Borel--Moore homology of $X$ is
\begin{align}
H^{\opn{BM}}_{p,q}(X;\Z)\deq 
H^{-q}R\opn{Hom}(\mathcal{F}_{\mathbb{Z},X}^{p},\upomega_X^{\bullet})\simeq 
\opn{Hom}_{D^{b}(\mathbb{Z}_X)}(\mathcal{F}_{\mathbb{Z},X}^{p}[q],\upomega_X^{\bullet}).
\end{align}
$H_{0,q}^{\opn{BM}}(X;\Z)=
H^{-q}R\opn{Hom}(A_X,\upomega_X^{\bullet})$ 
is equal to the classical $p$-th Borel--Moore homology
\cite[Lemma 4.8]{gross2019sheaftheoretic}.
We note $H_{0,0}^{\opn{BM}}(X;\mathbb{Z})\simeq 
 \mathbb{Z}$ if 
$X$ is compact and path-connected.
The isomorphism follows from the universal 
coefficient theorem and 
$H^{1}_c(X;\mathbb{Z})$ is finitely generated and
torsion-free 
\cite[VI.Proposition 5.3]{iversenCohomologySheaves1986a}.

Let $f$ be a proper morphism of rational polyhedral 
spaces.
Then, there exists the pushforward
$f_*\colon H_{p,q}^{\mathrm{BM}}(X;\mathbb{Z})
\to H_{p,q}^{\mathrm{BM}}(Y;\mathbb{Z})$
of tropical Borel--Moore homology 
\cite[Definition 4.9]{gross2019sheaftheoretic}:
\begin{align}
f_*(\psi)\deq \opn{Tr}_{f,\upomega_Y^{\bullet}}\circ 
Rf_!\psi \circ b_{f}^{p}[q]\in 
\opn{Hom}_{D^{b}(\mathbb{Z}_X)}(
\mathcal{F}^{p}_{\mathbb{Z},Y}[q],\upomega_Y^{\bullet}).
\end{align}

\begin{example}

If $p=0$, $q=0$ and $f=a_X$, 
then $b^{0}_{a_X}$ is just a counit for 
the adjoint $a^{-1}_X\dashv Ra_{X*}$.
Therefore, we can identify
$a_{X*}\colon H_{\opn{BM}}^{0,0}(X;\mathbb{Z})
\to H_{\opn{BM}}^{0,0}(\{\opn{pt}\};\mathbb{Z})$
with $\opn{Hom}_{D(\mathbb{Z})}(\mathbb{Z},\opn{Tr}_{a_X,\mathbb{Z}})$
by the adjoint isomorphism
$\opn{Hom}_{D(\mathbb{Z}_X)}(a_X^{-1}\mathbb{Z},
\upomega_X^{\bullet})\simeq 
\opn{Hom}_{D(\mathbb{Z})}(\mathbb{Z},Ra_{X*}\upomega_X^{\bullet})$
if $a_X$ is proper.

\end{example}

Let $f\colon X\to Y$, $g\colon Y\to Z$ be a proper 
morphism of rational polyhedral spaces.
Then, $f_*\circ g_*=(f\circ g)_*$ from 
\cref{equation-trace}.

Tropical cohomology and tropical Borel--Moore homology 
also have cap product 
\cite[\textsection 4.6]{gross2019sheaftheoretic}:
\begin{align}
\cdot \frown \cdot \colon
H^{i,j}(X;\mathbb{Z}) \times 
H_{p,q}^{\mathrm{BM}}(X;\mathbb{Z})\to 
H_{p-i,q-j}^{\mathrm{BM}}(X;\mathbb{Z});(c,\alpha) 
\mapsto c\frown \alpha.
\end{align}

If $p=i$ and $q=j$, then the cap product $c\frown \alpha$ 
is just the composition $\alpha \circ c$ of 
morphisms:
\begin{align} \label{equation-composition-cap}
\cdot \frown \cdot =\cdot \circ \cdot \colon
\opn{Hom}_{D^{b}(\mathbb{Z}_X)}(
\mathbb{Z}_X,\mathcal{F}^{p}_{\mathbb{Z},X}[q])\times
\opn{Hom}_{D^{b}(\mathbb{Z}_X)}
(\mathcal{F}^{p}_{\mathbb{Z},X}[q],\upomega_X^{\bullet})
\to 
\opn{Hom}_{D^{b}(\mathbb{Z}_X)}(\mathbb{Z}_X,
\upomega_X^{\bullet}).
\end{align}

Let $f\colon X \to Y $ be a proper morphism of 
rational polyhedral spaces.
Then, there exists the projective formula 
for $\alpha\in H_{p,q}^{\mathrm{BM}}(X)$
and $c\in H^{i,j}(Y)$ 
\cite[Proposition 4.18]{gross2019sheaftheoretic}:
\begin{align}
  f_*(f^{*}c\frown \alpha)=
c\frown f_*\alpha\in H_{p-i,q-j}^{\opn{BM}}(Y).
\end{align}



Let $X$ be a compact
purely $n$-dimensional tropical manifold.
Then, there exists the following natural isomorphism, 
which is called the Poincar\'e--Verdier duality 
\cite[Theorem 6.2]{gross2019sheaftheoretic}:
\begin{align}
\opn{PVD}^{(n-p)}_X\colon \mathcal{F}_{\mathbb{Z},X}^{n-p}[n]
\simeq 
\mathcal{D}_{\mathbb{Z}_X}(\mathcal{F}_{\mathbb{Z},X}^{p}).
\end{align}
where $\mathcal{D}_{\mathbb{Z}_X}(\mathcal{F}^{\bullet})
\deq R\mathcal{H}om_{\mathbb{Z}_X}(\mathcal{F}^{\bullet}
,\upomega^{\bullet}_X)$ for 
$\mathcal{F}^{\bullet}\in D^{b}(\mathbb{Z}_X)$.
The Poincar\'e--Verdier duality and the 
Hom-tensor adjoint induce
the following isomorphism.
\begin{align}
H^{n-p,n-q}(X;\mathbb{Z})=
R^{0}\opn{Hom}(\mathbb{Z}_X,
\mathcal{F}_{\mathbb{Z},X}^{n-p}[n-q])\simeq 
R^{0}\opn{Hom}(\mathcal{F}_{\mathbb{Z},X}^{p}[q],
\upomega_{X}^{\bullet})=
H_{p,q}^{\mathrm{BM}}(X;\mathbb{Z}).
\end{align}
This is the Poincar\'e duality
for tropical manifolds 
\cite[Corollary 6.3]{gross2019sheaftheoretic}.
The Poincar\'e duality for tropical manifold
with coefficients in $\mathbb{Z}$ was firstly 
proved in \cite[Theorem 5.3]{MR3894860}
under a slight technical assumption.


We recall the constrcution 
of $\opn{PVD}^{(n)}_X$ in \cite{gross2019sheaftheoretic}.
Let $\mathscr{Z}_n^{X}$ be the sheaf of tropical 
$n$-cycles \cite[Definition 3.5]{gross2019sheaftheoretic}
on a pure $n$-dimensional tropical manifold $X$ and 
$\mathcal{H}^{n}_X$ the $n$-th 
homology sheaf \cite[Definition 4.6]{gross2019sheaftheoretic}.
Then, there exists the following isomorphism:
\begin{align}
\mathbb{Z}_X \simeq\mathscr{Z}_n^{X}\simeq 
\mathcal{H}om(\mathcal{F}^{n}_{\mathbb{Z},X},
\mathcal{H}^{n}_X).
\end{align}
The first isomorphism comes from \cite[Lemma 2.4]{MR3041763} and
the second isomorphism is true for $n$-dimensional rational polyhedral 
spaces \cite[Proposition 5.1]{gross2019sheaftheoretic}.
The constant function
$1_{\opn{reg}}\colon X_{\opn{reg}} \to \mathbb{Z}; 
x\mapsto 1$ defines a generator of 
$Z_n(X)=\Gamma(X;\mathscr{Z}_n^{X})\simeq 
\opn{Hom}(\mathcal{F}^{n}_{\mathbb{Z},X},
\mathcal{H}^{n}_X)\simeq 
\opn{Hom}_{D^{b}(X)}(\mathcal{F}^{n}_{\mathbb{Z},X}[n],
\upomega_X^{\bullet})$ if $X$ is connected.
In particular, $1_{X_{\opn{reg}}}$ defines a 
natural morphism 
$\mathcal{F}^{n}_{\mathbb{Z},X}[n]\to \mathcal{H}^{n}_X[n] 
\to \upomega_X^{\bullet}$.
This morphism is just $\opn{PVD}^{(n)}_X$.
We call $[X]\deq \opn{PVD}_X^{(n)}$
the \emph{fundamental class} of $X$.
(We omit to prove that the fundamental class in this 
paper is equal to that of 
\cite[Definition 4.8]{MR3894860}.)
We stress that every fundamental class of an integral affine 
manifold (as tropical manifold) 
is determined without the data of orientation
like that of complex manifolds.

If $X$ is compact, then $a_{X}$ is proper. 
In this case,
we can define the \emph{trace map} 
on tropical cohomology like complex manifolds 
(e.g. \cite[Example 13.A.3]{MR2810322}):
\begin{align} 
\label{equation-trace-integration}
\int_X \colon H^{\bullet,*}(X;\mathbb{Z})\to 
H_{0,0}^{\opn{BM}}(\{\opn{pt}\};\mathbb{Z})\simeq 
\mathbb{Z}; \alpha \mapsto a_{X*}(\alpha \frown [X]).
\end{align}

The fundamental class $[X]$ of a connected compact
tropical manifold is a generator of 
$H_{n,n}^{\opn{BM}}(X;\mathbb{Z})$, and thus we 
can define the degree of a proper morphism.
\begin{definition}[{cf. \cite[Definition 2.11]{MR3668972}}]
Let $f\colon X \to Y$ be a proper morphism of 
$n$-dimensional compact tropical manifolds.
The (tropical) degree $\opn{deg}_{\opn{trop}}(f)$ of $f$ is the integer $m$
such that $f_*([X])=m[Y]$. 
\end{definition}
We write $\opn{deg}_{\opn{trop}}(f)$ by $\opn{deg}(f)$
for simplicity.
From projection formula, every element 
$c\in H^{n,n}(Y;\mathbb{Z})$ have the following equation:
\begin{align}
\int_{X}f^{*}c
=a_{Y*}(f_*(f^{*}c\frown [X]))
=a_{Y*}(c\frown \opn{deg}(f)[Y])
=\opn{deg}(f)\int_Y c.
\end{align}

\begin{example}
Let $f\colon X\to Y$ be a morphism of 
$n$-dimensional tropical manifolds such that $f$ is a 
covering map of topological degree $m$ and the associated map $d_xf\colon 
T_{x}^{\mathbb{Z}} X\to T_{f(x)}^{\mathbb{Z}}Y$ is 
isomorphic.
Then, $f_*[X]=\opn{cyc}_X(f_*1_{X_{\mathrm{reg}}})
=m[\opn{cyc}_Y(1_{Y_{\mathrm{reg}}})]=m
[Y]$ from the commutative diagram of
tropical cycle maps and the definition of the pushforward
of tropical cycles \cite[Definition 3.6]{gross2019sheaftheoretic}.
In this case, $\opn{deg}(f)=\opn{deg}_{\mathrm{top}}(f)$.
\end{example}

\begin{definition} \label{definition-etale-covering}
Let $f\colon X\to Y$ be a proper morphism 
of tropical manifolds such
that $f$ is a covering map.
$f$ is a \emph{tropical \'etale} covering map 
if $\opn{deg}(f)=\opn{deg}_{\mathrm{top}}(f)$.  
\end{definition}
\begin{remark}
Our condition of \'etale is different from that of 
\cite[Definition 1.1]{grossMirrorSymmetryLogarithmic2006a}
when $X$ and $Y$ are integral affine manifolds.
A typical example of non-\'etale covering map 
in our sense but \'etale on the meaning in 
\cite{grossMirrorSymmetryLogarithmic2006a} is given
from the $n$-th Frobenious endomorphism 
$\opn{Fr}_{n,X}^{\natural}\colon \mathcal{O}_X \to \mathcal{O}_X; f\mapsto nf$ of 
the structure sheaf of tropical manifolds. 
This is a tropical analog of Frobenious morphism of 
schemes in positive characteristic 
(e.g. \cite[IV. Remark 2.4.1]{hartshorneAlgebraicGeometry1977a}). As like classical Frobenious morphism, 
the morphism $\opn{Fr}_{n,X}=(\opn{id}_X,\opn{Fr}_{n,X}^{\natural})$ of semiringed space does 
not induce an endomorphism of tropical manifolds 
(over $\mathbb{T}$), but
there exists the following commutative diagram:
\begin{equation}
\begin{tikzcd}
 (X,\mathcal{O}_X) \arrow[r,"{\opn{Fr}_{n,X}}"] 
\arrow[d,"{a_X}"']
 &   (X,\mathcal{O}_X) \arrow[d,"{a_Y}"] \\
(\{\opn{pt}\},\mathbb{T})
\arrow[r,"{\opn{Fr}_{n,\{\opn{pt}\}}}"]
 & (\{\opn{pt}\},\mathbb{T}).
\end{tikzcd}
\end{equation}
By the base change map $\opn{Fr}_{n,\{\mathrm{pt}\}}$, we get 
a new tropical manifold $X^{(n)}$
and the corresponding morphism 
$\opn{Fr}_{n,X}\colon X^{(n)}\to X$. 
If $X=\mathbb{R}^{d}$, then $X^{(n)}$ is 
isomorphic to $X$ and 
$\opn{Fr}_{n,X}$ corresponds to 
the $n$-th dilation map of $X$.
\end{remark}

\subsection{Sheaf cohomology for integral affine manfiolds}

From now on, we recall the commutative diagram (\ref{equation-smooth-cartier-diagram})
 for integral affine manifolds.
In this case, every sheaf naturally comes 
from symplectic geometry.

Of course, 
$\mcal{A}_{B}^{0,0}=\mcal{C}^{\infty}_{B}$ and
$\mcal{Z}^{1}_{B}$ is the sheaf of 
closed $1$-form on $B$.
We recall the sheaf $\mcal{Z}^{1}_{B}$ can be 
considered as the sheaf 
$\opn{Lag}(T^{*}B)$ of Lagrangian sections 
$s:U \to T^{*}U$ for open set $U \subset B$ 
(see \cite[3.2]{MR1853077} or some standard textbook
of symplectic geometry).
The $\mcal{T}_{\Z,B}^{\vee}$ is isomorphic to
the period lattice of 
$\check{f}_{B}\colon \check{X}(B)\to B$ 
 \cite{duistermaatGlobalActionangleCoordinates1980a}.
Another important thing is that 
$\mcal{Z}^{1}(B)/\mcal{T}_{\Z,B}^{\vee}$
 (resp. $\mcal{C}^{\infty}_{B}(T^{*}B)/\mcal{T}_{\Z,B}^{\vee}$) 
is isomorphic to the sheaf of germs of Lagrangian sections 
(resp. smooth sections) of the Lagrangian torus fibration 
$\check{f}_{B}\colon \check{X}(B)\to B$ 
\cite[(2.7), (2.11)]{duistermaatGlobalActionangleCoordinates1980a}.


Thus, the commutative diagram (\ref{equation-smooth-cartier-diagram}) is written like this 
(e.g. \cite[p.468]{MR2567952}):

\begin{equation} \label{equation-cartier-lagrangian}
  \begin{tikzcd}
    & 0 \arrow[d]    & 0 \arrow[d]           &                      &   \\
    & \mb{R}_{B} \arrow[r,equal] \arrow[d]                & \mb{R}_{B} \arrow[d]           &                      &   \\
    0 \arrow[r] & \mathcal{O}_{B}^{\times} \arrow[r] \arrow[d]         & \mathcal{C}^{\infty}_{B} \arrow[r] \arrow[d] & \mathcal{C}^{\infty}_{B}/\mathcal{O}_{B}^{\times}  \arrow[r] \arrow[d,equal] & 0 \\
    0 \arrow[r] & \mcal{T}_{\Z,B}^{\vee} \arrow[r] \arrow[d] & \opn{Lag}(T^{*}B) \arrow[r] \arrow[d]  & \opn{Lag}(\check{X}(B)) \arrow[r]   & 0 \\
    & 0 & 0 &  &
  \end{tikzcd}
\end{equation}



From the diagram (\ref{equation-cartier-lagrangian}),
we have the following group isomorphism already remarked 
before:

\begin{proposition}
\label{proposition-cartier-lagrangian}
Let $B$ be an integral affine manifold. Then,
\begin{align}
\opn{CDiv}^{\infty}(B)\simeq \Gamma(B;
\opn{Lag}(\check{X}(B)));s\mapsto L_s.
\end{align}
\end{proposition}

In particular, a multi-valued function $K$ of a Hessian 
metric of $B$ induces a $C^{\infty}$-Cartier divisor on $B$
and a Lagrangian submanifold of $\check{X}(B)$.

If two $C^{\infty}$-Cartier divisors $s,s'$ are linearly equivalent, 
i.e., $s-s'=(f)^{\mathrm{sm}}$ for some
$f\in C^{\infty}(B)$, 
then $s$ is the image of an one-time Hamiltonian flow of $s'$
on $\check{X}(B)$
\cite[Exercise 6.65]{MR2567952}.


















\begin{theorem} \label{theorem-MRR-hesse}
Let $B$ be a $n$-dimensional compact 
integral affine manifold with a Hessian form and
$s$ a $C^{\infty}$-Cartier divisor such that its
Lagrangian section $L_s$ intersects 
with the zero section transversely. Then,
  \begin{align} \label{equation-Hesse-RR}
\chi(\opn{LMD}^{\bullet}(B,s))=\frac{1}{n!}\int_{B}c_1(s)^{n}.
  \end{align}
\end{theorem}

\begin{proof}

As mentioned in \cref{remark-compact-hessian},
$B$ is a finite unramified cover of tropical tori $T$.
Fix an \'etale cover $p:T \to B$ of $B$.
If \cref{theorem-MRR-hesse} is true for tropical tori,
then \cref{theorem-MRR-hesse} is also true for compact
integral manifold with a Hessian form from
\cref{proposition-euler-number-etale} for $p$:
\begin{align}
\chi(\opn{LMD}^{\bullet}(B;s))
=\opn{deg}(p)^{-1}\chi(\opn{LMD}^{\bullet}(T;p^{*}(s)))
=\opn{deg}(p)^{-1}\frac{1}{n!}\int_T c_1(p^{*}s)^{n}
=\frac{1}{n!}\int_{B}c_1(s)^{n}.
\end{align}

From now, we assume $B=T$.
Let $s$ be an element of 
$\Gamma(T;\mcal{C}^{\infty}(T)/\mcal{O}_{T}^{\times})\simeq
\Gamma(T;\opn{Lag}(\check{X}(T)))$.

$s$ is linearly equivalent to a Lagrangian section
defined from the differential $dq_s$ of a quadratic polynomial
$q_s$ function on the universal cover $\tilde{T}$ of $T$
(see \cite{mikhalkinTropicalCurvesTheir2008a} or 
\cite[3.3]{MR4229604}).

From an explicit calculation of the ring structure of
$\mathbb{H}^{\bullet}(T;\mathcal{F}_{\mathbb{Z},B}^{\bullet})
\simeq \bigwedge H^{0}(T;\mathcal{F}_{\mathbb{Z},B}^{1})$
(or Sumi's result
\cite[Theorem 47]{MR4229604} and the cycle map), 
we get 
$\frac{1}{n!}\int_{T}c_1(s)^{n}$ is equal to the determinant
of the linear part of $dq_s$. 
The intersection number of Lagrangian
section $L_s$ and the zero section $L_0$ is equal to
$\chi(\opn{LMD}^{\bullet}(s_0,s))$ up to 
signature.
(The signature only depends on
the choice of 
an orientation of $\check{X}(B)$. 
The definition of the intersection number of smooth 
submanifolds is in \cite[5.2]{MR1336822} or 
\cite[0.4]{griffithsPrinciplesAlgebraicGeometry1994a}.)

Every linearly equivalent 
class is given by a one-time Hamiltonian flow on 
$\check{X}(B)$ by the pullback $\check{\pi}_{B}^{*}(h)$
of a smooth function $h$ on $B$.
We note the one-time flow of submanifold of $\check{X}(B)$ does not change
the homology class in $H^{\bullet}(\check{X}(B);\Z)$ and
the intersection number \cite[5.2.1. Theorem]{MR1336822}.
Therefore, 
$\chi(\opn{LMD}^{\bullet}(T,s))=
\chi(\opn{LMD}^{\bullet}(T,dq_{s}))$.

We can calculate $\chi(\opn{LMD}^{\bullet}(T,s))$ as follows:

(i) If $\det dq_s\ne 0$, $dq_s$ intersects to 
the zero section transversely. We can see that 
$\sharp(L_{dq_s}\cap L_0)=|\det dq_s|$ directly, and thus
we get \cref{equation-Hesse-RR}. 

(ii) If $\det dq=0$, we can choose a smooth vector field
 $v$ on $\check{X}(T)$ such that the one-time flow 
$\phi$ of $v$ make 
$\phi(L_{dq_s})\cap L_0=\emp$. 
Thus, $\chi(\opn{LMD}^{\bullet}(T,s))=0$.
\end{proof}

\begin{proof}[{Proof of \cref{theorem-MRR-hesse-preface}}]
Let $\{(U_i,f_i)\}_{i\in I}$ be a local
data for $s$.
We can deform $s$ with a linearly equivalent to a 
$C^{\infty}$-Cartier divisor $s'$ 
such that $s'$ has a local $C^{\infty}$-Cartier data 
$\{(U_i,\tilde{f}_i)\}_{i\in I}$ satisfying 
$\tilde{f}_i$ is Morse, and 
$f_i(x)=\tilde{f}_i(x)$ for the complement of 
sufficiently small neighborhoods of $s_0\cap s$. 
From \cref{equation-poincare-hopf}, we have
$\chi(\opn{LMD}^{\bullet}(B,s))
=\chi(\opn{LMD}^{\bullet}(B,s'))$.
Therefore, \cref{theorem-MRR-hesse} 
for $s'$ proves \cref{theorem-MRR-hesse-preface}.
\end{proof}



\begin{remark}

According to \cite[5.3]{mikhalkinTropicalGeometryIts2006},
the support of $k$-th Chern class of tropical manifold is 
the $k$-skeleton of it.
We don't know the definition of higher Chern class of tropical manifold $B$ except
$n=1$ or $n=\dim B$ (see \cref{remark-todd-class}).
On the other hand, $\opn{ch}(B)$ should be trivial when $B$ is
an integral affine manifold, since $B=B_{0}$.
Thus, $c_{k}(B)$ should be $1$ except $k=0$, 
i.e., $\opn{td}(B)$ should be $1$. 
On the other hand,
 $\hat{\mcal{A}}(X(B))=\opn{td}(X(B))=1$
since the tangent bundle on $X(B)$ has a flat
structure.
\end{remark}

\begin{remark}
When $s=\vep (f)^{\opn{sm}}$ for a sufficiently small
positive real number $\vep >0$ and 
a Morse function $f$ on $B$, 
$\chi(\opn{LMD}^{\bullet}(B,s))=
\chi_{\opn{top}}(B)=0$ is 
truly a special case of Poincar\'e--Hopf theorem for $B$.
We also note there exists another tropical analog of Poincar\'e--Hopf theorem
  \cite{MR4540954}. This analogue is about tropical Euler characteristic
$\chi_{\opn{trop}}(B)\deq 
\chi(\mb{H}^{\bullet}(B;\mcal{F}_{B}^{\bullet}))$
  but not for topological Euler characteristic $\chi_{\opn{top}}(B)$.
\end{remark}

\begin{remark}[{Kodaira--Thurston surface}]
There exists a complete and compact integral affine manifold
  which has no Hessian form.
As pointed out in \cite[Example 1.14]{grossMirrorSymmetryLogarithmic2006a}
and \cite[p.403]{MR1461965}, there exists an integral affine manifold
$B$ such that
$X(B)$ is a primary Kodaira surface and $X(B)$
and $\check{X}(B)$
are diffeomorphic to a Thurston's example of a symplectic but
not K\"ahler manifold in \cite{MR402764}.
Hence, $X(B)$ is not K\"ahler and $B$ has no
Hessian form since every Hessian form on $B$ induces a 
standard K\"ahler form
on $X(B)$.
We can see explicit calculations of 
$H^{\bullet}(B;\mathcal{F}_{\mathbb{Z},B}^{\bullet})$
for tropical primary Kodaira surfaces in \cite{maehara2023}.
See \cite{MR1422337} for more details about tropical 
primary Kodaira surfaces and 
\cite{MR3079343,MR3894860} for tropical Klein bottles.

\end{remark}

\subsection{Relationship between Floer cohomology
and integral affine manifolds}
\label{section-floer-lmd}

If $B$ is an compact integral affine manifold 
such that $\pi_2(B)=0$, then $\pi_2(\check{X}(B))=0$.
In this case, $\pi_2(\check{X}(B),L_s)=0$ for 
any Lagrangian section of 
$\check{\pi}_{B}\colon \check{X}(B)\to B$
(see \cref{proposition-unobstructed-lagrangian}).
In this case, every 
pseudoholomorphic disk 
$\psi\colon D\to \check{X}(B)$ such that 
$\psi(\partial D)\subset L_s$ has 
the zero symplectic area.
In particular, $L_s$ is 
\emph{tautologically unobstructed} defined in
\cite[(2.50)]{MR3656481}.
Every Lagrangian section
$L_s\xto{i} \check{X}(B)\xto{\check{\pi}_{B}}  B$
induces a homomorphism of 
cohomology 
$H^{\bullet}(B;\mathbb{F}_2)\to 
H^{\bullet}(\check{X}(B);\mathbb{F}_2)
\to 
H^{\bullet}(L_s;\mathbb{F}_2)$.
In particular, 
$i^{*}(\check{\pi}_{B}^{*}(w_2(B)))=w_2(L_s)$ and 
thus any Lagrangian section $L_s$ satisfies the 
condition \cite[(2.54)]{MR3656481}.
Every Lagrangian section $L_s$ has 
a canonical lifting to a Lagrangian 
brane $\mathscr{L}_s$ as describled in 
\cite[5.2]{MR1882331}.
Therefore, every Lagrangian section of 
$\check{f}_B\colon \check{X}(B)\to B$
has a lift to an object of Fukaya category
of $\check{X}(B)$ in the sense of 
\cite{MR4301560}.

We also note about Floer cohomology of 
a pair of Lagrangian sections.
If a pair $(L_s,L_s')$ of Lagrangian sections 
intersects transversally, then the graded 
module of Floer complex of the pair
$(\mathscr{L}_s,\mathscr{L}_{s'})$
(over $\Lambda_{\opn{nov}}^{\mathbb{C}}$) 
is the following:
\begin{align}
\opn{CF}^{\bullet}(\mathscr{L}_s,\mathscr{L}_{s'})
\deq \bigoplus_{p\in L_s\cap L_{s'}}
\Lambda_{\opn{nov}}^{\mathbb{C}}
[-\mu_{(\mathscr{L}_s,\mathscr{L}_{s'})}(p)].
\end{align}
Here, $\mu_{(\mathscr{L}_s,\mathscr{L}_{s'})}(p)$ is 
the Maslov index of the pair 
$(\mathscr{L}_s,\mathscr{L}_{s'})$ at $p$.
In this case, the Maslov index at $p$
is equal to the Morse index of the 
local intersection data $f_{p}$ of 
the $C^{\infty}$-Cartier divisor $s'-s$ at $p$
\cite[Remark 13]{MR1882331}. Therefore, 
if $L_s$ and $L_{s'}$ intersect 
transversally, then there exists the following
isomorphism of graded modules:
\begin{align}
\opn{CF}^{\bullet}(\mathscr{L}_s,\mathscr{L}_{s'};
\Lambda_{\opn{nov}}^{\mathbb{C}})
\simeq 
\opn{LMD}^{\bullet}_{\Lambda_{\opn{nov}}^{\mathbb{C}}}
(s',s).
\end{align}
This isomorphism supports our analog of graded module
of Floer complex is compatible with the classical 
Floer complex.
Therefore, every pair $(L_1,L_2)$ of Lagrangian section
of $B$ has a 
Floer cohomology $\opn{HF}^{\bullet}(\mathscr{L}_1,
\mathscr{L}_2)$, and its Euler 
characteristic is equal to the intersection number 
of $L_1$ and $L_2$ (up to signature). We can 
see this fact from \cite[Remark 13]{MR1882331} directly.

\begin{remark}
\label{remark-markus-conjecture}
The condition $\pi_2(B)=0$ may seem to be technical
and strict, but this condition is 
closely related with a classical conjecture.
The \emph{Markus's conjecture} states every closed
affine manifold is complete (in the sense of $(G,X)$-manifold)
if and only if its orientable double cover 
has a compatible special affine structure 
\cite[p.53]{markus1963cosmological}.
Every integral affine manifold has a double cover of 
a special integral affine manifold and thus 
the universal cover of closed integral affine 
manifold is homeomorphic to a Euclidean space and 
$\pi_{2}(B)=0$ if the Markus conjecture 
is true.
\end{remark}


\section{For more examples}

\subsection{Tropical multidivisors and 
Lagrangian multi-sections}
\label{section-tropical-multi-section}

Let $B$ an integral affine manifold
(with singularities). 
Then, $B$ has 
the notion of Lagrangian multi-section, 
which is a mirror part of some 
vector bundle on $X(B)$. 
Every (unramified) Lagrangian multi-sections 
can be considered as a certain analog of  
tropical multidivisors on a compact tropical
curve \cite[Definition 3.1]{gross2022principal}, 
so we can also define (permissible) 
$C^{\infty}$-Cartier multidivisors
for tropical curves and 
the local Morse data of them naturally, 
and thus we can generalize 
\cref{theorem-MRR-tropical-curve} for 
permissible $C^{\infty}$-Cartier 
multidivisors by
the Riemann--Hurwitz formula for tropical 
curves \cite[Theorem 2.14]{MR2525845}. 


\subsection{K\"unneth-type formula}


In the last section, we mention more examples of 
tropical analog of the Euler number of 
the sheaf cohomology of line bundles.
First, we remark that there exists
a tropical analog of K\"unneth formula for 
local Morse data.

\begin{theorem}[{Thom--Sebastiani Theorem for sheaves \cite[Theorem 1.2.2]{MR2031639}}]
Let $i=1,2$.
Fix locally compact Hausdorff spaces $X_i$ and 
sheaves $\mathcal{F}_i$ on $X_i$.
For continuous functions $f_i\colon X_1 \to\mathbb{R}$,
and closed $S_i$ of $X_i$ contained in $\{f_i=0\}$.
We write $f_1\dot{+} f_2\deq \pi_1^{*}f_1+\pi_2^{*}f_2$
\myfootnote{
We don't use $\boxplus$ and $\oplus$ in place of
$\dot{+}$
to avoid confusion from tropical addition.}
and 
$\mu_{f_i}\mathcal{F}\deq R\Gamma_{\{f_i\geq 0\}}
(\mathcal{F})|_{\{f_i=0\}}$.
If the above data satisfies
the condition of cohomological version of a Milnor 
fibration \cite[Assumption 1.1.1]{MR2031639},
then there exists the following isomorphism 
for $\mcal{F}_1\boxtimes^{L} \mcal{F}_2\deq 
p_1^{*}\mcal{F}_1\otimes^{L}p^{*}_2\mcal{F}_2$;
\begin{align}
    R\Gamma(S_1\times S_2,\mu_{f_1\dot{+}f_2}(\mcal{F}_1\boxtimes^{L} \mcal{F}_2))
    \simeq R\Gamma(S_1,\mu_{f_1}(\mcal{F}_1))
    \otimes^{L}_{A_X}R\Gamma(S_2,\mu_{f_2}(\mcal{F}_2)).
\end{align}

\end{theorem}


\begin{example}
  If $S_1=\set{v},S_2=\set{w}$ and $\mcal{F}_1=\Z_V, \mcal{F}_2=\Z_{W}$,
  the Thom-Sebastiani theorem gives
  a certain K\"unneth formula for
  $\opn{LMD}^{\bullet}(\Z_{V\times W},f_1\dot{+}f_2,(v,w))$:
\begin{align}
\opn{LMD}^{\bullet}(\Z_{V\times W},f_1\dot{+}f_2,(v,w))
&\simeq \opn{LMD}^{\bullet}(\Z_{V},f_1,v)
\otimes_{\Z} \opn{LMD}^{\bullet}(\Z_{W},f_2,w), \quad \\
\opn{ind}_{(v,w)}(f_1\dot{+}f_2)&=\opn{ind}_v(f_1)\cdot 
\opn{ind}_w(f_2).
\end{align}
  From instance, if $f_1(x)=\|\cdot\|_{\mathbb{R}^{n}}^{2}$
  and $f_2(x)=-\|\cdot\|_{\mathbb{R}^{m}}^{2}$, then we have
\begin{align}
    \opn{LMD}^{\bullet}(\Z_{{\mathbb{R}}^{n+m}},f_1\dot{+}f_2,0)
    \simeq \tilde{H}^{\bullet -1}(S^{n-1};\Z)
    \simeq \Z[-\opn{ind}_{\mathrm{Morse}}(f_1\dot{+}f_2,0)]
\end{align}
  where $\opn{ind}_{\mathrm{Morse}}(f,0)$ is the Morse index
  of a Morse function $f$ at the origin.
\end{example}

We don't state a K\"unneth type formula for 
local Morse data for $C^{\infty}$-Cartier
divisors in a fully
general setting, but the following corollary 
is enough for performing that there exists 
a K\"unneth type formula for local Morse data
of $C^{\infty}$-Cartier divisors.

\begin{corollary}[{K\"unneth formula}]
Fix boundaryless compact rational polyhedral spaces $X$ and $Y$.
Let $s$ and $s'$ a permissible $C^{\infty}$-Cartier divisor of $X$ and $Y$ 
satisfying the condition of cohomological version of a Milnor 
fibration \cite[Assumption 1.1.1]{MR2031639} locally.
Then, the induced external tensor product 
$s\boxtimes s'\deq \opn{pr}_X^{*} (s)+\opn{pr}_Y^{*}(s')
\in \opn{CaDiv}^{\infty}(X\times Y)$ is also permissible and
has the following equations:
\begin{align}
\chi(\opn{LMD}^{\bullet}(X\times Y;s\boxtimes s'))=
\chi(\opn{LMD}^{\bullet}(X,s))\chi(\opn{LMD}^{\bullet}(Y,s')).
\end{align}

\end{corollary}
\begin{proof}
Since 
$\opn{SS}(F\boxtimes^{L} G)\subset 
\opn{SS}(F)\times \opn{SS}(G)$
\cite[Proposition 5.4.1]{MR1299726},
$s\boxtimes s'$ is also permissible.

Let $\{(U_v,f_v)\}_{v\in s_0\cap s}$
(resp. $\{(U_w,g_w)\}_{v\in s_0\cap s'}$) is an
intersection data for $s$ (resp. $s'$), 
and $\{(U_{v}\times U_w,f_v\dot{+} g_w)\}_{
(v,w)\in s_0 \cap 
(s\boxtimes s')}$ the 
corresponding intersection data 
for $s\boxtimes s'$.  
We get an isomorphism of graded modules
from sheaf theoretic Thom-Sebastiani theorem for 
$X_1=U_{v}$, $X_2=U_w$, $S_1=\{v\}$, $S_2=\{w\}$,
$f_1= f_v-f_v(v)$ and 
$f_2= f_w-f_w(w)$;
\begin{align}
\opn{LMD}^{\bullet}(X\times Y;s\boxtimes s') 
& =\bigoplus_{(v,w)\in s_0\cap s\boxtimes s'}
(R^{\bullet}_{\{f_v\dot{+} g_w\geq f_v\dot{+} g_w(v,w)\}}
\Z_{U_{v}\times U_w})_{(v,w)} \\
& \simeq \bigoplus_{(v,w)\in s_0\cap s\boxtimes s'}
(R^{\bullet}_{\{f_v\geq f_v(v)\}}\Z_{U_v})_v
\otimes_{\Z} (R^{\bullet}_{\{g_w\geq g_w(w)\}}\Z_{U_w})_w \\
& \simeq
\opn{LMD}^{\bullet}(X;s)\otimes_{\Z} 
\opn{LMD}^{\bullet}(Y;s').
\end{align}

\end{proof}

\begin{remark}
In the proof of the above corollary, we only use
the condition of cohomological version of Milnor fiber. 
Besides, we can find many permissible $C^{\infty}$-Cartier divisors
satisfying the condition, see \cite[p.35]{MR2031639}.  
\end{remark}

As another result, we get a formula
for the $n$-th symmetric product 
$S^{n}X\deq 
(X^{n}/\mathfrak{S}_n,q_*^{\mathfrak{S}_n}\mathcal{O}_{X^{n}}^{\times})$ of 
a rational polyhedral spaces $X$, even though 
the $S^{n}X$ is not a rational polyhedral space. 
Here, $\mathfrak{S}_n$ is the $n$-th permuation group 
and $q_*^{\mathfrak{S}_n}\mathcal{O}_{X^{n}}^{\times}$ the $\mathfrak{S}_n$-invariant 
part of the pushforward $q_* \mathcal{O}_{X^{n}}^{\times}$ for the canonical projection 
$q\colon X^{n}\to X^{n}/\mathfrak{S}_{n}$. In this case, 
we can define the $n$-th symmetric product
$\opn{Sym}^{n}(s)$ of 
$s$ as an element of $H^{0}(X^{n}/\mathfrak{S}_n;
q_*^{\mathfrak{S}_n}\mathcal{A}^{0,0}_{X^{n}}/
q_*^{\mathfrak{S}_n}\mathcal{O}_{X^{n}}^{\times})$
naturally.
We temporaily define $\opn{Sym}^{n}(s)$ is permissible if
the pullback $q^{*} \opn{Sym}^{n}(s)=s^{\boxtimes n}$ is 
permissible. We also define 
$s_0 \cap \opn{Sym}^{n}(s)\deq q_*(s_0\cap s^{\boxtimes n})$ 
and $\opn{LMD}^{\bullet}_{A}(S^{n}X;\opn{Sym}^{n}(s))$ like 
that of $s$.
\begin{corollary}
Let $k$ be a field of characteristic $0$ and $X$ 
a compact boundaryless rational 
polyhedral space
and $s$ an permissible Cartier divisor 
such that $\opn{LMD}^{\bullet}_k(X;s)$ is bounded, 
finitely generated and 
satisfies \cite[Assumption 1.1.1]{MR2031639} locally.
Let $\opn{Sym}^{n}(s)$ be the $n$-th symmetric product of 
$s$ and
$\opn{LMD}^{\bullet}_{k}(S^{n}X;\opn{Sym}^{n}(s))$
the local Morse data of $\opn{Sym}^{n}(s)$.
Then,
\begin{align}
\chi(\opn{LMD}_k^{\bullet}(S^{n}X;\opn{Sym}^{n}(s)))=
\binom{n+\chi(\opn{LMD}_{k}^{\bullet}(X;s))-1
}{n}.
\end{align}

\end{corollary}
\begin{proof} 
Every permutation
$\sigma \colon X^{n}\to X^{n}$ induces a canonical 
automorphism for
$\opn{LMD}^{\bullet}_k(X;s)^{\otimes n}$ via
Thom--Sebastiani formula 
$\opn{LMD}^{\bullet}_k(X;s)^{\otimes n}\simeq 
\opn{LMD}^{\bullet}_k(X^{n};s^{\boxtimes n})$
(see also \cite[Corollary 1.3.1]{MR2031639}). 
From construction,
we can apply Macdonald formula \cite{MR143204} for 
$\opn{LMD}_k^{\bullet}(S^{n}X;\opn{Sym}^{n}(s))$.
Here, we also used the expression 
$\frac{1}{(1-t)^{m}}=\sum_{n=0}^{\infty}\binom{n+m-1}{n}t^{n}$.
\end{proof}

\begin{remark}
The above corollary is an analog of 
\cite[Lemma 5.1]{MR1795551}.
The same logic works for integral affine manifold with
singularities.
\end{remark}








\appendix

\section{Tropical Riemann--Roch theorem and 
its difficulty}
\label{section-tropical-riemann-roch}

Many authors have studied homological algebra of semimodules 
or non-Abelian categories (e.g. 
\cite{MR3051517,MR3211743,MR3939048,https://doi.org/10.48550/arxiv.2202.01573}),
but the theory of sheaf cohomology of 
$\mathbb{T}$-semimodules on tropical spaces 
have been not applied to prove a tropical
analog of HRR or GRR yet.
The difficulty of homological algebra of semimodules
over idempotent semiring relates 
with the difficulty of the formulation of
higher dimensional
Riemann--Roch theorem for tropical varieties.
In fact, current tropical analogs of Riemann--Roch 
theorem is not formulated and proved by 
homological algebra of semimodules.

We recall the tropical Riemann--Roch theorem for tropical curves 
in \cite{gathmannRiemannRochTheoremTropical2008a}. 
The rank $r(D)$ of the linear system of a divisor $D$ 
on tropical curve in 
\cite{gathmannRiemannRochTheoremTropical2008a}
is \emph{not} an invariant of $\mb{T}$-(semi)
modules
\myfootnote{In fact, 
in \cite[Example 6.5]{yoshitomi2011generators} 
the author give a simple example of divisors on 
tropical curves such that 
the rank of a divisor is different even though 
the $\mathbb{T}$-semimodule of the global section of 
tropical line bundle $\mcal{O}_C(D)$ is isomorphic.},
but this is truly one of good analog of classical one 
(see \cite[Lemma 2.4]{MR2448666}).
The rank of linear system is generalized by Cartwright
\cite{MR4131998,MR4251610}.
Cartwright defines an invariant 
$h^{0}(\Delta,D)$ for a divisor on a tropical complex
\cite[Definition 3.1]{MR4251610}.
The $h^{0}(\Delta,D)$ is a certain 
analog of the dimension of
the $0$-th cohomology of a line bundle on algebraic 
variety.
If $\dim \Delta=1$, then $h^{0}(\Delta,D)=r(D)+1$
\cite[Proposition 3.3]{MR4251610}, and thus $h^{0}(\Delta,D)$
is a generalization of $r(D)+1$ for tropical complexes. 
Cartwright conjectured the Riemann--Roch inequality
$h^{0}(\Delta,D)+h^{0}(\Delta,K_{\Delta}-D)\geq 
\frac{D(D-K)}{2}+\chi_{\opn{top}}(\Delta)$
in \cite[Conjecture 3.6]{MR4251610}.
Sumi prove for the inequality for tropical tori and 
tropical toric surfaces \cite{MR4229604,sumi2021riemannroch}
On the other hand, a tropical analog of Riemann--Roch theorem
for higher dimensional tropical manifolds 
(or tropical complexes) is not formulated
since there hasn't been any good definition of 
Euler characteristic of line bundles on tropical 
manifolds as an extension of the above notions yet.

We also note the other dimensions of $\mb{T}$-semimodules 
(which are invariant for $\mb{T}$-semimodules) are defined for 
some authors 
(see for instance 
\cite[Definition 2.3]{mikhalkinTropicalCurvesTheir2008a}
and \cite[p.8]{yoshitomi2011generators}) but 
these dimensions have no tropical analog of 
Riemann--Roch formula like 
\cite{MR2355607,gathmannRiemannRochTheoremTropical2008a}.

\begin{remark} \label{remark-list-tropical-euler}
Here is the list of the reason why the Euler 
characteristic of the structure sheaf of tropical manifold
should be equal to the topological Euler characteristics of it.
{
\setlength{\leftmargini}{22pt}
\begin{enumerate}
\item If $C$ is a compact tropical curve and $D$ 
is the trivial divisor, then the tropical Riemann--Roch 
formula in 
\cite{gathmannRiemannRochTheoremTropical2008a}
says $r(D)-r(K_C-D)=\chi_{\opn{top}}(C)=
\frac{1}{2}\opn{deg}(-K_C)$. 
\item If $S$ is a tropical surface satisfying a certain 
good condition, then there exists the Noether formula
$\chi_{\opn{top}}(S)=\frac{c_1(K_S)^{2} +c_2(S)}{12}$ 
\cite[Theorem 5.1]{shawTropicalSurfaces2015a}.
Cartwright proves Noether's formula for
a good class of $2$-dimensonal tropical complexes
\cite[Proposition 1.3]{cartwright2015combinatorial}. 

\item 
\cite[Corollary 2]{itenbergTropicalHomology2019b} says 
that the Hodge number $h^{p,q}(Z_w)$ of a general fiber $Z_w$ of
a one-parameter family $\mathcal{Z}$ of 
complex projective varieties over a punctured disc which 
has a tropical limit to a smooth projective 
$\mathbb{Q}$-tropical variety $X$, 
is equal to that of tropical homology 
$H_{q}(X;\mathcal{F}_p)$ of it. If $p=0$, then
$h^{0,q}(Z_w)=\dim_{\mathbb{R}}H_{q}(X;\mathbb{R})
=\dim_{\mathbb{R}} H^{q}(X;\mathbb{R})$.
Therefore, $\chi(H^{\bullet}(Z_w;\mathcal{O}_{Z_w}))=
\chi_{\opn{top}}(X)$.
\end{enumerate}
}
\end{remark}

\section{Etc of HMS and SYZ}
\label{appendix-integral-affine-manifold}

\subsection{Integral affine manifold and Floer cohomology}

$T^{*}B/\mathcal{T}^{\vee}_{\mathbb{Z},B}$ has 
a standard symplectic structure induced from that of 
cotangent bundle $T^{*}B$.
We write $\check{X}(B)\deq 
T^{*}B/\mathcal{T}^{\vee}_{\mathbb{Z},B}$
Let $f\colon B\to \mathbb{R}$ be a 
smooth function on a smooth manifold $B$.
$f$ defines a section 
$\sigma_{df}\colon B\to T^{*}B; x\mapsto (x;df(x))$ of 
the cotangent bundle $\pi\colon T^{*}B\to B$.
We note that the intersection number of 
$\sigma_{df}$ and the zero section of the cotangent
bundle is equal to the topological Euler characteristic
of $B$ if $B$ is compact.
If $B$ is an integral affine manifold,
$\sigma_{df}$ induces a section 
$s_{df}\colon B\to T^*B/\Lambda$ of a torus fibration
$\check{\pi}_B\colon T^*B/\Lambda \to B$ via a canonical 
projection $\pi \colon T^*B\to T^*B/\Lambda$.
$T^{*}B$ and $\check{X}(B)\deq T^*B\to T^*B/\Lambda$
has a canonical symplectic structure and
both $\sigma_{df}(B)$ (resp. $s_{df}(B)$) are Lagrangian 
submanifolds of $T^{*}B$ 
(resp. $T^*B/\check{\Lambda}$).





\subsubsection{Semi-flat SYZ mirror pair}

We add some notes about integral affine manifolds $B$,
from \cite[Chapter 6]{MR2567952} and \cite{sepethesis}.

The local system $\mathcal{T}_{\mathbb{Z}, B}$ defines 
 a pair of torus fibration:
\begin{equation} \label{definition-SYZ-torus-fibration}
\begin{tikzcd}%[scale cd=0.9, row sep=scriptsize, column sep=small]
T^{*}B/\mathcal{T}_{\Z , B}^{\vee} =:\hspace{-35pt} 
&\check{X}(B) \arrow[rd,"\check{f}_{B}"'] 
&   & X(B) \arrow[ld,"f_{B}"] 
&\hspace{-35pt} \deq TB/\mathcal{T}_{\Z, B} \\
& &  B & &
\end{tikzcd}.
\end{equation}
In some references, the symbol $\check{X}$ and
$X$ are reversed. 
$\check{X}(B)$ has a canonical symplectic structure 
induced from $T^{*}B$, and each fiber of 
$\check{f}_{B}$ is a Lagrangian torus.
On the other hand, $X(B)$ has a canonical complex
structure induced from $TB$ and integral affine 
structure of $B$.
Since each fiber of the fibrations $f_{B}$ and 
$\check{f}_{B}$ are compact,
$f_{B}$ and $\check{f}_{B}$ are proper maps.
In particular, if $B$ is compact then 
$\check{X}(B)$ and $X(B)$ are compact.

Since integral affine condition is very strict, so 
$X(B)$ (resp. $\check{X}(B)$) is also a special class of complex (resp. symplectic) manifold.

\begin{proposition}

\label{proposition-unobstructed-lagrangian}
Let $B$ be a connected integral affine manifold 
and $L$ a Lagrangian section of 
$\check{\pi}_{B}\colon \check{X}(B)\to B$. 
Then, $\pi_i(B)\simeq \pi_i(\check{X}(B))$ 
for $i\geq 2$.
In particular, 
$\pi_i(B)=\pi_i(\check{X}(B))=0$ if 
$B$ is complete and $\pi_2(B,L_s)=0$ for any image
$L_s$ of 
Lagrangian section of $\check{f}_{B}\colon B \to \check{X}(B)$.
\end{proposition}
\begin{proof}
Let $\widetilde{X}$ be the universal cover of 
a topological space $X$.


We note $\pi_{i}(X,p)\simeq 
\pi_{i}(\widetilde{X},\tilde{p})$ for $i\geq 2$ and 
$\pi_{i}(X\times Y,(p,q))\simeq \pi_i(X,p)
\times \pi_i(Y,q)$. Therefore,
\begin{align}
\pi_{i}(\check{X}(B))\simeq 
\pi_{i}(\widetilde{\check{X}(B)})\simeq 
\pi_{i}(\widetilde{T^{*}B})\simeq 
\pi_{i}(T^{*}\widetilde{B})\simeq 
\pi_{i}(T_p^* B)\times \pi_{i}(\widetilde{B})\simeq 
\pi_{i}(B).
\end{align}
Thus, we have 
$\pi_{i}(B)\simeq \pi_{i}(\check{X}(B))\simeq 
\pi_{i}(X(B))$. 

Let $i\colon L\to \check{X}(B)$ be the inclusion map of 
$L$.
Since $L$ is a section of 
$\check{\pi}_{B}$, 
$i_*\colon \pi_i(L)\to \pi_i(\check{X}(B))$ is 
injective. Therefore, we get 
$\pi_2(\check{X}(B),L)=0$ by considering the long exact
sequence of relative homotopy groups.
\end{proof}

If $B$ is an integral Hessian manifold, 
$X(B)$ and $\check{X}(B)$ have K\"ahler structure 
respectively.
This fact that $X(B)$ is a finite unramified quotient
of a complex torus follows from $\pi_2(X(B))=0$ 
and Bogomolov--Beauville decomposition theorem.
Let $f:B' \to B$ be a finite unramified covering of $B$ such that $B'$ is a tropical torus.

Then, $X(B')$ (resp. $\check{X}(B')$) 
is a complex torus and an unramified finite cover 
of $X(B)$ (resp. $\check{X}(B)$). 

\section{Radiance obstruction and geometric prequantization}
\label{sec: BSRR}
\label{appendix-geometric-quantization}

In this subsection, we recall the relationships lattice points of 
strongly integral affine manifolds and geometric quantization 
from \cite{1999math......2027T,MR3525095}.

A symplectic manifold $(M,\omega)$ is 
\emph{prequantizable}
if the de Rham cohomology class $[\omega]$ of $\omega$ is in $H^2(X;\Z)$. 
An integral affine manifold $B$ has a strongly integral affine structure 
if and only if the de Rham cohomology class of 
$\omega_{\opn{std}}(\in \check{X}(B))$ is in 
$H^{2}(\check{X}(B);\mathbb{Z})$
(see for example 
\cite[Lemma 2.8]{MR4275791}).

From the theory of connection on a vector bundle,
 there exists a complex line bundle $\mcal{L}$ with a $U(1)$-connection $\nabla$ and $R_{\nabla}=-2\pi\sqrt{-1}\omega$.  
Such pair $(\mcal{L},\nabla)$ is called 
\emph{prequantum line bundle} over $M$. 
Obviously, $c_1(\mcal{L})=[\omega]$.
Let $L$ be a Lagrangian submanifold of $(M,\omega)$.
Then, $\nabla|_{L}$ is a flat $U(1)$-connection from definition.
$L$ is a 
\emph{Bohr--Sommerfeld orbit} 
(BS-orbit for short)
if $\nabla|_{L}$ is a trivial connection on $L$. Let $\pi :M\to B$ be a Lagrangian fibration. 
A point $x\in B$ is 
\emph{Bohr--Sommerfeld point} 
if $\pi^{-1}(x)$ is a Bohr-Sommerfeld orbit.

The origin of Bohr--Sommerfeld orbit comes from
Old Quantum Theory.
See also \cite[15.2, Chapter 22]{MR3112817}
and \cite[Remark 4.3]{MR1270931} for physical meaning 
of BS-orbits.





If $B$ is a strongly integral affine manifold,
we can define the set of lattice points $B(\Z)$ 
on $B$ for a fixed strongly integral affine structure from 
the inverse image $\phi^{-1}_i(U_i\cap M)$ of each atlas.
In other words, we can define 
`$\underline{\Z}$-rational points' of $B$.
Here, the $\underline{\Z}$ is the max-plus semifield of 
extended integers,
see also \cref{equation-rational-point}.


We can create a canonical section 
$s_{B}\colon B \to X(B)$ of the torus fibration
 $\pi_B:X(B)\to B$
induced from the graph of the composition map of developing map
$\opn{dev}_{B}\colon \widetilde{B}\to M_{{\mathbb{R}}}$ 
\cite[p.641]{goldmanRadianceObstructionParallel1984a} and projection
$p:M_{{\mathbb{R}}}\to M_{{\mathbb{R}}}/M$. 
Then, we can consider $B(\Z)$ as the intersection of 
$s_{B}$ and the zero section of 
$\pi_{B}:X(B)\to B$;
\begin{align}
\label{equation-bohr-sommerfeld-riemann-roch}
B(\mathbb{Z})=\pi_{B}(s_0\cap s_{B})
=\{p\in B \mid  \check{\pi}_{B}^{-1}(p) 
\text{ is a BS-orbit}\}.
\end{align}
This construction is a certain dual of semi-flat SYZ 
transformation 
(see \cite[Theorem 1.1]{MR1876073} or \cite[\textsection 9.1]{MR1882331}). 
The following equation is firstly proved in 
\cite[Corollary 4.1]{MR1461965} as a corollary of 
the index formula for reducible non-negative polarizations:
\begin{align} \label{equation-lattice-index}
\sharp (B(\Z))=\sharp (s_0\cap s_{B})
=\opn{vol}(\check{X}(B))=\opn{vol}(B)
=\int_{\check{X}(B)}\opn{ch}(\mathcal{L})\hat{\mathcal{A}}(T(\check{X}(B))).
\end{align}

This equation is reproved in \cite{MR2676658} as a 
corollary of the theory of localization of the 
index of a Dirac type operator.
The comparison of LHS and RHS of 
\cref{equation-lattice-index} for
Calabi--Yau manifolds is studied in 
\cite{1999math......2027T} under 
the name of the \emph{numerical quantization problem}.

\cref{equation-lattice-index} can be considered
as a numerical version of \cref{equation-hf-sheaf-cohomology} 
when $B$ has a Hessian form.
If $B$ has a Hessian form, then $s_{B}$ can be 
considered as a Lagrangian section of the dual torus 
fibration $\pi_{\check{B}}\colon 
\check{X}(\check{B})\to \check{B}$ of dual Hessian
manifold $\check{B}$ \cite[Proposition 6.9]{MR2567952}.
A similar result exists for projective toric manifolds 
and their prequantum line bundle 
\cite[Theorem 3.20]{yamaguchimaster}.  
These observations was developed for 
(simple) integral affine manifolds with singularities
$B$ and the associated toric degenerations 
by Gross and Siebert. 
Gross and Siebert conjectured 
that the set $B(\mathbb{Z})$ of integer points of 
$B$ forms a canonical basis of the global section a 
relatively ample line bundle of a toric 
degeneration of Calabi--Yau manifolds
\cite[Conjecture 1.6]{MR3525095}.
We also mention that the numerical quantization problem 
is developed by several other perspectives
(e.g. \cite{MR2879247,
https://doi.org/10.48550/arxiv.1904.04076}).









\section{Verdier duality} 
\label{section-verdier-dual}
%TODO: Verdier 双対のまとめ
In this subsection, we recall Verdier duality which 
uses in \cref{section-integral-affine-manifold}
from \cite[Chapter 3]{MR1299726}.

\begin{theorem}[{Verdier duality}]
\label{theorem-relative-verdier}
Let $f\colon X\to Y$ be a continuous map between locally 
compact Hausdorff space s. If $f_!$ has finite cohomological
dimension, then
\begin{align}
R\opn{Hom}_{A_Y}(R f_!\mcal{F}^{\bullet},\mcal{G}^{\bullet})    & \simeq R\opn{Hom}_{A_X}(\mcal{F}^{\bullet},f^{!}\mcal{G}^{\bullet}),        \\
R \mcal{H}om_{A_Y}(R f_! \mcal{F}^{\bullet},\mcal{G}^{\bullet}) & \simeq Rf_* R\mcal{H}om_{A_X}(\mcal{F}^{\bullet},f^{!}\mcal{G}^{\bullet}).
\end{align}
\end{theorem}
The proof of \cref{theorem-relative-verdier} is in 
\cite[Proposition 3.1.10]{MR1299726}.
The \emph{dualizing complex} over $A$ of $X$ is 
$\upomega_{A_X}^{\bullet}\deq a^{!}_{X}A_{\{\opn{pt}\}}$.
For simplicity, we write 
$\upomega_X^{\bullet}\deq 
\upomega_{\mathbb{Z}_X}^{\bullet}$.

\begin{example}
If $X$ is a topological manifold of dimension $n$, 
$\upomega^{\bullet}_{X}\simeq \opn{or}_{X}^{\Z}[n]$ 
where $\opn{or}_{X}^{\mathbb{Z}}[n]$ is the sheaf 
associated with the presheaf $U\mapsto 
\opn{Hom}(H^{n}_c(U;\mathbb{Z}_{X}),\mathbb{Z})$
\cite[Proposition 3.3.6]{MR1299726}.
\end{example}

The complex $\mathcal{D}_{A_X}(\mathcal{F}^{\bullet})
\deq R\mathcal{H}om_{A_X}(\mathcal{F}^{\bullet},
\upomega_{A_X}^{\bullet})$ 
is called the \emph{Verdier dual} of 
$\mathcal{F}^{\bullet}$.

The dual functor
$\mathcal{D}_{A_X}\colon 
\opn{D}^{b}(\catn{Mod}(A_X))\to 
\opn{D}^{b}(\catn{Mod}(A_X)); \mathcal{F}^{\bullet} \to  R\mathcal{H}om_{A_X}(\mathcal{F}^{\bullet},
\upomega_{A_X}^{\bullet})$
has the following canonical isomorphism when 
$\mathcal{D}_{A_X}(\mathcal{D}_{A_X}(\mathcal{G}^{\bullet}))
\simeq \mathcal{G}^{\bullet}$ by the hom-tensor adjoint
\cite[Proposition 2.6.3]{MR1299726}:
\begin{align}
R\mathcal{H}om_{A_X}
(\mathcal{D}_{A_X}(\mathcal{G}^{\bullet}),
\mathcal{D}_{A_X}(\mathcal{F}^{\bullet})) 
& \simeq R\mathcal{H}om_{A_X}
(\mathcal{F}^{\bullet}\otimes^{L}_{A_X}
\mathcal{D}_{A_X}(\mathcal{G}^{\bullet}),
\upomega_{A_X}^{\bullet}) \\
& \simeq R\mathcal{H}om_{A_X}
(\mathcal{F}^{\bullet},
\mathcal{D}_{A_X}(\mathcal{D}_{A_X}(\mathcal{G}^{\bullet}))) \\
& \simeq R\mathcal{H}om_{A_X}
(\mathcal{F}^{\bullet},
\mathcal{G}^{\bullet}).
\end{align}




The pairs of adjoint functors $Rf_! \dashv f^{!}$ 
induces the \emph{trace map} $\opn{Tr}_{f,\mathcal{F}^{\bullet}}\colon Rf_!f^{!}\mathcal{F}^{\bullet}
\to \mathcal{F}^{\bullet}$ for each 
$\mathcal{F}^{\bullet}\in \opn{Ob}(\opn{D}^{b}(A_X))$.
We follow the notation $\opn{Tr}_f$ from 
\cite[p.20]{MR1299726}.
Let $f\colon X\to Y $ and $g\colon Y\to Z$ be 
a continuous map and $f_!,g_!$ has finite cohomological 
dimension. Then, $(g\circ f)^{!}=f^{!}\circ g^{!}$
\cite[Proposition 3.1.8]{MR1299726}.
In particular, $\upomega_X=f^{!}\upomega_Y$.
From elemental properties of the composition of
adjoint functors \cite[p.103]{MR1712872}, we have
\begin{align}
\label{equation-trace}
\opn{Tr}_{g\circ f,\mathcal{F}^{\bullet}}=
\opn{Tr}_{g,\mathcal{F}^{\bullet}} 
\circ Rg_!(\opn{Tr}_{f,g^{!}(\mathcal{F}^{\bullet})}).
\end{align}
By the global section functor with compact support and
\cref{equation-trace}, we have
\begin{align}
\label{equation-trace-push}
Ra_{Z!}(\opn{Tr}_{g\circ f,\upomega_{Z}^{\bullet}})
=Ra_{Z!}(\opn{Tr}_{g,\upomega_{Z}^{\bullet}})
\circ Ra_{Y!}(\opn{Tr}_{f,\upomega_{Y}^{\bullet}}).
\end{align}

%TODO: lineality空間の話とweakly-smoothの話を書く。

\section{Lattice polytopes and local Morse data}
\label{section-toric-geometry}
In this section, we will see relationships 
between lattice polytopes and tropical toric
varieties via local Morse data
(\cref{proposition-ehrhart-revisit}). 
For simplicity, we only consider them for 
tropical toric manifolds, i.e., 
smooth tropical toric varieties.

Before explaining about it, we recall some 
elemental properties of projective toric varieties 
from \cite{MR2810322}.
Let $P$ be a $n$-dimensional lattice polytope in 
$\mathbb{R}^{n}$, $X_P$ the projective toric variety
of $P$, $\mathcal{L}_P$ the line bundle on 
$X_P$ of $P$.
The sheaf cohomology of $\mathcal{L}_P$ has 
the following explicit isomorphisms:
\begin{align}
H^{\bullet}(X_P;\mathcal{L}_P)&=
H^{0}(X_P;\mathcal{L}_P)\simeq
\bigoplus_{u\in P\cap \mathbb{Z}^{n}} \mathbb{C}z^{u},
\label{equation-danilov-formula} \\
H^{\bullet}(X_P;\mathcal{L}_P^{\vee})&=
H^{n}(X_P;\mathcal{L}_P^{\vee})\simeq 
\bigoplus_{u\in \opn{int}(P)\cap \mathbb{Z}^{n}}\mathbb{C}z^{u}.
\end{align}
Besides, there exists a polynomial
$\opn{Ehr}_P\in \mathbb{Q}[x]$ such that the following 
equations hold
\begin{align} \label{equation-ehrhart-reciprocity-1}
\chi(H^{\bullet}(X;\mathcal{L}_P^{\otimes l}))
&=\opn{Ehr}_P(l)
=\sharp (lP\cap \mathbb{Z}^{n}), \\
\label{equation-ehrhart-reciprocity-2}
\chi(H^{\bullet}(X;(\mathcal{L}_P^{\vee})^{\otimes l}))
&=\opn{Ehr}_P(-l)=
\sharp (\opn{int}(lP)\cap \mathbb{Z}^{n})
\end{align}
for all $l\in \mathbb{Z}$.
\cref{equation-ehrhart-reciprocity-1,equation-ehrhart-reciprocity-2} 
are called the \emph{Ehrhart reciprocity law}. 
The proof of the law is in \cite[Theorem 9.4.2]{MR2810322},
for instance.
We also note \cref{equation-danilov-formula} 
has a differential geometrical interpretation,
see also \cref{appendix-geometric-quantization}. 


Next, we recall elementary facts about topical 
toric varieties.
Basic concepts and properties 
of tropical toric varieties is studied and 
explained in 
\cite{MR2428356,MR2511632,meyer2011intersection,MR3287221,MR4016643}.
In this section, $k$ means a ground semifield.
We set
\begin{align}
N\deq \mathbb{Z}^{n},& \quad
N_{k}\deq 
\mathbb{Z}^{n}\otimes_{\mathbb{Z}}k^{\times}\simeq 
\opn{Hom}_{\mathbb{Z}}(N^{\vee},k^{\times}), \\
M\deq N^{\vee},& \quad 
M_{k}\deq M\otimes_{\mathbb{Z}}k^{\times}.
\end{align}
For instance, if $k$ is a max-plus semifield
$\underline{\mathbb{R}}$, then 
$N_{\underline{\mathbb{R}}}\simeq \mathbb{R}^{n}$.
At first, we can formally define (normal) 
toric varieties over a semifield as like over a 
field. For instance, there exists the following 
adjoint between the category of commutative monoids and 
the category of algebras over $k$:
\begin{align}
\label{equation-rational-point}
\opn{Hom}_{\catn{CMon}}(S_{\sigma},k)=
\opn{Hom}_{\catn{Alg}(k)}(k[S_{\sigma}],k)
\end{align}
where $\sigma$ is a rational convex polyhdeal cone 
in $N_{\underline{\mathbb{R}}}$ and $S_{\sigma}\deq \sigma^{\vee}\cap M$ 
is the monoid associated with the dual cone 
$\sigma^{\vee}$ of $\sigma$ (\cite[p.30]{MR2810322}). 
Therefore, we can define the set of 
$k$-rational points of 
affine toric varieties for $\sigma$ over a semifield 
$k$ formally. By gluing each the set of $k$-rational points of 
affine toric variety, we get the set of $k$-rational points 
in a toric variety $X_{\Sigma}$ for a rational polyhedral fan
$\Sigma$.
If $k$ is a semifield $\mathbb{R}_{\geq 0}$ of 
nonnegative real numbers, then 
$(U_{\sigma})_{\geq 0}\deq \opn{Hom}_{\catn{CMon}}(S_{\sigma},\mathbb{R}_{\geq 0})$
can be considered as the nonnegative part of 
the affine toric variety
$U_{\sigma}\deq \opn{Hom}_{\catn{Alg}(\mathbb{C})}
(\mathbb{C}[S_{\sigma}],\mathbb{C})$ over $\mathbb{C}$
\cite[\textsection 12.2]{MR2810322}
(see also \cite[\textsection 1.3]{MR966447}).

Let $\opn{exp}\colon 
\underline{\mathbb{R}}\to \mathbb{R}_{\geq 0}$ be an 
extension of the exponential map 
$\opn{exp}\colon \mathbb{R}\to \mathbb{R}$ such 
that $\opn{exp}(-\infty)=0$ and 
$\opn{log}\colon \mathbb{R}_{\geq 0} \to 
\underline{\mathbb{R}}$ the inverse of $\opn{exp}$.
These maps are bijective, so they induce 
the following binary operations on 
$\underline{\mathbb{R}}$:
\begin{align}
\label{equation-rational-point-monoid}
x\oplus_{\opn{log}}y\deq 
\opn{log}(\opn{exp}(x)+\opn{exp}(y)),\quad 
x\odot_{\opn{log}}y \deq
\opn{log}(\opn{exp}(x)\cdot\opn{exp}(y))=x+y
\end{align}
The triple 
$\underline{\mathbb{R}}_{\opn{log}}
\deq (\underline{\mathbb{R}},\oplus_{\opn{log}},+)$ forms 
a semifield isomorphic to the semifield 
$(\mathbb{R}_{\geq 0},+,\cdot)$ of nonnegative 
of real numbers.
The semifield $\underline{\mathbb{R}}_{\opn{log}}$ 
is called the \emph{log-semifield} or 
\emph{log-semiring}. $\mathbb{R}_{\opn{log}}$ has a 
topological structure induced from 
$\opn{log}\colon \mathbb{R}_{\geq 0}\to 
\underline{\mathbb{R}}$.
This topological structure induces the topological 
structure for 
$N_{\underline{\mathbb{R}}}$ and this is homeomorphic 
to the $n$-dimensional Euclidean space $\mathbb{R}^{n}$.
The isomorphism 
$\mathbb{R}_{\geq 0}\simeq 
\underline{\mathbb{R}}_{\opn{log}}$
induces the following commutative diagram of 
continuous maps for any continous map 
$h\colon (\mathbb{R}_{> 0})^{n}\to \mathbb{R}_{> 0}$:
\begin{equation}
% https://q.uiver.app/#q=WzAsNCxbMCwwLCIoXFxtYXRoYmJ7Un1fez4gMH0pXntufSJdLFsxLDAsIlxcbWF0aGJie1J9X3s+IDB9Il0sWzAsMSwiXFxtYXRoYmJ7Un1ee259Il0sWzEsMSwiXFxtYXRoYmJ7Un0iXSxbMCwyLCJcXGxvZyIsMl0sWzAsMSwiaCJdLFsxLDMsIlxcbG9nIl0sWzIsMywiXFxsb2cgXFxjaXJjIGhcXGNpcmMgXFxleHAiLDJdXQ==
\begin{tikzcd}
	{(\mathbb{R}_{> 0})^{n}} & {\mathbb{R}_{> 0}} \\
	{\mathbb{R}^{n}} & {\mathbb{R}}
	\arrow["\opn{id}_N\otimes \log"', from=1-1, to=2-1]
	\arrow["h", from=1-1, to=1-2]
	\arrow["\log", from=1-2, to=2-2]
	\arrow["{f}"', from=2-1, to=2-2].
\end{tikzcd}
\end{equation}
where $f\deq \log \circ h\circ (\opn{id}_N \otimes \exp)$.
If $h$ is a $C^{\infty}$-function, so do $f$.
Let $h\in \mathbb{R}_{\geq 0}
[x_{1}^{\pm},\ldots,x_n^{\pm}]\setminus \{0\}$ be 
a nonzero Laurent 
polynomial of $n$-variables over $\mathbb{R}_{\geq 0}$.
The polynomial $h$ induces a positive
$C^{\infty}$-function on 
$(\mathbb{R}_{> 0})^{n}$ naturally.

Let $P$ be an $n$-dimensional convex lattice polytope in
$M_{\underline{R}}=(\mathbb{R}^{n})^{\vee}$ and
$f_P\colon \mathbb{R}^{n} \to \mathbb{R}$ a 
polynomial function over $\underline{\mathbb{R}}$ as follows:
\begin{align}
  f_P(x)\deq\log (\sum_{u\in P\cap (\mathbb{Z}^{n})^{\vee}} 
\opn{exp}(a_u+\abk{u,x})),\quad  (a_u=0 
\text{ for all } u\in P \cap (\mathbb{Z}^{n})^{\vee})
\label{equation-log-polynomial} 
\end{align}
where $\abk{\cdot,\cdot}\colon 
(\mathbb{R}^{n})^{\vee}\times \mathbb{R}^{n}\to\mathbb{R}$
is the canonical pairing of a vector space and its dual.

Let $x_1,\ldots,x_n$ be the standard coordinates of 
$\mathbb{R}^{n}$.
$\mathbb{R}^{n}$ has a canonical integral affine 
structure induced from the standard coordinates 
and the Hessian of $f_P$ induces a Hessian form 
on $\mathbb{R}^{n}$.
The composition of the exact $1$-form
$df_P:{\mathbb{R}}^{n}\to T^{*}({\mathbb{R}}^{n}); x\mapsto 
(x;\frac{\partial f_P}{\partial x_1}(x),\ldots,\frac{\partial f_P}{\partial x_n}(x))$ 
of $f$, and the canonical projection 
$\opn{pr}\colon T^{*}({\mathbb{R}}^{n})\mapsto (\mathbb{R}^n)^{\vee}$
is an embedding onto the (relative) interior of $P$
\cite[p.124 Exercise]{MR1301331}. 
We set $\dot{\mu}_{P}^{\opn{trop}}\deq \opn{pr}\circ df$ 
for simplicity.
This map is also naturally appeared as an 
exponential family in algebraic statistic,
information geometry and Hessian geometry.

We can write down the 
$\dot{\mu}_P^{\opn{trop}}$ as follows:

\begin{align}
  \dot{\mu}_P^{\opn{trop}}(x)= \frac{1}{\sum_{m\in P\cap (\mathbb{Z}^{n})^{\vee}} \opn{exp}(\abk{x,m})}
  \sum_{m\in P\cap (\mathbb{Z}^{n})^{\vee}} \opn{exp}(\abk{x,m})m.
\end{align}

\begin{example}
Let $P=[0,1]$.
Then, $f_P\colon \mathbb{R} \to {\mathbb{R}}; x\mapsto 
\log (1+e^{x})$ be a soft 
plus function. 
The differential is a sigmoid function 
$df(x)=\frac{e^{x}}{1+e^{x}}$ and 
the image of $df$ is the open interval $(0,1)$.
The softmax functions are also appeared 
naturally in a similar way 
when we consider tropical projective spaces.
\end{example}



We can naturally extend $\dot{\mu}_{P}^{\opn{trop}}$ on tropical projective toric 
varieties, and then the extension map is called the \emph{tropical moment map}
$\mu_{P}^{\opn{trop}}: X_{P}^{\opn{trop}}\simto P$ 
\cite[Definition 2.1 (2)]{MR2428356}.
This is a tropical analog of algebraic moment map 
for toric varieties
(see for example
\cite[\textsection 12.2]{MR2810322}).
Instead of the moment map for Hamiltonian action of Lie group on
symplectic manifold, we
need not assume the convex lattice polytope is Delzant.
Let 
$q: ({\mathbb{R}}^{n})^{\vee}\to ({\mathbb{R}}^{n})^{\vee}/(\Z^{n})^{\vee}$ 
a canonical projection map.
We consider the following map
\begin{align}
\dot{s}_P\colon X_{P}^{\mathrm{trop}}\to 
X_{P}^{\mathrm{trop}}\times 
(\mathbb{R}^{n})^{\vee}/(\mathbb{Z}^{n})^{\vee};x\mapsto 
(x,q\circ \mu_{P}^{\mathrm{trop}}(x)).
\end{align}

This is a section of the 
fiber bundle 
$\hat{f}_P\colon X_{P}^{\mathrm{trop}}\times 
(\mathbb{R}^{n})^{\vee}/(\mathbb{Z}^{n})^{\vee}
\to X_{P}^{\mathrm{trop}}$. 
Readers who have read up to this point may feel that
$\dot{s}_P$ look like a `Lagrangian section of
$\hat{f}_P$'.
In fact, $\dot{s}_P|_{\mathbb{R}^{n}}$
is truly a Lagrangian section of the 
Lagrangian torus fibration 
$\check{f}_{\mathbb{R}^{n}}\colon 
\check{X}(\mathbb{R}^{n})\to \mathbb{R}^{n}$.
(A certain dual of $\dot{s}_P$ appears in 
\cite[Theorem 3.20]{yamaguchimaster}.)
Let $0_P$ be the zero section of $\hat{f}_P$. 
Then, the following formula is obvious:
\begin{align}
\label{equation-moment-map-intersection}
\sharp (0_{P}\cap \dot{s}_P)
=\sharp (P \cap (\Z^{n})^{\vee}).
\end{align}
We can see \cref{equation-moment-map-intersection}
is very similar with the intersection number of
two Lagrangian 
sections.

Now, 
let's reinterpret 
Eqs. (\ref{equation-danilov-formula}) -\!
(\ref{equation-ehrhart-reciprocity-2}) and
(\ref{equation-moment-map-intersection})
using the local Morse data for a
$C^{\infty}$-Cartier divisor in this paper.
First, let's construct a
permissible $C^{\infty}$-Cartier divisor on 
$X_{P}^{\mathrm{trop}}$ from a Delzant polytope $P$. 
Every compact tropical toric manifold is not 
boundaryless, so we need to use the sheaf of 
weak smooth functions which we defined 
in \cref{definition-weakly-smooth}.
On the other hand, from \cref{equation-log-polynomial} 
we can construct 
a permissible $C^{\infty}$-Cartier divisor
$s_P\in H^{0}(X_P;
\mathcal{A}^{\mathrm{weak}}_{X_P}/
\mathcal{O}^{\times}_{X_P})$ for 
a given tropical projective toric manifold 
$X_P$ as follows:
{\setlength{\leftmargini}{22pt}
\begin{enumerate}
\item For $m\in P\cap 
(\mathbb{Z}^{n})^{\vee}$, we set $p\deq 
(\mu_{P}^{\mathrm{trop}})^{-1}(m)$ and 
$f_{P,p}\deq f_P-\langle m,x \rangle=f_{P-m}$
where $P-m\deq\set{p-m\in (\mathbb{R}^{n} )^{\vee}\mid p\in P}$.
\item If $p$ is a vertex of $P$
and $\sigma_p$ is the convex cone corresponding 
to $p$, then 
$f_{P,p}$ can be considered as an element of 
$H^{0}(U_{\sigma_p},\mathcal{A}_{X_P}^{\mathrm{weak}})$
naturally since $f_{P,p}\in 
\underline{\mathbb{R}}_{\opn{log}}[S_{\sigma_p}]$
. These data forms a $C^{\infty}$-Cartier 
divisor $s_P$ on $X^{\mathrm{trop}}_P$.
\item Every local cone $\opn{LC}_x X_{P}^{\mathrm{trop}}$
in $X_P^{\mathrm{trop}}$ at $x$ is isomorphic to an 
$\mathbb{R}^{l}$, and thus $s_P$ obviously satisfies 
the permissibility condition.
\end{enumerate}
}
\begin{example} \label{eg: TP1Cartier}
Let $P\deq [0,n]$. Then,
$f_P\colon \mathbb{R}\to \mathbb{R}; 
x\mapsto \opn{log}(\sum_{i=0}^{n}e^{ix})$ and 
$X_P\simeq \mathbb{T}P^{1}$.
$\mathbb{T}P^{1}$ is covered by two open subsets:
$U_{-\infty}\deq \mathbb{T}$ and 
$U_{+\infty}\deq \mb{R}\cup\{+\infty\}$.
Take two continuous functions on each $U_i$ as follows:
\begin{align}
f_{-\infty,n}\colon \mathbb{T}\to \mathbb{T};
x \mapsto \log (\sum_{i=0}^{n}e^{ix}),\quad
f_{+\infty,n}\colon \mb{R}\cup\{+\infty\} \to 
\mathbb{T};
x\mapsto \log(\sum_{i=0}^{n}e^{ix})-nx.
\end{align}

A local data 
$\{(U_i,f_{i,n})\}_{i=-\infty,\infty}$ defines
a $C^{\infty}$-Cartier divisor $s_n$ on $\mathbb{T}P^{1}$.
an element 
$D_n\deq (f_{-\infty,n}-f_{+\infty,n}=nx)\in 
\check{H}^{1}(\mb{T}P^1;\mcal{O}_{\mb{T}P^1}^{\times})\simeq \Z$
as a \v{C}ech cocycle.
Then, we have
\begin{align}
\label{equation-MRR-tropical-line}
\sharp([0,n]\cap \Z)=n+1=
\opn{deg}(\mathcal{L}_{s_n})+\chi_{\opn{top}}(\mb{T}P^1).
\end{align}
\end{example}
Let $P$ a $n$-dimensional Delzant polytope again.
Every face $F$ of $P$ corresponds a convex cone 
$\sigma(F)$ of the normal fan of $P$.
$s_P$ induces a family 
$\{(O(\sigma_F),f_F|_{O(\sigma_F)})\}_{F \prec P}$ of Laurent polynomials 
$f_F$ on each tropical torus orbit $O_{\sigma_F}$
of $\sigma(F)$
naturally up to monomials.
If a point $p\in X^{\mathrm{trop}}_P$ satiesfies 
$\mu_P^{\mathrm{trop}}(p)\in F$ for some a face $F$ of 
$P$, then
$p$ is in 
$s_0\cap s_P$ if and only if 
$df_F(p)\in (\mathbb{Z}^{n})^{\vee}$.
Therefore,
the following equations hold:
\begin{align}
s_0\cap -s_P=s_0\cap s_P=(\mu_P^{\opn{trop}})^{-1}
(P\cap (\mathbb{Z}^{n})^{\vee}).
\end{align}


\begin{proposition}[{Ehrhart reciprocity for 
local Morse data}]
\label{proposition-ehrhart-revisit}
Let $s_P$ be a permissible $C^{\infty}$-Cartier divisor on 
the $n$-dimensional
projective tropical toric manifold $X_P$ for 
a (Delzant) lattice polytope $P$. Then, 
\begin{align}
\chi(\opn{LMD}^{\bullet}(X^{\mathrm{trop}}_P;s_P))
&=\sharp(\opn{int}(P\cap \Z^{n})), \\
\chi(\opn{LMD}^{\bullet}(X^{\mathrm{trop}}_P;-s_P))
&=(-1)^{n}\sharp 
(\opn{int}(P\cap \Z^{n})).
\end{align}
\end{proposition}
\begin{proof}
Let $\{(U_p,f_{P,p})\}_{p\in s_0\cap s_P}$ be an intersection
data of $s_P$.
For any $f_{P,p}$, $\{f_{P,p}<0\}$ is empty 
and $\{-f_{P,p}<0\}=U_p\setminus \{p\}$. 
If $\mu_P^{\mathrm{trop}}(p)=\partial P\cap \mathbb{Z}^{n}$,
then $\opn{LMD}^{\bullet}(U_p,-f_{P,p},p)$ is trivial since 
we can choose a sufficienly small 
$U_p$ such that $U_p\setminus \{p\}$
is contractible.
\end{proof}

\begin{remark}
There exist several versions of 
the homological mirror symmetry for the derived categories
of coherent sheaves on toric manifolds 
(e.g. \cite{MR2529936,MR2871160,MR4234675}). 
These references are related with tropical geometry.
Especially, $C^{\infty}$-Cartier divisors on tropical toric 
manifolds are deeply related to 
the wrapped Fukaya category 
$\opn{Fuk}(T^{*}T_{\mathbb{R}}^{\vee};\overline{\Lambda}_{\Sigma})$
in \cite[Theorem 2]{MR2871160}.
We also note the homological mirror symmetry between the derived category of
coherent sheaves on toric varieties $X_{\Sigma}$ and
the wrapped Fukaya category 
$\opn{Fuk}(T^{*}T_{\mathbb{R}}^{\vee};\overline{\Lambda}_{\Sigma})$
is finally solved by Kuwagaki's results \cite{MR4132582}.
\end{remark}

\begin{remark}
In \cite{MR4155409},
new Ehrhart theory of tropical geometry appear, 
but this is different from our approach. 
\end{remark}








\bibliography{lattice_points_surface}
\bibliographystyle{halpha}

\end{document}